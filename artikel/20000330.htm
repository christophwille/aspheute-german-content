<HTML>
<HEAD>
<TITLE>Downloads per Email verschicken</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Wenn eine Firma Downloads anbietet, dann tut Sie dies f&uuml;r Benutzer, die sich die Datei lokal abspeichern k&ouml;nnen. Nur wenige bieten an, daß sich der Kunde das Programm emailen kann (zB weil er gerade an einem &ouml;ffentlichen Terminal sitzt).">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,SMTP,Email,Download,Emailversand,Softartisans,Software Artisans,SA SMTPmail,SMTPmail">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Downloads per Email verschicken</H1>
<p>
Geschrieben von: <a href="../autoren/christophwille.htm">Christoph Wille</a><br>
Kategorie: <a href="../kategorien/Komponenten.htm">Komponenten</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20000330"></SCRIPT>
</p>
<p>
Gerade durch das Internet ist es f&uuml;r viele Softwareunternehmen leicht geworden, Testversionen f&uuml;r 
potentielle Kunden zur Verf&uuml;gung zu stellen - vor allem, ohne f&uuml;r die Verteilung und
den Versand Personal bereitstellen zu m&uuml;ssen. Nat&uuml;rlich ist diese Bereitstellung von digitaler Information (und
eine Software ist nichts anderes) nicht auf Testversionen beschr&auml;nkt; es k&ouml;nnten genauso gut Dokumente sein.
</p>

<p>
Bei der Distribution von digitalen Informationen &uuml;ber Websites bedienen sich die Firmen verschiedenster 
Methoden:
<ul>
<li><b>Downloadlink</b> Das ist die einfachste Variante. Der Benutzer klickt auf einen normalen
	Hyperlink, und der Download beginnt.
<li><b>Registrieren, dann downloaden</b> Dies ist die weitestverbreitete Vorgangsweise. Bevor ein 
	Kunde die Testversion downloaden kann, mu&szlig; er bestimmte Daten (Name, Emailadresse, etc) eingeben.
	Der Download erfolgt dann &uuml;ber einen Redirect.
<li><b>Versand per Email</b> Dies ist meist ein Zusatz zu obiger Variante - die downzuloadende Datei
	wird per Email an den Empf&auml;nger versandt. F&uuml;r jemanden, der gerade an einem &ouml;ffentlichen Terminal
	eine interessante Software gefunden hat, ist es ein hervorragendes Feature, sich die Software nach
	Hause emailen zu lassen.
</ul>
</p>

<p>
In diesem Artikel werde ich auf dieses letzte Feature eingehen, weil man es viel zu selten auf Websites findet. Da man, um
Email versenden zu k&ouml;nnen eine entsprechende SMTP-Email-f&auml;hige Komponente braucht, mu&szlig; zuerst am 
Webserver eine solche installiert sein. Ich habe mich f&uuml;r SA SMTPmail entschieden,
da man diese Komponente gratis einsetzen kann (Link am Ende des Artikels). Als zus&auml;tzlicher Bonus ist
diese Komponente Feature-kompatibel zu AspMail von ServerObjects - man kann den alten Sourcecode
ohne &Auml;nderung &uuml;bernehmen, und mu&szlig; nur im <i>CreateObject</i> Statement die ProgId austauschen.
</p>

<p>
Was alles sollte man f&uuml;r den Download von Dateien vorsehen? Mir w&uuml;rden zum Beispiel folgende Topics
einfallen (ohne Anspruch auf Vollst&auml;ndigkeit oder Reihung nach Wichtigkeit):
<ul>
<li>Geschwindigkeit
<li>Flexibilit&auml;t
<li>Sicherheit
</ul>
</p>

<p>
Zur <i>Geschwindigkeit</i> gibt es eigentlich nur zu sagen, da&szlig; f&uuml;r den Download per Email der SMTP Server &uuml;ber
eine schnelle Anbindung (lokales Netzwerk) verf&uuml;gbar sein mu&szlig;. <i>Flexibilit&auml;t</i> hei&szlig;t f&uuml;r mich, da&szlig; mein 
Downloadskript einmal geschrieben wird, und dann nicht mehr modifiziert werden mu&szlig; - egal, wie viele
verschiedene Dateien zum Download verf&uuml;gbar gemacht werden. Und last but not least, <i>Sicherheit</i>: man sollte
sich davor h&uuml;ten, den Namen der Datei im Querystring zu &uuml;bergeben - f&uuml;r den Kunden ist es fr&uuml;h genug, wenn
er den Namen der Datei im Posteingang das erste Mal sieht.
</p>

<p>
F&uuml;r das Beispiel (<a href="20000330_code1.htm" target="_blank">Link zum Code</a>) mu&szlig;te ich leider etwas bei der Flexibilit&auml;t
einschr&auml;nken, da ich sonst noch eine Menge Datenbankcode h&auml;tte einf&uuml;gen m&uuml;ssen (statt der Zeilen 005 und 006).
Im Sicherheitsansatz stimmt das Skript allerdings: der Pfad der Datei wird nicht mitgegeben, sondern nur
eine Programmnummer (<i>?program=1</i>):
</p>
<p>
<IMG SRC="Bilder/200003/20000330_1.png" width="503" height="233" border="0" alt="Download">
</p>

<p>
Aus dieser Programmnummer (mit einigen Sicherheitschecks in den Zeilen 008 bis 018) kann sowohl der Programmname
und die zu verschickende Datei ermittelt werden (Zeile 027, TITLE Element). Das Formular, in dem der Benutzer
seine Emailadresse eingeben kann, wird in den Zeilen 035 bis 047 generiert - allerdings nur, wenn der Benutzer nicht
schon die <i>Send Download</i> Schaltfl&auml;che gedr&uuml;ckt hat (dies wird mit dem versteckten Feld der Zeile 041 ermittelt).
</p>

<p>
Da das Formular auf sich selbst abschickt (<i>Request.ServerVariables("SCRIPT_NAME")</i> in Zeile 035), ist der Downloadversand
auch in dieser ASP Seite integriert. Zuallererst wird in Zeile 052 ein wirklich bescheidener Check der Emailadresse
vorgenommen, und danach der Emailversand &uuml;ber SA SMTPmail vorbereitet. F&uuml;r
<pre>
056  		Mailer.FromName = strSenderDisplayName
057  		Mailer.FromAddress = strSenderEmail
058  		Mailer.RemoteHost = strSMTPHost
</pre>
sind die Variablenwerte in den Zeilen 21, 22 und 23 definiert - &uuml;blicherweise w&uuml;rde man diese Werte &uuml;ber eine
zentrale Includedatei (zB: <i>maileinstellungen.asp</i>) einbinden.
</p>

<p>
Der interessanteste Teil dieser Email ist das Attachment:
<pre>Mailer.AddAttachment Server.MapPath(aDLUrls(strProgram))</pre>
Man mu&szlig; nur den physikalischen Pfad angeben, und schon kann man mit <i>Mailer.SendMail</i> den Download zum Kunden
abschicken! Da beim Versand der Email Fehler auftreten k&ouml;nnen, habe ich noch den notwendigen Fehlerbehandlungscode
eingef&uuml;gt (man k&ouml;nnte es erweitern, indem man mit <i>Response.AppendToLog</i> den Fehler in das Log des Web Servers
schreibt)
</p>
<P>
Die generierte Email, die der Kunde erh&auml;lt, sieht wie folgt aus:
</p>
<p>
<IMG SRC="Bilder/200003/20000330_2.png" width="524" height="356" border="0" alt="Email">
</p>

<p>
Nat&uuml;rlich kann man diesem Sourcecode erweitern: bei gr&ouml;&szlig;erer Anzahl an downloadbaren Dateien (&gt;10) mu&szlig; man auf alle F&auml;lle 
die Zeilen 005 und 006 durch Datenbankabfragen ersetzen, um die gew&uuml;nschte Flexibilit&auml;t zu erreichen. Ansonsten kann der
Emaildownload sofort in die bestehende Sitestruktur eingebaut werden.
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20000330.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20021028.htm">ACT MetaMailer - Mails verschicken leicht gemacht</a><br>
<a href="20000515.htm">Emails senden mit CDONTS</a><br>
<a href="20010625.htm">Html Emails mit Dundas Mailer verschicken</a><br>
<a href="20000912.htm">Mit PGP verschl&uuml;sselte e-Mails senden</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Esoftartisans%2Ecom%2Fsmtpmail%2Ehtml">SA SMTPmail Download</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20000330" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Downloads per Email verschicken"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20000330.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christoph Wille"><input type="hidden" name="AuthorEmail" value="christophw@alphasierrapapa.com"><input type="hidden" name="Artikel" value="20000330"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20000330.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
