<HTML>
<HEAD>
<TITLE>Seitenzugriffe mit der PageCounter Komponente erfassen</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Um die Popularit&auml;t Ihrer Website zu &uuml;berpr&uuml;fen, k&ouml;nnen Sie auf den Seiten Ihrer Site einen Page Counter (Z&auml;hler) einsetzen, der die Clientzugriffe mitloggt.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,IIS,PageCounter,page count,counter,zugriff,zugriffszaehler,zugriffszähler,impression,page view">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Seitenzugriffe mit der PageCounter Komponente erfassen</H1>
<p>
Geschrieben von: <a href="../autoren/christianholm.htm">Christian Holm</a><br>
Kategorie: <a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20000721"></SCRIPT>
</p>
<p>
Um die Popularit&auml;t Ihrer Website zu &uuml;berpr&uuml;fen, k&ouml;nnen Sie auf den Seiten 
Ihrer Site einen Page Counter (Z&auml;hler) einsetzen, der die Clientzugriffe mitloggt. Nat&uuml;rlich gibt 
es eine Vielzahl von Drittanbieter die dieses Feature zur Verf&uuml;gung stellen. Dabei m&uuml;ssen Sie 
wieder ein fremdes Script in Ihre Seite einbinden, sich l&auml;stige Werbung gefallen lassen - von 
Konfigurationsproblemen ganz zu schweigen. 
</p>
<p>
Warum sollte man also auf solche Angebote ausweichen, vor allem dann,  wenn der Internet Information 
Server (IIS) eine kleine ASP-Komponete zur Verf&uuml;gung stellt, die sich einfachst einbinden l&auml;&szlig;t - 
die PageCounter Komponente. 
Diese l&auml;&szlig;t sich leicht konfigurieren und mit ein bischen Code sogar professionell aufpeppen.
</p>
<p>
Die Page Counter Komponente ist bereits ab dem Internet Information Server (IIS) Version 4 
verf&uuml;gbar (IIS Resource Kit), und wird bei Windows 2000 Internet Information Services 
standardm&auml;&szlig;ig mitinstalliert. 
</p>

<h2>Verwendung der PageCounter Komponente</h2>
<p>
Die PageCounter Komponente z&auml;hlt die Zugriffe auf eine ASP Seite und kann die Gesamtstatistik 
auf derselben oder einer anderen Seite wieder ausgeben. Innerhalb bestimmter, regelm&auml;&szlig;iger 
Intervalle schreibt das Objekt die Pagehits in eine Textdatei (die sogenannte Hit Count 
Data Datei), damit diese Daten auch &uuml;ber Serverrestarts verf&uuml;gbar bleiben.
</p>
<p>
F&uuml;r Programmierer als auch Administratoren ist es nat&uuml;rlich gut zu wissen, wo diese Hit Count Data 
Datei gespeichert wird (etwaige Zugriffsrechteprobleme k&ouml;nnten mit der Standardeinstellung 
entstehen), sowie wie oft die Counter dort gespeichert werden (bei vielen Seiten mit hoher 
Zugriffsfrequenz sollte man das Intervall erh&ouml;hen).
</p>
<p>
Diese Informationen (Speicherort und Speicherfrequenz) werden in der Registrierdatenbank des 
Servers abgelegt. Der Pfad ist <i>HKEY_CLASSES_ROOT\MSWC.PageCounter</i> (siehe Bild).
</p>
<p><IMG SRC="Bilder/200007/20000721.png" width="590" height="340" border="0" alt=""></p>
<p>
Die beiden Schl&uuml;sselwerte, die man ver&auml;ndern kann, sind hier beschrieben:
<table cellspacing="5">
<tr><th align="left">Wert</th><th align="left">Beschreibung</th></tr>
<tr>
	<td valign="top"><b>File_Location</b></td>
	<td valign="top"><p>
	Dieser Wert gibt den Pfad und den Dateinamen der Hit Count Data Datei an. Standardm&auml;&szlig;ig 
	wird der Dateiname Hitcnt.cnt verwendet und ist im Data Verzeichnis des IIS zu finden (wie 
	gesagt, dies k&ouml;nnte ein Berechtigungsproblem f&uuml;r IUSR_machinename sein).
	</p></td>
</tr>
<tr>
	<td valign="top"><b>Save_Count</b></td>
	<td valign="top"><p>
	Enth&auml;lt die Anzahl der Pagehits bevor sie in der Hit Count Data Datei gespeichert wird (=das 
	Maximum an Hits die verloren gehen w&uuml;rden, falls der Server vorher abst&uuml;rzen w&uuml;rde). Der Wert 
	ist vom Datentyp ein DWORD (Double Word), und standardm&auml;&szlig;ig auf 25 gesetzt.
	</p>
	<p>
	<b>Beachte:</b> Dieser Wert entspricht der Gesamtanzahl der Pagehits &uuml;ber den gesamten Server, und 
	nicht der Anzahl von Treffern pro Internetseite.
	</p>
	</td>
</tr>
</table>
</p>
<p>
Da wir jetzt alle funktionalen Details gekl&auml;rt haben, k&ouml;nnen wir nun zum Programmieren kommen.
Wenn man die PageCounter Komponente nun verwenden m&ouml;chte, so hat man drei Methoden zur Verf&uuml;gung
<ul>
<li><b>Hits</b> Zeigt die Anzahl der Zugriffe auf eine lokale URL an
<li><b>PageHit</b> Erh&ouml;ht den Page Hit Count um 1
<li><b>Reset</b> Setzt den Hit Count der angegeben Seite auf Null (0) zur&uuml;ck  					
</ul>
</p>
<p>
Mit diesen Information wollen wir uns nun auf Beispiele st&uuml;rzen.
</p>

<h2>Auslesen und Erh&ouml;hen von Page Counts</h2>
<p>
Dieses Beispiel  verwendet die <i>PageHit</i> und <i>Hits</i> Methoden der PageCounter Komponente, um die
Anzahl der Besucher zu ermitteln (<b>countertest.asp</b>).
<pre style="background='silver';">
&lt;% @LANGUAGE=&quot;VBSCRIPT&quot; %&gt;
&lt;% 
Option Explicit 
Response.Expires = 0
%&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;PageCount'd Page&lt;/title&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#ffffff&quot;&gt;
&lt;p&gt;
Z&auml;hlen der HitCounts mit Hilfe der Hits-Methode:
&lt;%
Dim PgeCount
Set PgeCount = Server.CreateObject(&quot;MSWC.PageCounter&quot;)
PgeCount.PageHit
%&gt;
Diese Website wurde 
  &lt;b&gt;&lt;%= PgeCount.Hits %&gt;&lt;/b&gt; 
Mal besucht.
&lt;/p&gt;

&lt;p&gt;
Ausgabe Counter f&uuml;r beliebige Seite:
Die Seite prettyscript.asp wurde 
  &lt;b&gt;&lt;%= PgeCount.Hits(&quot;/aspheute/prettyscript.asp&quot;) %&gt;&lt;/b&gt;
Mal besucht.
&lt;/p&gt; 

&lt;%
Set PgeCount = Nothing
%&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>
</p>
<p>
Wie man im Beispielcode sehen kann, verwende ich die <i>Hits</i> Methode einmal ohne, als auch einmal 
mit Parameter. Der optionale Parameter gibt eine beliebige Datei an, von der der Hit Count 
ermittelt werden soll. Falls der Parameter nicht gesetzt ist, dann wird der Hit Count der 
aktuell ausgef&uuml;hrten Seite ausgegeben.
</p>
<p>
Der R&uuml;ckgabewert der <i>Hits</i> Methode entspricht der Anzahl an Hit Counts und hat den Datentyp Long.
</p>
<p>
Wie komme ich aber nun zu meinem Hit Count - sprich, wie erh&ouml;he ich die Anzahl der Zugriffe? 
Das erledigt die Methode <i>PageHit</i> f&uuml;r uns - sie erh&ouml;ht den Hit Count der aktuellen Webseite 
um eins (1). In diesem Beispiel mache ich es sofort nach der Instanzierung des MSWC.PageCounter
Objekts.
</p>

<h2>Hit Counts zur&uuml;cksetzen</h2>
<p>
Hier kommt uns die dritte Methode - die <i>Reset</i> Method - zu Hilfe. Sie setzt beliebige 
Zugriffsz&auml;hler auf 0 zur&uuml;ck. Auch diese Methode hat einen optionalen Pfadparameter, der auch
wie bei <i>Hits</i> dazu verwendet werden kann, um beliebige Z&auml;hler zur&uuml;ckzusetzen.
</p>
<p>
Das nun folgende Beispiel setzt den Z&auml;hler der aktuellen Seite und f&uuml;r eine externe Datei 
auf 0 zur&uuml;ck (<b>counterreset.asp</b>).
<pre style="background='silver';">
&lt;% Option Explicit %&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;title&gt;Resetten der Page Counter&lt;/title&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#ffffff&quot;&gt;
&lt;% 
Dim PgeCount
Set PgeCount = Server.CreateObject(&quot;MSWC.PageCounter&quot;)
' R&uuml;cksetzung der aktuellen Seite
PgeCount.Reset
' R&uuml;cksetzung einer beliebigen Seite
PgeCount.Reset(&quot;/webroot/webseite.asp&quot;)
' ab jetzt sind alle Counter auf 0:
%&gt;
&lt;P&gt;
Page Hits auf aktueller Seite: 
	&lt;%= PgeCount.Hits %&gt; &lt;br&gt;
Page Hits auf prettyscript.asp: 
	&lt;%= PgeCount.Hits(&quot;/aspheute/prettyscript.asp&quot;) %&gt;
&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
</p>


<h2>Schlu&szlig;bemerkung</h2>
<p>
Dieser Artikel beschreibt die M&ouml;glichkeiten der PageCounter Komponente mit ihren zur Verf&uuml;gung 
gestellten Methoden. Hier wurde lediglich das Grundwissen zur Komponente vermittelt - durch 
zus&auml;tzliches Tuning l&auml;&szlig;t sich nat&uuml;rlich noch einiges verbessern (Statistiken &uuml;ber alle Seiten, 
Tagescounter, etc).
</p>
<p>
In den meisten F&auml;llen kann man auf einen optischen Aufputz verzichten - was sicherlich das 
T&uuml;pfelchen auf dem "i" ist, ist die graphische Auswertung der Page Hits.
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20000721.zip">Klicken Sie hier</a>, um den Download zu starten.</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20000721" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Seitenzugriffe mit der PageCounter Komponente erfassen"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20000721.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Holm"><input type="hidden" name="AuthorEmail" value="office@holmcs.com"><input type="hidden" name="Artikel" value="20000721"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20000721.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
