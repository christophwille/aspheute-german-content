<HTML>
<HEAD>
<TITLE>Der ODBC .NET Data Provider</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Um auch Datenbanken in .NET verwendbar zu machen, die nur ODBC Treiber zur Verf&uuml;gung stellen, bietet Microsoft den ODBC.NET Data Provider als separaten Download an.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,ODBC.NET,ODBC .NET,Data Provider,Datenbank,Connection String,Verbindung,Database,Driver">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Der ODBC .NET Data Provider</H1>
<p>
Geschrieben von: <a href="../autoren/christophwille.htm">Christoph Wille</a><br>
Kategorie: <a href="../kategorien/ADOdotNET.htm">ADO.NET</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20020206"></SCRIPT>
</p>
<p>
Obwohl es einen speziellen Managed Provider für SQL Server gibt, sowie einen Wrapper für OLE DB
Provider, kann es sein, daß man auf seine Datenbank nicht zugreifen kann, weil es für die Datenbank
nur einen ODBC Provider gibt. Um auch solche in .NET verwendbar zu machen, stellt Microsoft den
ODBC.NET Data Provider als separaten Download zur Verfügung.
</p>
<p>
Der <a href="http://www.microsoft.com/downloads/release.asp?ReleaseID=35715" target="_blank">ODBC .NET Data Provider </a>
ist als Windows Installer Package mit knapp unter einem Megabyte Download erhältlich. Die Installation geht -
so .NET 1.0 und MDAC 2.7 installiert sind, absolut ereignisfrei vonstatten. Wichtig für uns Programmierer ist, daß eine separate
Hilfedatei installiert wird (Start Menü, Programs, ODBC .NET Data Provider):
</p>

<IMG SRC="Bilder/200202/20020206_1.png" width="694" height="495" alt="" border="0">

<h2>Erste Schritte</h2>
<p>
Der ODBC .NET Data Provider ist im <i>Microsoft.Data.Odbc</i> Namespace verpackt, der im GAC (Global Assembly
Cache) installiert wurde. Um diesen in ASP.NET verwenden zu können, müssen wir in der <b>web.config</b>
eine Assembly-Referenz inkludieren:
</p>

<pre style="background='silver';">
&lt;configuration&gt;
   &lt;system.web&gt;
      &lt;compilation debug="true"&gt;
        &lt;assemblies&gt;
                &lt;add assembly="Microsoft.Data.Odbc, Version=1.0.3300.0, 
                     Culture=neutral, PublicKeyToken=b77a5c561934e089"/&gt;
        &lt;/assemblies&gt;
      &lt;/compilation&gt;
   &lt;/system.web&gt;
&lt;/configuration&gt;
</pre>

<p>
Den Zeilenumbruch habe ich nur für das obige Listing eingebaut - in der echten <b>web.config</b> muß der
<i>add assembly</i> String auf einer Zeile stehen. Die notwendigen Information erhält man übrigens
über den Windows Explorer, wenn man in das WINNT\Assembly Verzeichnis browst:
</p>

<IMG SRC="Bilder/200202/20020206_3.png" width="610" height="273" alt="" border="0">

<p>
Nach dieser Vorarbeit kann man den ODBC .NET Data Provider nun in jeder ASP.NET Seite verwenden. Die
folgende ASP.NET Seite (<b>datareader.aspx</b>) zeigt einen DataReader, wie er auch schon im Artikel 
<a href="20001106.htm">Datenaufbereitung in ADO.NET</a> verwendet wurde:
</p>

<pre style="background='silver';">
&lt;%@ Page Language="C#" Debug="true" %&gt;
&lt;%@ Import Namespace="Microsoft.Data.Odbc" %&gt;
&lt;script language=C# runat="server"&gt;
void Page_Load(Object Src, EventArgs E)
{
  string strConn = "Driver={SQL Server};Server=WEBDEVSRV01;UID=sa;PWD=;Database=Northwind;";
  string strSQL ="SELECT Productname, CompanyName, UnitPrice FROM Suppliers INNER JOIN " + 
     "Products ON (Suppliers.SupplierID = Products.SupplierID) WHERE UnitPrice &lt;= $70";
  
  OdbcConnection conn = new OdbcConnection(strConn);
  OdbcCommand cmd = new OdbcCommand(strSQL, conn);  

  conn.Open();
  OdbcDataReader dr = cmd.ExecuteReader();
  while (dr.Read())
  {
    txtOutput.Text += dr["Productname"].ToString() + "&lt;br&gt;\r\n";
  }

  dr.Close(); 
  conn.Close();
}
&lt;/script&gt;

&lt;asp:Label ID="txtOutput" Runat="Server" /&gt;
</pre>

<p>
Wer den Code vergleicht, wird bemerken, daß eigentlich nur eine Änderung sich durch den Sourcecode
zieht - aus dem Prefix <i>Sql</i> wird <i>Odbc</i>. Ein weiterer Beweis ist das nachfolgende Script
<b>gridbind.aspx</b> - auch dieses ist im Prinzip unverändert zum SQL Managed Provider Beispiel:
</p>

<pre style="background='silver';">
&lt;%@ Page Language="C#" Debug="true" %&gt;
&lt;%@ Import Namespace="System.Data" %&gt;
&lt;%@ Import Namespace="Microsoft.Data.Odbc" %&gt;
&lt;script language=C# runat="server"&gt;
void Page_Load(Object Src, EventArgs E)
{
  string strConn = "Driver={SQL Server};Server=WEBDEVSRV01;UID=sa;PWD=;Database=Northwind;";
  string strSQL ="SELECT Productname, CompanyName, UnitPrice FROM Suppliers INNER JOIN " + 
     "Products ON (Suppliers.SupplierID = Products.SupplierID) WHERE UnitPrice &lt;= $70";

  OdbcConnection conn = new OdbcConnection(strConn);

  DataSet ds = new DataSet();
  OdbcDataAdapter cmd = new OdbcDataAdapter(strSQL, conn);
  
  cmd.Fill(ds, "Lieferanten");
  conn.Close();

  MyDG.DataSource = ds.Tables["Lieferanten"].DefaultView;
  MyDG.DataBind();
}
&lt;/script&gt;

  &lt;form runat="server"&gt;
  &lt;asp:DataGrid id="MyDG" runat="server"
    Width="700"
    BorderColor="black"
    CellPadding="2" 
    CellSpacing="2"
    HeaderStyle-BackColor="#f8d07a"
    /&gt;
 &lt;/form&gt;
</pre>
<p>
Und mit diesem Code erhält man dann folgende Seite präsentiert:
</p>

<IMG SRC="Bilder/200202/20020206_2.png" width="643" height="403" alt="" border="0">

<p>
Auch die Verwendung von Stored Procedures läuft analog - aus <i>Sql</i> wird <i>Odbc</i>.
</p>

<h2>Das Wort zum Exception Handling</h2>
<p>
Wenn mit dem ODBC .NET Data Provider etwas schiefgeht, dann läßt er uns das via <i>OdbcException</i>
wissen. Prominentes Beispiel: die Connection zum SQL Server kann nicht aufgebaut werden (<b>exceptionhandling.aspx</b>):
</p>

<pre style="background='silver';">
&lt;%@ Page Language="C#" Debug="true" %&gt;
&lt;%@ Import Namespace="Microsoft.Data.Odbc" %&gt;
&lt;%
  string strConn = "Driver={SQL Server};Server=SomeServer;UID=sa;PWD=;Database=Northwind;";
  try
  {
    OdbcConnection conn = new OdbcConnection(strConn);
    conn.Open();
  }
  catch (OdbcException e)
  {
    // Nur zu Demozwecken - den vollen Fehler gibt man nicht aus!
    Response.Write("Error: " + e.ToString());
  }
%&gt;
</pre>

<p>
Da der Server SomeServer bei mir im Netzwerk nicht existiert, liefert mir der Aufruf von <i>.Open</i>
eine <i>OdbcException</i>. Hier gebe ich die Fehlermeldung direkt an den User aus - aus Sicherheitsgründen
sollte man dies nicht machen. Statt dessen den Fehler ins Event Log schreiben, und dem User eine einfache
Fehlermeldung präsentieren.
</p>

<h2>Schlußbemerkung</h2>
<p>
Wer noch auf Datenbanken zugreifen muß, die nur einen ODBC Treiber zur Verfügung stellen, ist mit
dem ODBC .NET Data Provider bestens bedient. Es entsteht kein zusätzlicher Lernaufwand.
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20020206.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20001106.htm">Datenaufbereitung in ADO.NET</a><br>
<a href="20001102.htm">Datenbankzugriff mittels ADO.NET</a><br>
<a href="20000808.htm">Einf&uuml;hrung in ASP.NET Web Forms</a><br>
<a href="20000922.htm">Eventbehandlung bei ASP.NET WebForms</a><br>
<a href="20000724.htm">Exception Handling in C#</a><br>
<a href="20011206.htm">Performancemessungen in .NET</a><br>
<a href="20010626.htm">Stored Procedures 101 in ADO.NET</a><br>
<a href="20010802.htm">Web.Config 101</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fsupport%2Emicrosoft%2Ecom%2Fdefault%2Easpx%3Fscid%3Dkb%3BEN%2DUS%3BQ310988">HOW TO: Use the ODBC .NET Managed Provider in Visual C# .NET and Connection Strings (Q310988)</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Emicrosoft%2Ecom%2Fdownloads%2Frelease%2Easp%3FReleaseID%3D35715">ODBC .NET Data Provider</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Eine weitere sehr hilfreiche Resource ist das <a href="http://aspxfiles.com/">deutsche ASP.NET Wiki</a>,
das als zentrale Anlaufstelle f&uuml;r Tips, Tricks, Know How und alles N&uuml;tzliche was man in seinem Alltag als 
(ASP).NET-Entwickler so braucht und entdeckt gedacht ist. 
</p>

<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20020206" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Der ODBC .NET Data Provider"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20020206.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christoph Wille"><input type="hidden" name="AuthorEmail" value="christophw@alphasierrapapa.com"><input type="hidden" name="Artikel" value="20020206"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20020206.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
