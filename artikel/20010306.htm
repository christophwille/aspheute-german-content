<HTML>
<HEAD>
<TITLE>Dynamische Stylesheets</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Bei CSS verwendet man meist eine extern eingelinkte Datei mit der Endung .css, die die Definitionen f&uuml;r die Styles enth&auml;lt. Wer verbietet uns eigentlich, diese Endung auf .asp zu &auml;ndern?">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,CSS,Cascaded Stylesheet,stylesheet,Cookie,Personalisierung,Datenbank,Combobox,DropDown">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Dynamische Stylesheets</H1>
<p>
Geschrieben von: <a href="../autoren/christophwille.htm">Christoph Wille</a><br>
Kategorie: <a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20010306"></SCRIPT>
</p>
<p>
Cascaded Stylesheets (CSS) erfreuen sich immer gr&ouml;&szlig;erer Beliebtheit f&uuml;r das Websitedesign. In den meisten
F&auml;llen handelt es sich dabei um eine extern eingelinkte Datei mit der Endung .css, die die Definitionen
f&uuml;r die Styles enth&auml;lt. Wer verbietet uns eigentlich, diese Endung auf .asp zu &auml;ndern?
</p>

<p>
Niemand! Die Hauptsache ist, unsere ASP Seite liefert eine g&uuml;ltige CSS Datei - wie diese zustande kommt,
ist dem Browser im Prinzip egal - also k&ouml;nnen wir diese auch personalisiert f&uuml;r den Benutzer erstellen.
</p>

<h2>Das Opfer unserer Experimente</h2>
<p>
Um es einfach und &uuml;berschaubar zu halten, "vergreifen" wir uns nur an einem einzigen Style - dem Style
f&uuml;r die <i>H1</i> &Uuml;berschrift. Dazu habe ich eine wirklich einfache HTML Datei erstellt (<b>ShowPersonalizedCSS.asp</b>).
</p>

<pre style="background='silver';">
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Personalisiertes CSS&lt;/title&gt;
  &lt;link rel="stylesheet" type="text/css" href="personalizedCSS.asp"&gt;
&lt;/head&gt;
&lt;body bgcolor="#ffffff"&gt;

&lt;h1&gt;Test&uuml;berschrift&lt;/h1&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>
Das Stylesheet (<b>personalizedCSS.asp</b>) wird extern &uuml;ber die <b>link</b> Direktive im Header eingebunden.
Dies ist die Variante, die verwendet wird, wenn auf der gesamten Site dasselbe Stylesheet verwendet
werden soll. Die Variante eines Inline-Stylesheets w&auml;re ja f&uuml;r den heutigen Artikel zu leicht zu 
personalisieren - eine externe Datei macht da mehr Spa&szlig;.
</p>

<h2>Personalisieren des Stylesheets</h2>
<p>
F&uuml;r unseren <i>H1</i> Style wollen wir die Schriftart und die Schriftfarbe personalisieren - dies ist eine von mir
willk&uuml;rlich getroffene &Uuml;bungsannahme, die man gerne &auml;ndern kann. Zum Speichern der Personalierungsdaten
habe ich mich f&uuml;r einen Cookie entschieden - warum? Erstens: es ist leicht implementierbar, zweitens
bekommt <b>personalizedCSS.asp</b> diesen Cookie auch geschickt. 
</p>
<p>
Auf einen Nachteil m&ouml;chte ich auch gleich eingehen: Cookies werden am Client gespeichert, und somit
immer vom Client zum Server geschickt (der Server schickt nur beim Setzen des Cookies). Wenn man viel
im Cookie speichert, kann das schon in me&szlig;baren Traffic ausarten. Der skalierbarere Ansatz w&auml;re im Cookie
nur eine "Erkennungs-ID" zu speichern, mit der man die personalisierten Daten in der Datenbank ansprechen
kann.
</p>
<p>
Nach diesem Ausflug in die Welt der gro&szlig;en Websites begeben wir uns wieder zu unserem einfachen Beispiel
zur&uuml;ck - <b>SetCSSPreferences.asp</b>. Es verwendet Cookies, und stellt dem Benutzer zwei DropDown
Boxen zur Auswahl von Schriftart und -farbe zur Verf&uuml;gung:
</p>

<pre style="background='silver';">
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;CSS definieren&lt;/title&gt;
&lt;/head&gt;
&lt;body bgcolor="#ffffff"&gt;
&lt;%
strFarbe = Request.Cookies("CSSCookie")("H1Color")
strFont = Request.Cookies("CSSCookie")("H1Font")

If (0 &lt;&gt; Request.ServerVariables("CONTENT_LENGTH")) Then
  strFarbe = Request.Form("txtFarbe")
  strFont = Request.Form("txtFont")
  Response.Cookies("CSSCookie")("H1Color") = strFarbe
  Response.Cookies("CSSCookie")("H1Font") = strFont
End If
%&gt;

&lt;form method="post" action="&lt;%=Request.ServerVariables("SCRIPT_NAME")%&gt;"&gt;
Farbe: 
&lt;%
  cString="Schwarz,Gr&uuml;n,Gelb,Blau,Rot"
  cStringValue="black,green,yellow,blue,red"
  GenerateComboBox "txtFarbe", strFarbe, cString, cStringValue
%&gt;
&lt;br&gt;
Schriftart: 
&lt;%
  cString="Arial,Times New Roman,Tahoma"
  cStringValue=cString
  GenerateComboBox "txtFont", strFont, cString, cStringValue
%&gt;
&lt;br&gt;
 
 &amp;nbsp;&lt;br&gt;
&lt;input type=submit value="&Auml;nderung durchf&uuml;hren"&gt;
&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>
Das ist ein All-In-One Forumlar, das das Formular als auch den serverseitigen Auswertungscode
beeinhaltet. Das Setzen der Cookiewerte ist einfachst implementiert (die Expiration setze ich nicht), interessant an diesem
Formular ist die Funktion <i>GenerateComboBox</i>. Das ist eine von mir implementierte Funktion
zur einfachen Generierung von DropDown Boxen: ich &uuml;bergebe den Namen der Box, die Standardauswahl
und zwei Arrays - die die Werte und die sichtbaren Texte beinhalten:
</p>

<pre style="background='silver';">
&lt;script language="vbscript" runat="server"&gt;
Sub GenerateComboBox(strComboName, strDefaultValue, strDisplay, strValue)
  arrDisplay = Split(strDisplay, ",")
  arrValues = Split(strValue, ",")
  nValues = UBound(arrDisplay)
  If (nValues &lt;&gt; UBound(arrValues)) Then
    Err.Raise 1, "GenerateComboBox: Display.Count != Values.Count!"
  End If
  Response.Write "&lt;SELECT NAME=""" &amp; strComboName &amp; """&gt;" &amp; vbCrlf
  
  For i=0 To nValues
    If (0 = StrComp(arrValues(i), strDefaultValue)) Then
      Response.Write "&lt;OPTION SELECTED VALUE=""" &amp; arrValues(i) &amp; _
           """&gt;" &amp; arrDisplay(i) &amp; vbCrlf
    Else
      Response.Write "&lt;OPTION VALUE="""&amp; arrValues(i) &amp;"""&gt;" &amp; _
           arrDisplay(i) &amp; vbCrlf
    End If
  Next
  Response.Write "&lt;/SELECT&gt;"
End Sub
&lt;/script&gt;
</pre>

<p>
Damit bekommt man eine DropDown Box, die einen bestimmten Wert bereits ausgew&auml;hlt hat - damit
beim zweiten Aufruf des Formulars die vorhergehende Selektion auch wieder korrekt dargestellt
wird. Das k&ouml;nnen Sie gleich testen, denn wir brauchen sowieso Testwerte im Cookie.
</p>

<h2>Das dynamische Stylesheet</h2>
<p>
Was uns noch fehlt, ist die Implementierung des dynamischen Stylesheets <b>personalizedCSS.asp</b>.
Da ich mich ungerne darauf verlasse, da&szlig; alle Werte initialisiert sind, habe ich noch Standardwertabfragen
in diese Datei eingebaut - und sei es nur um Benutzern, die Cookies deaktiviert haben, auch ein brauchbares
Stylesheet zu pr&auml;sentieren.
</p>

<pre style="background='silver';">
&lt;%
strH1Color = Request.Cookies("CSSCookie")("H1Color")
If ("" = strH1Color) Then strH1Color = "black"
strH1Font = Request.Cookies("CSSCookie")("H1Font")
If ("" = strH1Font) Then strH1Color = "Arial"
%&gt;

H1
{
color:'&lt;%=strH1Color%&gt;';
font-family:'&lt;%=strH1Font%&gt;';
font-weight:bold;
}
</pre>

<p>
Wenn man jetzt die Datei <b>ShowPersonalizedCSS.asp</b> aufruft, bekommt man je nach vorher
eingestellten Werten sein eigenes pers&ouml;nliches CSS pr&auml;sentiert.
</p>

<h2>Schlu&szlig;bemerkung</h2>
<p>
Die heute pr&auml;sentierte L&ouml;sung kann verbessert werden - erstens sollten die Personalisierungen in
die Datenbank gespeichert werden, und der Cookie nur noch die Erkennungs-ID enthalten. Zweitens sollte man sich ein
gutes Caching f&uuml;r das CSS ausdenken - es ist keine gute Idee, bei jedem Seitenaufruf das CSS
generieren zu m&uuml;ssen.
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20010306.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20000522.htm">&Uuml;berpr&uuml;fen von HTML-Formularen mit ASP</a><br>
<a href="20001003.htm">Einf&uuml;hrung in Stringoperationen</a><br>
<a href="20000907.htm">Einfacher Test, ob der Browser Cookies annimmt</a><br>
<a href="20010205.htm">GET oder POST, das ist hier die Frage</a><br>
<a href="20010509.htm">Neue Inhalte einer Web Site f&uuml;r den Benutzer hervorheben</a><br>
<a href="20000412.htm">Pr&uuml;fen ob ein Browser Cookies annimmt</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20010306" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Dynamische Stylesheets"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20010306.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christoph Wille"><input type="hidden" name="AuthorEmail" value="christophw@alphasierrapapa.com"><input type="hidden" name="Artikel" value="20010306"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20010306.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
