<HTML>
<HEAD>
<TITLE>Flash Plug-In Erkennung</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Dieser Artikel demonstriert mit Hilfe der BrowserHawk Komponente, wie man herausfinden kann, ob Macromedia Flash korrekt installiert ist.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,BrowserHawk,Flash,ASP,CyScape,Detection,JavaScript">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Flash Plug-In Erkennung</H1>
<p>
Geschrieben von: <a href="../autoren/christiankoller.htm">Christian Koller</a><br>
Kategorie: <a href="../kategorien/Komponenten.htm">Komponenten</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20000411"></SCRIPT>
</p>
<p>
Die Verwendung der
Macromedia Flash Player Technologie in Internetseiten ist aufgrund der 
kompakten Dateigr&ouml;&szlig;e von Flash-Elementen und der &uuml;beraus
vielf&auml;ltigen M&ouml;glichkeiten, die Flash bietet, weit verbreitet.
</p>
<p>
Ob nun Macromedia Flash nur als multimediales Intro f&uuml;r eine Website gebraucht wird,
oder als tragendes Element zum Beispiel als Navigationsleiste,
immer stellt sich die bange Frage:
&quot;Hat der User in seinem Browser auch das ben&ouml;tigte Flash Plug-In installiert?&quot;
</p>
<p>
Da dies durchaus nicht immer der Fall ist, erhebt sich gleich darauf die
n&auml;chste Frage:
&quot;Wie kann ich pr&uuml;fen, ob der User das Flash Plug-In installiert hat?&quot;
</p>
<p>
Um auf einer ASP Seite mit einfachen Mitteln zu pr&uuml;fen, ob in einem beliebigen Browser
(<A HREF="http://www.microsoft.com/GERMANY/internet/ie/default.htm">Microsoft Internet Explorer</A>, 
Netscape Navigator, 
oder <A HREF="http://tucows.telekabel.at/web95.html">andere Browser</A>)
ein Macromedia Flash Plug-In installiert ist, bedient man sich am besten der 
<A HREF="http://www.CyScape.com/products/">BrowserHawk&nbsp;2000</A> Server-Komponente.
</p>
<p>
Nachdem sie die BrowserHawk Komponente auf ihrem ASP Server installiert haben,
k&ouml;nnen sie in ASP Seiten wie folgt pr&uuml;fen, ob ein Browser
das Macromedia Flash Plug-in installiert hat
(<a href="20000411_code1.asp" target="_blank">ausf&uuml;hrbares Beispiel</a>):
</p>
<pre style="background='silver';">
&lt;% 
Set BrowserHawk = Server.CreateObject("cyScape.browserObj")
BrowserHawk.GetExtProperties

Dim FlashDetect
FlashDetect = BrowserHawk.Plugin_Flash
%&gt;

&lt;HTML&gt;
&lt;HEAD&gt;
	&lt;TITLE&gt;Flash Erkennung&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;% 
If FlashDetect = -1 Then
	Response.Write "Flash Plug-In konnte nicht gepr&uuml;ft werden."
ElseIf FlashDetect = 0 Then
	Response.Write "Flash Plug-In nicht installiert."
Else
	Response.Write "Flash Plug-In Version " & FlashDetect & " installiert."
End If
%&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

&lt;% 
' Resourcen freisetzen
Set BrowserHawk = Nothing
%&gt;
</pre>
<p>
Anstatt nur Informationen &uuml;ber das Flash Plug-In auszugeben, k&ouml;nnen sie nat&uuml;rlich 
auch automatisch eine andere Seite laden. Das folgende ASP Skript leitet automtisch zu einer
Flash 3 oder Flash 4 Seite um wenn das entsprechende Flash Plug-In installiert ist
(<a href="20000411_code2.asp" target="_blank">ausf&uuml;hrbares Beispiel</a>):
</p>
<pre style="background='silver';">
&lt;% 
Set BrowserHawk = Server.CreateObject("cyScape.browserObj")
BrowserHawk.GetExtProperties

Dim FlashDetect
FlashDetect = BrowserHawk.Plugin_Flash

If FlashDetect &lt;= 0 Then
	' Flash Plug-In konnte nicht geprueft werden 
	' oder Plug-In ist nicht installiert

ElseIf FlashDetect = 3 Then
	' Flash Version 3, Umleitung zu Flash3.asp
	Response.Redirect("Flash3.asp")
ElseIf FlashDetect &gt;= 4 Then
	' Flash Version 4 oder hoeher, Umleitung zu Flash4.asp
	Response.Redirect("Flash4.asp")
End If
%&gt;

&lt;HTML&gt;
&lt;HEAD&gt;
	&lt;TITLE&gt;Flash Erkennung&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;

&lt;% 
If FlashDetect = -1 Then
	Response.Write "Flash Plug-In konnte nicht gepr&uuml;ft werden.&lt;BR&gt;"
	Response.Write "Klicken Sie hier f&uuml;r "
	Response.Write "&lt;A HREF=""Flash3.asp""&gt;Flash Version 3&lt;/A&gt; oder "
	Response.Write "&lt;A HREF=""Flash4.asp""&gt;Flash Version 4 und h&ouml;her&lt;/A&gt;."
ElseIf FlashDetect = 0 Then
	' Flash nicht installiert
	Response.Write "Flash Plug-In nicht installiert."
Else
	Response.Write "Fehler bei Flash Plug-In Detektion."
End If
%&gt;

&lt;/BODY&gt;
&lt;/HTML&gt;

&lt;% 
' Resourcen freisetzen
Set BrowserHawk = Nothing
%&gt;
</pre>
<p>
Beim Einsatz der BrowserHawk 2000 Komponente gilt es folgendes zu beachten:
</p>
<UL>

<LI>
Der Aufruf der <b>GetExtProperties</b> Methode ist immer dann notwendig, wenn eine der folgenden
Browsereigenschaften ausgelesen werden soll:<BR>
<I>JavaEnabled</I>, <I>JavaScriptEnabled</I>, <I>Plugin_Flash</I>, <I>Plugin_Director</I>,
<I>Height</I>, <I>Width</I>, <I>HeightAvail</I>, oder <I>WidthAvail</I>.
</LI>
<LI>
Alle Aktionen, die sie vor dem Aufruf der <I>GetExtProperties</I> Methode t&auml;tigen,
werden bei einem Aufruf ihrer Seite zweimal ausgef&uuml;hrt. Der Grund ist, da&szlig; 
die <I>GetExtProperties</I> Methode die ASP Seite im Browser selbst nocheinmal 
aufruft um auf diese Weise die Eigenschaften des Flash Plug-Ins zu gewinnen.
</LI>
<LI>
Wenn sie Daten aus einem mittels <I>POST</I>-Methode abgesendeten Formular abfragen 
wollen, so sollten sie die <I>GetExtProperties</I> Methode des BrowserHawk Objektes
nicht verwenden.<BR>
Der Grund liegt darin, da&szlig; die Komponente intern beim Aufruf der <I>GetExtProperties</I> 
Methode eine HTML Seite mit JavaScript Code an den Browser schickt und darauf wartet, 
bis der Browser wieder antwortet. Die Antwort des Browsers kommmt als nochmaliger Aufruf 
der Seite, wobei im QueryString der Parameter <I>bhjs</I> einen Wert bekommt.
Durch diesen nochmaligen Aufruf gehen aber alle geposteten Werte des Formulars verloren.
Es bieten sich folgende Auswege an:<BR><BR>
	<OL START="1">
	<LI>Wenn die Formulardaten eine Gr&ouml;&szlig;enordnung von 512 bis 2000 Zeichen
	nicht &uuml;berschreiten, so k&ouml;nnen sie die <I>GET</I> Methode verwenden um 
	das Formular abzuschicken. 
	Auf der ASP Seite, die die Daten entgegen nimmt, m&uuml;ssen sie dann
	statt der <I>Request.Form</I> Collection die <I>Request.QueryString</I> Collection 
	benutzen.</LI>
	<LI>Sie lesen UND verarbeiten die Werte vor dem Aufruf der <I>GetExtProperties</I> Methode.
	Dies hat den Nachteil, da&szlig; sie Fomularwerte nur &uuml;ber sehr gro&szlig;e Umwege
	in der weiteren ASP Seite verwenden k&ouml;nnen. Au&szlig;erdem m&uuml;ssen sie 
	beim Aufruf der Seite pr&uuml;fen, ob gerade das abgesendete Formular bearbeitet 
	wird oder nur der von der <I>GetExtProperties</I> Methode initiierte Reload der 
	Seite im Gange ist. Hat die ASP Seite ein mittels <I>POST</I>-Methode 
	abgesendetes Formular empfangen, so ist die folgende Bedingung erf&uuml;llt:<BR>
	</LI>
	</OL>
</LI>
</UL>
	<pre style="background='silver';">
	Request.ServerVariables("CONTENT_LENGTH") &lt;&gt; 0
	</pre>
<UL>
<LI>Wenn am Browser JavaScript deaktiviert ist, oder er keine client-seitigen Scripts 
ausf&uuml;hren kann, so liefert die <I>Flash</I> Eigenschaft des BrowserHawk Objektes 
(nat&uuml;rlich nach vorherigem Aufruf der <I>GetExtProperties</I> Methode) den Wert 
<B>-1</B>, was darauf hinweist, da&szlig; BrowserHawk nicht bestimmen konnte ob
ein Flash Plug-In installiert ist.</LI>
</UL>
<h2>Download des Codes</h2>
<p><a href="../Code/20000411.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20000410.htm">Browsereigenschaften mit BrowserHawk 2000 bestimmen</a><br>
<a href="20020320.htm">Flash Detection ohne Komponente</a><br>
<a href="20020321.htm">Flash Movies einbetten einfach gemacht</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2ECyScape%2Ecom%2Fproducts%2F">BrowserHawk 2000</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Emacromedia%2Ecom%2Fde%2Fsoftware%2Fflash%2Fproductinfo%2F">Macromedia Flash</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20000411" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Flash Plug-In Erkennung"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20000411.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Koller"><input type="hidden" name="AuthorEmail" value="christiank@aspexpert.com"><input type="hidden" name="Artikel" value="20000411"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20000411.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
