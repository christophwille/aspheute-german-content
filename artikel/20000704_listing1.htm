
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML>
<HEAD>
<TITLE>20000704.asp</TITLE>
<STYLE>
BODY {
  font-family: "sans-serif";
  bgcolor: "#FFFFFF";
}

PRE {
  font-family: "monospaced";
  }

#statement {
  color: "#0000FF"; /* Color for Script Statements (things like Call, Dim, If...Then...Else, etc) */
  }

#function {
  color: "#FF0000"; /* Color for Script Functions (things like Instr, Abs, etc) */
  }

#script {
  color: "#800000"; /* Color for anything that is not in one of the above script categories, but is
                      contained inside script delimeters */
  }

#scripton {
  color: "#FF00FF"; /* Color for anything that is not in one of the above script categories, but is
                      contained inside script delimeters, inside quotation marks */
  }

#html {
  color: "#0000FF"; /* Color for any non-script html output */
  }

#base {
  color: "#000000"; /* Color for any non-script, non-html output */
  }

#comment {
  color: "#008000"; /* Color for any commented code */
  }

#linenum {
  color: "#808080"; /* Color for the line numbers */
  }
</STYLE>
</HEAD>

<BODY>

<pre><span id="linenum">001&nbsp;&nbsp;</span><span id="html">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;</span><br><span id="linenum">002&nbsp;&nbsp;</span><br><span id="linenum">003&nbsp;&nbsp;</span><span id="html">&lt;html&gt;</span><br><span id="linenum">004&nbsp;&nbsp;</span><span id="html">&lt;head&gt;</span><br><span id="linenum">005&nbsp;&nbsp;</span>	<span id="html">&lt;title&gt;</span>Untitled<span id="html">&lt;/title&gt;</span><br><span id="linenum">006&nbsp;&nbsp;</span><span id="html">&lt;/head&gt;</span><br><span id="linenum">007&nbsp;&nbsp;</span><br><span id="linenum">008&nbsp;&nbsp;</span><span id="html">&lt;body&gt;</span><br><span id="linenum">009&nbsp;&nbsp;</span><br><span id="linenum">010&nbsp;&nbsp;</span><span id="script">&lt;%<br><span id="linenum">011&nbsp;&nbsp;</span><span id="statement">Dim </span>Anz <br><span id="linenum">012&nbsp;&nbsp;</span><span id="statement">Dim </span>name(12), wert(12)<br><span id="linenum">013&nbsp;&nbsp;</span><span id="statement">Dim </span>nI<br><span id="linenum">014&nbsp;&nbsp;</span><span id="statement">Dim </span>width, height, colwidth, barwidth<br><span id="linenum">015&nbsp;&nbsp;</span><br><span id="linenum">016&nbsp;&nbsp;</span><span id="comment">' Anzahl der Werte</span><br><span id="linenum">017&nbsp;&nbsp;</span>Anz = 12<br><span id="linenum">018&nbsp;&nbsp;</span><br><span id="linenum">019&nbsp;&nbsp;</span><span id="comment">' Werte:</span><br><span id="linenum">020&nbsp;&nbsp;</span>nI = 0<br><span id="linenum">021&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Jan"</span> : wert(nI)=15<br><span id="linenum">022&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Feb"</span> : wert(nI)=9<br><span id="linenum">023&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Mar"</span> : wert(nI)=12<br><span id="linenum">024&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Apr"</span> : wert(nI)=3<br><span id="linenum">025&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Mai"</span> : wert(nI)=-2<br><span id="linenum">026&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Jun"</span> : wert(nI)=1<br><span id="linenum">027&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Jul"</span> : wert(nI)=-3<br><span id="linenum">028&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Aug"</span> : wert(nI)=5<br><span id="linenum">029&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Sep"</span> : wert(nI)=14<br><span id="linenum">030&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Okt"</span> : wert(nI)=17<br><span id="linenum">031&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Nov"</span> : wert(nI)=11<br><span id="linenum">032&nbsp;&nbsp;</span>nI = nI + 1: name(nI)=<span id="scripton">"Dez"</span> : wert(nI)=6<br><span id="linenum">033&nbsp;&nbsp;</span><br><span id="linenum">034&nbsp;&nbsp;</span><span id="comment">' Suche Max und Min Werte</span><br><span id="linenum">035&nbsp;&nbsp;</span>max=0 : min=0<br><span id="linenum">036&nbsp;&nbsp;</span><span id="statement">For </span>nI=1<span id="statement"> To </span><span id="function">UBound</span>(wert)<br><span id="linenum">037&nbsp;&nbsp;</span>	<span id="statement">If </span>wert(nI) &gt; max <span id="statement"><span id="statement">Then</span> </span><br><span id="linenum">038&nbsp;&nbsp;</span>		max = wert(nI)<br><span id="linenum">039&nbsp;&nbsp;</span>	<span id="statement">Else</span><span id="statement">If </span>wert(nI) &lt; min <span id="statement">Then</span><br><span id="linenum">040&nbsp;&nbsp;</span>		min = wert(nI)<br><span id="linenum">041&nbsp;&nbsp;</span>	<span id="statement">End If</span><br><span id="linenum">042&nbsp;&nbsp;</span><span id="statement">Next</span><br><span id="linenum">043&nbsp;&nbsp;</span><br><span id="linenum">044&nbsp;&nbsp;</span><br><span id="linenum">045&nbsp;&nbsp;</span><br><span id="linenum">046&nbsp;&nbsp;</span><span id="comment">' Konstruiere waagrechtes Balkendiagramm</span><br><span id="linenum">047&nbsp;&nbsp;</span><span id="comment">' Gesamtbreite der Balkengrafik</span><br><span id="linenum">048&nbsp;&nbsp;</span>width = 450<br><span id="linenum">049&nbsp;&nbsp;</span><br><span id="linenum">050&nbsp;&nbsp;</span><span id="comment">' Suche Multiplikator fuer Balken</span><br><span id="linenum">051&nbsp;&nbsp;</span><span id="statement">If </span>(max - min) &lt; 1 <span id="statement"><span id="statement">Then</span> </span><br><span id="linenum">052&nbsp;&nbsp;</span>	k = 1<br><span id="linenum">053&nbsp;&nbsp;</span><span id="statement">Else</span><br><span id="linenum">054&nbsp;&nbsp;</span>	k = width / (max - min)<br><span id="linenum">055&nbsp;&nbsp;</span><span id="statement">End If</span><br><span id="linenum">056&nbsp;&nbsp;</span><br><span id="linenum">057&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;h2&gt;Waagrechtes Balkendiagramm&lt;/h2&gt;"</span><br><span id="linenum">058&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;table border=0 cellspacing=0 cellpadding=0&gt;"</span> & VbCrLf<br><span id="linenum">059&nbsp;&nbsp;</span><br><span id="linenum">060&nbsp;&nbsp;</span><span id="statement">For </span>nI = 1 to Anz<br><span id="linenum">061&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&lt;tr&gt;"</span> & VbCrLf<br><span id="linenum">062&nbsp;&nbsp;</span>	<span id="comment">' Bezeichnung:</span><br><span id="linenum">063&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"    &lt;td&gt;"</span> & Server.HTMLEncode(name(nI)) & <span id="scripton">": &lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">064&nbsp;&nbsp;</span>	<span id="comment">' Negativer Bereich</span><br><span id="linenum">065&nbsp;&nbsp;</span>	<span id="statement">If </span>wert(nI) &lt; 0 <span id="statement">Then</span><br><span id="linenum">066&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"    &lt;td align="</span><span id="scripton">"RIGHT"</span><span id="scripton">"&gt;"</span><br><span id="linenum">067&nbsp;&nbsp;</span>		<br><span id="linenum">068&nbsp;&nbsp;</span>		<span id="comment">' Wert hinaus schreiben</span><br><span id="linenum">069&nbsp;&nbsp;</span>		Response.Write wert(nI) & <span id="scripton">" "</span> <br><span id="linenum">070&nbsp;&nbsp;</span>		<br><span id="linenum">071&nbsp;&nbsp;</span>		<span id="comment">' negativen Balken</span><br><span id="linenum">072&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;img src="</span><span id="scripton">"red.jpg"</span><span id="scripton">" border=0 "</span><br><span id="linenum">073&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"width="</span> & int(abs(wert(nI)*k)+0.5)<br><span id="linenum">074&nbsp;&nbsp;</span>		Response.Write <span id="scripton">" height=15&gt;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">075&nbsp;&nbsp;</span>	<span id="statement">Else</span><br><span id="linenum">076&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"    &lt;td&gt;&nbsp;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">077&nbsp;&nbsp;</span>	<span id="statement">End If</span><br><span id="linenum">078&nbsp;&nbsp;</span>	<br><span id="linenum">079&nbsp;&nbsp;</span>	<span id="comment">' Nulllinie</span><br><span id="linenum">080&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&lt;td&gt;&lt;img src="</span><span id="scripton">"black.jpg"</span><span id="scripton">" border=0 width=2 height=25&gt;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">081&nbsp;&nbsp;</span>	<br><span id="linenum">082&nbsp;&nbsp;</span>	<span id="comment">' Positiver Bereich</span><br><span id="linenum">083&nbsp;&nbsp;</span>	<span id="statement">If </span>wert(nI) &gt; 0 <span id="statement">Then</span><br><span id="linenum">084&nbsp;&nbsp;</span>		<span id="comment">' positiver Balken</span><br><span id="linenum">085&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"    &lt;td&gt;&lt;img src="</span><span id="scripton">"green.jpg"</span><span id="scripton">" border=0 "</span><br><span id="linenum">086&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"width="</span> & int(abs(wert(nI)*k)+0.5)<br><span id="linenum">087&nbsp;&nbsp;</span>		Response.Write <span id="scripton">" height=15&gt; "</span><br><span id="linenum">088&nbsp;&nbsp;</span>		<span id="comment">' positiver Wert</span><br><span id="linenum">089&nbsp;&nbsp;</span>		Response.Write wert(nI)<br><span id="linenum">090&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">091&nbsp;&nbsp;</span>	<span id="statement">Else</span><br><span id="linenum">092&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"    &lt;td&gt;&nbsp;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">093&nbsp;&nbsp;</span>	<span id="statement">End If</span><br><span id="linenum">094&nbsp;&nbsp;</span><br><span id="linenum">095&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&lt;/tr&gt;"</span> & VbCrLf<br><span id="linenum">096&nbsp;&nbsp;</span><span id="statement">Next</span><br><span id="linenum">097&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;/table&gt;"</span> & VbCrLf<br><span id="linenum">098&nbsp;&nbsp;</span><br><span id="linenum">099&nbsp;&nbsp;</span><br><span id="linenum">100&nbsp;&nbsp;</span><br><span id="linenum">101&nbsp;&nbsp;</span><span id="comment">' Konstruiere senkrechtes Balkendiagramm</span><br><span id="linenum">102&nbsp;&nbsp;</span><span id="comment">' Gesamtbreite der Balkengrafik</span><br><span id="linenum">103&nbsp;&nbsp;</span>width = 500<br><span id="linenum">104&nbsp;&nbsp;</span><span id="comment">' Gesamthoehe der Balkengrafik</span><br><span id="linenum">105&nbsp;&nbsp;</span>height = 260<br><span id="linenum">106&nbsp;&nbsp;</span><br><span id="linenum">107&nbsp;&nbsp;</span>	<span id="comment">' Breite der Spalten</span><br><span id="linenum">108&nbsp;&nbsp;</span>colwidth = int(width/anz+1)<br><span id="linenum">109&nbsp;&nbsp;</span>	<span id="comment">' Breite der Balken</span><br><span id="linenum">110&nbsp;&nbsp;</span>barwidth = colwidth - 10<br><span id="linenum">111&nbsp;&nbsp;</span><span id="comment">' Suche Multiplikator fuer Balken</span><br><span id="linenum">112&nbsp;&nbsp;</span><span id="statement">If </span>(max - min) &lt; 1 <span id="statement"><span id="statement">Then</span> </span><br><span id="linenum">113&nbsp;&nbsp;</span>	k = 1<br><span id="linenum">114&nbsp;&nbsp;</span><span id="statement">Else</span><br><span id="linenum">115&nbsp;&nbsp;</span>	k = height / (max - min)<br><span id="linenum">116&nbsp;&nbsp;</span><span id="statement">End If</span><br><span id="linenum">117&nbsp;&nbsp;</span><br><span id="linenum">118&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;h2&gt;Senkrechtes Balkendiagramm&lt;/h2&gt;"</span><br><span id="linenum">119&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;table border=0 cellspacing=0 cellpadding=0&gt;"</span> & VbCrLf<br><span id="linenum">120&nbsp;&nbsp;</span><br><span id="linenum">121&nbsp;&nbsp;</span><span id="comment">' Positiver Bereich</span><br><span id="linenum">122&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;tr&gt;"</span> & VbCrLf<br><span id="linenum">123&nbsp;&nbsp;</span><span id="statement">For </span>nI = 1 to Anz<br><span id="linenum">124&nbsp;&nbsp;</span>	<span id="statement">If </span>wert(nI) &gt; 0 <span id="statement">Then</span><br><span id="linenum">125&nbsp;&nbsp;</span>		<span id="comment">' positiver Wert</span><br><span id="linenum">126&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;td align="</span><span id="scripton">"CENTER"</span><span id="scripton">" valign="</span><span id="scripton">"BOTTOM"</span><span id="scripton">"&gt;"</span> & VbCrLf<br><span id="linenum">127&nbsp;&nbsp;</span>		Response.Write wert(nI)<br><span id="linenum">128&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;BR&gt;"</span> & VbCrLf<br><span id="linenum">129&nbsp;&nbsp;</span>		<span id="comment">' positiver Balken</span><br><span id="linenum">130&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;img src="</span><span id="scripton">"green.jpg"</span><span id="scripton">" border=0 "</span><br><span id="linenum">131&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"width="</span> & barwidth<br><span id="linenum">132&nbsp;&nbsp;</span>		Response.Write <span id="scripton">" height="</span> & int(abs(wert(nI)*k)+0.5)<br><span id="linenum">133&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&gt;"</span><br><span id="linenum">134&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">135&nbsp;&nbsp;</span>	<span id="statement">Else</span><br><span id="linenum">136&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;td&gt;&nbsp;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">137&nbsp;&nbsp;</span>	<span id="statement">End If</span><br><span id="linenum">138&nbsp;&nbsp;</span><span id="statement">Next</span><br><span id="linenum">139&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;/tr&gt;"</span> & VbCrLf<br><span id="linenum">140&nbsp;&nbsp;</span><br><span id="linenum">141&nbsp;&nbsp;</span><span id="comment">' Nulllinie</span><br><span id="linenum">142&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;tr&gt;"</span> & VbCrLf<br><span id="linenum">143&nbsp;&nbsp;</span><span id="statement">For </span>nI = 1 to Anz<br><span id="linenum">144&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&lt;td align="</span><span id="scripton">"CENTER"</span><span id="scripton">" valign="</span><span id="scripton">"MIDDLE"</span><span id="scripton">"&gt;"</span><br><span id="linenum">145&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&lt;img src="</span><span id="scripton">"black.jpg"</span><span id="scripton">" border=0 "</span><br><span id="linenum">146&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"width="</span> & colwidth <br><span id="linenum">147&nbsp;&nbsp;</span>	Response.Write <span id="scripton">" height=2&gt;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">148&nbsp;&nbsp;</span><span id="statement">Next</span><br><span id="linenum">149&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;/tr&gt;"</span> & VbCrLf<br><span id="linenum">150&nbsp;&nbsp;</span><br><span id="linenum">151&nbsp;&nbsp;</span><br><span id="linenum">152&nbsp;&nbsp;</span><span id="comment">' Negativer Bereich</span><br><span id="linenum">153&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;tr&gt;"</span> & VbCrLf<br><span id="linenum">154&nbsp;&nbsp;</span><span id="statement">For </span>nI = 1 to Anz<br><span id="linenum">155&nbsp;&nbsp;</span>	<span id="statement">If </span>wert(nI) &lt; 0 <span id="statement">Then</span><br><span id="linenum">156&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;td valign="</span><span id="scripton">"TOP"</span><span id="scripton">" align="</span><span id="scripton">"CENTER"</span><span id="scripton">"&gt;"</span> & VbCrLf<br><span id="linenum">157&nbsp;&nbsp;</span>		<span id="comment">' negativen Balken</span><br><span id="linenum">158&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;img src="</span><span id="scripton">"red.jpg"</span><span id="scripton">" border=0 "</span><br><span id="linenum">159&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"width="</span> & barwidth<br><span id="linenum">160&nbsp;&nbsp;</span>		Response.Write <span id="scripton">" height="</span> & int(abs(wert(nI)*k)+0.5)<br><span id="linenum">161&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&gt;"</span><br><span id="linenum">162&nbsp;&nbsp;</span>		<span id="comment">' Wert hinaus schreiben</span><br><span id="linenum">163&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;BR&gt;"</span><br><span id="linenum">164&nbsp;&nbsp;</span>		Response.Write wert(nI) & VbCrLf <br><span id="linenum">165&nbsp;&nbsp;</span>	<span id="statement">Else</span><br><span id="linenum">166&nbsp;&nbsp;</span>		Response.Write <span id="scripton">"&lt;td&gt;&nbsp;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">167&nbsp;&nbsp;</span>	<span id="statement">End If</span><br><span id="linenum">168&nbsp;&nbsp;</span><span id="statement">Next</span><br><span id="linenum">169&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;/tr&gt;"</span> & VbCrLf<br><span id="linenum">170&nbsp;&nbsp;</span>	<br><span id="linenum">171&nbsp;&nbsp;</span><span id="comment">' Bezeichnungen:</span><br><span id="linenum">172&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;tr&gt;"</span> & VbCrLf<br><span id="linenum">173&nbsp;&nbsp;</span><span id="statement">For </span>nI = 1 to Anz<br><span id="linenum">174&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&lt;td align="</span><span id="scripton">"CENTER"</span><span id="scripton">"&gt;&nbsp;"</span> <br><span id="linenum">175&nbsp;&nbsp;</span>	Response.Write  Server.HTMLEncode(name(nI))<br><span id="linenum">176&nbsp;&nbsp;</span>	Response.Write <span id="scripton">"&nbsp;&lt;/td&gt;"</span> & VbCrLf<br><span id="linenum">177&nbsp;&nbsp;</span><span id="statement">Next</span><br><span id="linenum">178&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;/tr&gt;"</span> & VbCrLf<br><span id="linenum">179&nbsp;&nbsp;</span><br><span id="linenum">180&nbsp;&nbsp;</span>Response.Write <span id="scripton">"&lt;/table&gt;"</span> & VbCrLf<br><span id="linenum">181&nbsp;&nbsp;</span><br><span id="linenum">182&nbsp;&nbsp;</span>%&gt;</span><br><span id="linenum">183&nbsp;&nbsp;</span><br><span id="linenum">184&nbsp;&nbsp;</span><br><span id="linenum">185&nbsp;&nbsp;</span><br><span id="linenum">186&nbsp;&nbsp;</span><br><span id="linenum">187&nbsp;&nbsp;</span><span id="html">&lt;/body&gt;</span><br><span id="linenum">188&nbsp;&nbsp;</span><span id="html">&lt;/html&gt;</span><br></pre>
</BODY>
</HTML>
