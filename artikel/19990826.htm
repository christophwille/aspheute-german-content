<HTML>
<HEAD>
<TITLE>ODBC und ASP - Eine DSN zur Verwendung mit ASP definieren</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="So erstellen Sie Datasources (DSN) korrekt f&uuml;r Microsoft SQL Server Microsoft Access.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,DSN,ADO,ODBC,datasource,Access,SQL Server,Datenbank">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>ODBC und ASP - Eine DSN zur Verwendung mit ASP definieren</H1>
<p>
Geschrieben von: <a href="../autoren/christiankoller.htm">Christian Koller</a><br>
Kategorie: <a href="../kategorien/Datenbank.htm">Datenbank</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=19990826"></SCRIPT>
</p>
<p>
Einer der einfachsten Wege um unter ASP eine Verbindung zu einer Datenbank herzustellen ist, die zugeh&ouml;rige 
ODBC DSN zu definieren und einzusetzen. Nur kurz zur Erl&auml;uterung. ODBC steht f&uuml;r Open Database Connectivity 
und ist ein Standard Protokoll, das Applikationen erlaubt zu einer Vielzahl von externen Datenquellen wie 
Datenbanken oder Dateien eine Verbindung herzustellen. DSN hingegen steht f&uuml;r Data Source Name und enth&auml;lt 
alle Informationen um zu einer Datenbank zu verbinden. Eine DSN wird vom ODBC Treiber Manager zum Herstellen 
einer Datenbankverbindung benutzt.
</p>
<p>
Bei einer ODBC DSN handelt es sich um eine einmal definierte und konfigurierte Datenbankverbindung die unter 
Windows durch Angabe des Namens von den unterschiedlichsten Programmen und ASP Skripts verwendet werden kann.
</p>
<p>
Wie richtet man nun eine ODBC DSN richtig ein, um sie unter ASP einsetzen zu k&ouml;nnen? Man sollte einige Grundkenntnisse 
&uuml;ber den IIS und die Windows NT Security besitzen, oder sich an die in diesem Artikel beschriebenen 
Kochrezepte halten.
</p>
<p>
Nun zum Einrichten einer ODBC DSN f&uuml;r den Gebrauch mit ASP, beschrieben anhand der wohl am h&auml;ufigsten 
vorkommenden F&auml;lle, der Verbindung zu einer <a href="19990826.htm#kochenaccess">Access</a>- oder <a href="19990826.htm#kochensql">SQL Server</a> Datenbank.
</p>
<p>
<h3><a name="kochenaccess">Kochrezept zum Einrichten einer Access DSN unter Windows NT Server 4.0</a></h3>
<ol>
	<li>Klicken Sie auf Start, Einstellungen, Systemsteuerung
	<li>&Ouml;ffnen Sie den ODBC-Datenquellen Administrator
	<li>Um sicherzustellen, da&szlig; alle Programme, auch wenn sie unter einem beliebigen Benutzeraccount 
		laufen, die DSN benutzen k&ouml;nnen m&uuml;ssen Sie eine System-DSN einrichten. Nur zur Auffrischung sei hier 
		daran erinnert, da&szlig; der IIS und damit die laufenden ASP Skripts unter dem <i>IUSR_Computername</i> Account 
		laufen um eine gewisse NT-Sicherheit zu gew&auml;hrleisten. Daher gehen Sie in den System-DSN Bereich.
	<li>Der ODBC-Datenquellen Administrator sollte nun in etwa wie Bild 1 aussehen.<br>
		<IMG SRC="Bilder/199908/990826_1.gif" width=478 height=403 border=0 alt="ODBC Datenquellenadministrator">
	<li>Klicken Sie auf <b>Hinzuf&uuml;gen</b> um eine neue System Datenquelle zu generieren
	<li>W&auml;hlen Sie den <i>Microsoft Access Treiber (*.mdb)</i> aus und klicken Sie auf <b>Fertig stellen</b>
	<li>Das ODBC Microsoft Access Setup Fenster erscheint<br>
		<IMG SRC="Bilder/199908/990826_2.gif" width=471 height=312 border=0 alt="ODBC Microsoft Access Setup">
	<li>Geben Sie nun den Datenquellennamen an der zur Kennzeichnung der DSN benutzt werden soll. Dies ist 
		der DSN, der beim &Ouml;ffnen einer Connection in ASP angegeben wird. 
	<li>Wenn Sie wollen k&ouml;nnen Sie eine Kurzbeschreibung der DSN im Feld Beschreibung angeben.
	<li>Klicken Sie auf <b>Ausw&auml;hlen</b> (Datenbank Frame).
	<li>Das Datenbank Auswahl Fenster erscheint. W&auml;hlen Sie die Access Datenbank die auf die diese DSN 
		gebunden werden soll und klicken Sie auf <b>OK</b>.<br>
		<IMG SRC="Bilder/199908/990826_3.gif" width=434 height=243 border=0 alt="Access Datenbank ausw&auml;hlen">
	<li>Stellen Sie die DSN fertig indem Sie auf <b>OK</b> im ODBC Microsoft Access Setup Fenster klicken.
	<li>Sie sehen nun, da&szlig; die neue System DSN im ODBC-Datenquellen Administrator angeben ist.
	<li>Schlie&szlig;en Sie das Fenster indem Sie auf <b>OK</b> klicken.
</ol>
Nun haben Sie eine System Datenquelle mit der von ihnen angegebenen DSN erstellt.
</p>
<p>
<h3><a name="kochensql">Kochrezept zum Einrichten einer SQL Server DSN unter Windows NT Server 4.0</a></h3>
<ol>
	<li>Klicken Sie auf Start, Einstellungen, Systemsteuerung
	<li>&Ouml;ffnen Sie den ODBC-Datenquellen Administrator
	<li>Um sicherzustellen, da&szlig; alle Programme, auch wenn sie unter einem beliebigen Benutzeraccount laufen, 
		die DSN benutzen k&ouml;nnen, m&uuml;ssen Sie eine System-DSN einrichten. Dazu gehen Sie in den System-DSN Bereich.
	<li>Klicken Sie auf <b>Hinzuf&uuml;gen</b> um eine neue System-DSN zu generieren.
	<li>W&auml;hlen Sie den <i>SQL Server</i> Treiber aus und klicken Sie auf <b>Fertig stellen</b>
	<li>Das SQL Server Datenquellen Fenster erscheint
	<li>Geben Sie den gew&uuml;nschten Namen der DSN sowie eventuell ein Beschreibung ein.
	<li>Geben Sie den Computernamen des SQL Datenbank Servers an auf dem die SQL Server Datenbank installiert ist. 
		Wenn die Datenbank auf dem lokalen Rechner installiert ist, so k&ouml;nnen Sie auch "(local)" angeben. Das SQL 
		Server Datenquellen Fenster sieht danach &auml;hnlich aus wie Bild 4.<br>
		<IMG SRC="Bilder/199908/990826_4.gif" width=575 height=323 border=0 alt="SQL Server Datenquellen Fenster">
	<li>Klicken Sie auf <b>Weiter</b> um die DSN zu konfigurieren
	<li>W&auml;hlen Sie die korrekte Authentizit&auml;ts &Uuml;berpr&uuml;fung, Clientkonfiguration, und setzen Sie <i>Zum SQL Server 
		verbinden um ...</i>. Vergessen Sie dabei nicht eine g&uuml;ltige Login-ID und das zugeh&ouml;rige Kennwort anzugeben. 
		F&uuml;r Details konsultieren Sie bitte die SQL Server Online-Dokumentation, siehe auch Bild 5.<br>
		<IMG SRC="Bilder/199908/990826_5.gif" width=575 height=323 border=0 alt="Authentizit&auml;ts &Uuml;berpr&uuml;fung, Zugang zur Clientkonfiguration">
	<li>Klicken Sie auf <b>Weiter</b> um die Konfiguration fortzusetzen.
	<li>Sollte ein Fehler auftreten dann lesen Sie die Fehlermeldung und l&ouml;sen Sie das Problem. Stellen Sie sicher, 
		da&szlig; der Datenbank-Server l&auml;uft und mit Hilfe des Netzwerkprotokolls, das Sie in der Clientkonfiguration 
		angegeben haben, eine Verbindung aufgebaut werden kann. Stellen Sie au&szlig;erdem sicher, da&szlig; die Login-ID und 
		das Kennwort einen Datenbank-Server Zugriff erlauben.
	<li>&Auml;ndern Sie die Standarddatenbank auf die Datenbank, auf den die DSN zugreifen soll und klicken Sie auf 
		<b>Weiter</b> (Siehe Bild 6).<br>
		<IMG SRC="Bilder/199908/990826_6.gif" width=575 height=323 border=0 alt="Standarddatenbank einstellen">
	<li>Je nach Ihren Bed&uuml;rfnissen k&ouml;nnen Sie noch &Auml;nderungen an den regionalen Einstellungen vornehmen. Danach klicken 
		Sie auf <b>Fertig stellen</b>.<br>
		<IMG SRC="Bilder/199908/990826_7.gif" width=575 height=323 border=0 alt="Sprach- und Konvertierungseinstellungen">
	<li>Die eingestellte Konfiguration wird im ODBC Microsoft SQL Server Setup Fenster dargestellt. Klicken Sie 
		auf <b>Datenquelle testen</b> um sicherzustellen, da&szlig; in der eingestellten Konfiguration auf die Datenbank 
		zugegriffen werden kann.
	<li>Wenn der Verbindungstest fehlschl&auml;gt so begutachten und beheben Sie den Fehler analog zu Schritt 12.
	<li>Beenden Sie den Setup Wizard durch einen Klick auf <b>OK</b>
</ol>
</p>
<p>
Einer der Hauptvorteile der Verwendung einer DSN in einem ASP Skript ist der, da&szlig; &uuml;ber eine DSN auf prinzipiell 
jede ODBC kompatible Datenquelle mit denselben Mechanismen und meist auch denselben ASP und SQL Befehlen 
zugegriffen werden kann. Nat&uuml;rlich steckt der Teufel auch hier wieder im Detail, so verh&auml;lt sich eine Textdatei 
als ODBC Datenquelle ein wenig anders als eine SQL Server Datenbank, da jeder ODBC Treiber seine Eigenheiten hat 
und m&ouml;glichst das Potential von Datenquellen aussch&ouml;pfen k&ouml;nnen sollte.
</p><h2>Verwandte Artikel</h2>
<p>
<a href="19990825.htm">ADO und ASP - Datenbanken einmal n&auml;her betrachtet</a><br>
<a href="20001023.htm">Das SQL Join Statement</a><br>
<a href="20001201.htm">Die SQL ORDER BY Clause</a><br>
<a href="20010424.htm">Ein Baummen&uuml; mit XTree Server erstellen</a><br>
<a href="20010503.htm">Eine einfache Newsletter Applikation</a><br>
<a href="20001107.htm">Einf&uuml;gen eines Datensatzes mit dem INSERT Statement</a><br>
<a href="20010201.htm">Einrichten des Snitz Forums</a><br>
<a href="20010515.htm">Universal Data Links mit ASP verwenden</a><br>
<a href="20000606.htm">Zugriff auf autom. generierte ID beim Einf&uuml;gen eines Datensatzes</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="19990826" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="ODBC und ASP - Eine DSN zur Verwendung mit ASP definieren"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/19990826.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Koller"><input type="hidden" name="AuthorEmail" value="christiank@aspexpert.com"><input type="hidden" name="Artikel" value="19990826"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/19990826.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
