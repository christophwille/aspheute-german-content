<HTML>
<HEAD>
<TITLE>Arbeiten mit dem SQL Server XML View Mapper</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Kennen Sie schon den SQL Server XML View Mapper von Microsoft? Wenn Sie sich mit XML besch&auml;ftigen, dann sollten Sie dieses Tool auf alle F&auml;lle kennenlernen!">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,SQL Server XML View Mapper,View,map,SQL Server,XML,Xpath,query,Abfrage,Mapping,XDR,Schema">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Arbeiten mit dem SQL Server XML View Mapper</H1>
<p>
Geschrieben von: <a href="../autoren/uwehess.htm">Uwe Hess</a><br>
Kategorie: <a href="../kategorien/XML.htm">XML</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20020416"></SCRIPT>
</p>
<p>
Kennen Sie schon den SQL Server XML View Mapper von Microsoft? Wenn Sie sich mit XML besch&auml;ftigen, dann sollten Sie dieses 
Tool auf alle F&auml;lle kennenlernen! Der SQL Server XML View Mapper erm&ouml;glicht unter anderem das Erstellen von XPath-Abfragen 
gegen eine SQL Server Datenbank, sowie projektbezogenes Arbeiten, und stellt dem Benutzer eine visuelle Arbeitsoberfl&auml;che 
zur Verf&uuml;gung. So einfach war das Arbeiten mit XML und XDR gegen SQL Server Datenbanken noch nie.
</p>
<p>
Mit dem <a href="http://msdn.microsoft.com/downloads../default.htm?ShowPane=false&URL=/code/sample.asp?url=/msdn-files/027/001/443/msdncompositedoc.xml" target="_blank">SQL Server XML View Mapper</a>
k&ouml;nnen Sie unter anderem folgende Aufgaben erledigen:
</p>

<ul>
	<li>Extrahieren von Daten als XML aus einer SQL Server Datenbank
	<li>Ausf&uuml;hren von XPath- Abfragen
	<li>Aktualisieren von Daten
	<li>XML-Daten als relationale Daten in eine SQL- Server Datenbank laden
	<li>Erstellen und Bearbeiten eines XDR-Schemas f&uuml;r den Entwurf von XPath- Abfragen
</ul>

<h2>Projektbasiertes Arbeiten</h2>
<p>
In diesem Artikel werden wir uns mit der Vorgehensweise zum Erstellen eines Projektes und der Ausf&uuml;hrung von XPath-Abfragen 
im SQL Server XML View Mapper besch&auml;ftigen. Sie k&ouml;nnen ein neues Projekt entweder mit einem bereits vorhandenen XDR-Schema 
anlegen, oder in einem neuen Projekt ein XDR-Schema erstellen lassen. Nachfolgend sehen Sie das Listing f&uuml;r ein XDR-Schema 
auf dessen Grundlage eine Abfrage gegen die Tabelle <i>Products</i> der Beispieldatenbank <i>Northwind</i> ausgef&uuml;hrt werden soll.
</p>

<pre style="background='silver';">
&lt;!-- mySchema.xml --&gt;
&lt;Schema xmlns="urn:schemas-microsoft-com:xml-data"
   xmlns:dt="urn:schemas-microsoft-com:datatypes"
   xmlns:sql="urn:schemas-microsoft-com:xml-sql"&gt;

   &lt;ElementType name="Products" &gt;
     &lt;AttributeType name="ProductID" /&gt;
     &lt;AttributeType name="ProductName" /&gt;
     &lt;AttributeType name="UnitPrice" /&gt;

     &lt;attribute type="ProductID" /&gt;
     &lt;attribute type="ProductName" /&gt;
     &lt;attribute type="UnitPrice" /&gt;
   &lt;/ElementType&gt;
&lt;/Schema&gt;
</pre>

<p>
Nach dem Starten der Anwendung pr&auml;sentiert sich diese dem Anwender mit drei Arbeitsfenstern und einem, auf der rechten Seite 
befindlichen, Projekt- Explorer. Um das neue Projekt anzulegen, w&auml;hlen Sie im SQL Server View Mapper den Men&uuml;punkt 
<i>File</i> / <i>New Project</i>. Zum Definieren einer Verbindung zu SQL Server klicken Sie auf das linke Arbeitsfenster 
(SQL- Fenster) und geben in dem erscheinenden Dialogfeld die Verbindungeinstellungen zur Datenbank an. Dieses Dialogfeld 
ist in der folgenden Abbildung zu sehen.
</p>

<IMG SRC="Bilder/200204/20020416_1.png" width="823" height="602" alt="" border="0">

<p>
Nach dem &Uuml;bernehmen der getroffenen Einstellungen erscheint ein Dialogfeld, in dem die abzufragenden Tabellen oder 
Views ausgew&auml;hlt werden:
</p>

<IMG SRC="Bilder/200204/20020416_2.png" width="426" height="397" alt="" border="0">

<p>
Mit dem Beenden dieses Dialogfeldes erfolgt automatisch die Anzeige der getroffenen Auswahl im linken Arbeitsfenster. Um 
ein XDR-Schema zu importieren f&uuml;hren Sie einen einfachen Mausklick auf das noch leere rechte Arbeitsfenster (XDR-Fenster) 
aus und w&auml;hlen in dem dann erscheinenden Dateibrowser die gew&uuml;nschte Schemadatei.
</p>

<IMG SRC="Bilder/200204/20020416_3.png" width="763" height="536" alt="" border="0">

<p>
Um nun eine auf diesem Schema basierende Abfrage auszuf&uuml;hren, bet&auml;tigen Sie die Schaltfl&auml;che Run und geben in dem erscheinenden 
Dialogfeld die auszuf&uuml;hrende XPath- Abfrage ein:
</p>

<IMG SRC="Bilder/200204/20020416_4.png" width="589" height="492" alt="" border="0">

<p>
In dem hier gezeigten Beispiel erfolgt die Ausf&uuml;hrung folgender Abfrage: <i>/Products[@UnitPrice&lt;31]</i>. Damit werden alle 
Datens&auml;tze der Tabelle <i>Products</i> angezeigt, deren Feld <i>UnitPrice</i> einen Eintrag mit einen Wert kleiner als 31 enth&auml;lt.
</p>

<p>
Nach dem Ausf&uuml;hren der Abfrage (Schaltfl&auml;che <i>Execute</i>) erfolgt die Anzeige des damit erzeugten XML- Dokumentes in einer neuen 
Instanz des Internet Explorer:
</p>

<IMG SRC="Bilder/200204/20020416_5.png" width="584" height="450" alt="" border="0">

<p>
Wenn Sie noch &uuml;ber kein XDR-Schema verf&uuml;gen, dann k&ouml;nnen Sie mit dem SQL Server View Mapper auf einfache Weise ein solches 
erstellen. Dazu legen Sie ein neues Projekt an, stellen wie bereits beschrieben eine Verbindung zu SQL Server her und w&auml;hlen 
die abzufragenden Tabellen oder Views aus. Anschlie&szlig;end markieren Sie im Projekt-Explorer mit der rechten Maustaste den 
Datenbankeintrag unter Knoten <i>SQL-Modules</i> und w&auml;hlen in dem damit erscheinenden Kontextmen&uuml; den Eintrag <i>Generate XDR-Module</i>. 
Damit erfolgt automatisch die Erzeugung eines, auf dem ausgew&auml;hlten Datenbankinhalten beruhendes, XDR-Schemas.
</p>

<p>
Wie Sie in der vorletzten Abbildung ersehen k&ouml;nnen, erfolgt die Visualisierung des Mappings zwischen den Feldern der 
abgefragten Tabelle und dem XDR-Schema mit Hilfe von unterbrochenen Linien. Zum Bearbeiten dieses automatisch vorgenommenen 
Mappings markieren Sie einen der Eintr&auml;ge des linken oder des rechten Arbeitsfensters und ziehen diesen bei bet&auml;tigter 
Maustaste zu dem gew&uuml;nschten Feld in den jeweils gegen&uuml;berliegenden Bereich. 
</p>

<p>
Um eine der Linien zu l&ouml;schen klicken Sie mit der rechten Maustaste einen der Eintr&auml;ge im XDR- Fenster an, und w&auml;hlen im 
erscheinenden Kontextmen&uuml; den Eintrag <i>Properties</i>. Damit erfolgt die Anzeige eines Eigenschaftendialoges in dem Sie unter <i>SQL</i> 
das K&auml;stchen <i>Do not map</i> aktivieren. Damit wird dieses Feld von dem Mapping mit der Datenquelle ausgeschlossen, was mit der 
automatisch vorgenommen Markierung des Eintrages mit Hilfe eines Kreuzicons erkennbar ist. Zum Abschlu&szlig; der Arbeit mit dem 
SQL Server XML View Mapper k&ouml;nnen Sie mit <i>File</i> / <i>Save Project</i> das jeweilige Projekt speichern und auf die hier getroffenen 
Einstellungen in einer weiteren Sitzung zur&uuml;ckgreifen.
</p>

<IMG SRC="Bilder/200204/20020416_6.png" width="593" height="433" alt="" border="0">

<h2>Schlu&szlig;bemerkung</h2>
<p>
Mit dem SQL Server View Mapper sind Sie in der Lage auf professionelle Weise XDR-Schemas zu testen und zu optimieren. Au&szlig;erdem 
eignet sich das Tool besonders zum Erlernen des Umgangs mit XPath-Abfragen. 
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20020416.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20000417.htm">Auslesen von XML Dateien mit dem DOM</a><br>
<a href="20001117.htm">Einfaches XML-Auslesen in .NET</a><br>
<a href="20010925.htm">Verwendung von XML-Schemas (XSD)</a><br>
<a href="20010514.htm">Was sind XML Schemas?</a><br>
<a href="20020116.htm">XML-Daten verarbeiten mit XSLT</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fmsdn%2Emicrosoft%2Ecom%2Fdownloads%2Fdefault%2Easp%3FShowPane%3Dfalse%26URL%3D%2Fcode%2Fsample%2Easp%3Furl%3D%2Fmsdn%2Dfiles%2F027%2F001%2F443%2Fmsdncompositedoc%2Exml">SQL Server XML View Mapper 1.0</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20020416" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Arbeiten mit dem SQL Server XML View Mapper"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20020416.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Uwe Hess"><input type="hidden" name="AuthorEmail" value="uwehess@gmx.de"><input type="hidden" name="Artikel" value="20020416"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20020416.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
