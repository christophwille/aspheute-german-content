<HTML>
<HEAD>
<TITLE>Crystal Reports mit DataSets bef&uuml;llen - Teil 2</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Nicht immer ist es optimal, einen Report direkt aus einer Datenbank zu bef&uuml;llen. Man w&uuml;nscht sich, Daten kurz vor dem Anzeigen noch zu manipulieren. Diese Artikelserie zeigt wie.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Crystal Reports,Report,Erstellung,Design,Programmierung,DataSet,disconnected,Anpassung,anpassen">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Crystal Reports mit DataSets bef&uuml;llen - Teil 2</H1>
<p>
Geschrieben von: <a href="../autoren/rudolfball.htm">Rudolf Ball</a><br>
Kategorie: <a href="../kategorien/ADOdotNET.htm">ADO.NET</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20030403"></SCRIPT>
</p>
<p>
DataSets bieten sich als Quelle f&uuml;r den Inhalt eines Reports an, da sie von der Datenbank disconnected sind. Doch es ist 
ein wenig knifflig, dieses DataSet hinter den Report zu schieben. Wie man einen solchen Report erstellen kann, lernen Sie heute
im zweiten Teil dieser Artikelserie.
</p>
<p>
F&uuml;r einen System&uuml;berblick lesen Sie bitte den <a href="20030402.htm">ersten Teil</a> dieser Artikelserie.
</p>

<h2>Der Report - Teil 1</h2>
<p>
Die Erstellung des Reports geschieht &uuml;ber einen Wizard. Wenn wir einen neuen Report hinzuf&uuml;gen ("Add new Item" -&gt; "Crystal 
Report") m&uuml;ssen wir uns zuerst entscheiden, ob wir den Report Expert oder eine leeren Report erzeugen wollen. Der Einfachheit 
halber entscheiden wir uns f&uuml;r den Expert.
</p>

<IMG SRC="Bilder/200304/20030403_1.png" width="365" height="438" alt="" border="0">

<p>
Nun, da wir in weiterer Folge keine Datenbank zu Grunde liegen haben, sondern ein DataSet, m&uuml;ssen wir dem Report dessen 
Struktur mitteilen. Da wir dem Report aber nicht sagen k&ouml;nnen "Nimm DataSet XY!" (da wir dieses noch nicht einmal erzeugt 
haben - dies geschieht erst zur Laufzeit), m&uuml;ssen wir uns eines Abbildes der Struktur des DataSets bedienen: einem XML Schema. 
XML Schemas (Extension .xsd) beschreiben die Struktur von XML Files und somit auch von DataSets. 
</p>
<p>
Da wir dieses XML Schema File nur genau einmal zur Definition der Datenstruktur unseres DataSets im Report ben&ouml;tigen bieten 
sich zwei M&ouml;glichkeiten an, das File zu erzeugen. Einerseits zur Laufzeit mittels einer "File.Exists" Abfrage, welche nur beim 
ersten Mal feuert. Wir ben&ouml;tigen das XML Schema jedoch zur Designzeit. Daher ist es n&uuml;tzlich, eine kleine und schnelle 
Applikation zu schreiben, welche uns vom gew&uuml;nschten DataSet ein XML Schema erzeuget, und wir nach Erzeugung dessen ungest&ouml;rt 
mit dem Design fortfahren k&ouml;nnten. Der Code f&uuml;r diese Konsolenapplikation folgt.
</p>

<h3>Konsolenapplikation zur Erzeugung eines DataSets - DataSet2XSD.cs</h3>
<p>
In die Konsolenapplikation DataSet2XSD m&uuml;ssen wir die Datenklasse DataSet4Report kopieren, um das gleiche DataSet zu erhalten. Die 
Main Methode sieht wie folgt aus.
</p>

<pre style="background='silver';">
static void Main(string[] args)
{
   try
   {
      DataSet4Report myDS4R = new DataSet4Report();
      DataSet myDS = myDS4R.Kochrezept(1);
      myDS.WriteXmlSchema("C:/inetpub/wwwroot/DataSet4Report/Kochrezept.xsd");
   }
   catch (Exception ex)
   {
      Console.WriteLine(ex.Message);
      Console.ReadLine();
   }
}
</pre>

<p>
Als erstes erzeugen wir eine Instanz unserer Klasse DataSet4Report und f&uuml;llen ein DataSet mit Hilfe der Methode Kochrezept. Der 
Export als XML Schema ist trivial und erfolgt &uuml;ber die Methode WriteXmlSchema. Der Eingabeparameter ist in diesem Fall unser 
lokaler Pfad am Webserver. Nun k&ouml;nnen wir mit dem Design unseres Reports fortsetzen.
</p>

<h2>Der Report - Teil 2</h2>
<p>
&Uuml;ber "More Data Sources" gelangen wir in den Men&uuml;punkt "ADO.NET (XML)".
</p>

<IMG SRC="Bilder/200304/20030403_2.png" width="581" height="447" alt="" border="0">

<p>
Hier hilft uns ein Dateidialog, das soeben erzeugte XML Schema zu finden.
</p>

<IMG SRC="Bilder/200304/20030403_3.png" width="450" height="405" alt="" border="0">

<p>
Nach Auswahl der Datei <b>Kochrezept.xsd</b> werden uns die Tabellen des DataSets pr&auml;sentiert.
</p>

<IMG SRC="Bilder/200304/20030403_4.png" width="581" height="447" alt="" border="0">

<p>
Hier m&uuml;ssen wir die Tabellen "Rezept" und "Zutaten" markieren und mittels "Insert Table" hinzuf&uuml;gen. Nach dem Klick auf 
"Next" gelangen wir auf folgende Seite.
</p>

<IMG SRC="Bilder/200304/20030403_5.png" width="581" height="447" alt="" border="0">

<p>
Hier wird uns die Struktur der Tabellen und vor allem deren Relationen angezeigt. Sollten wir noch kein Relationsobjekt 
erstellt haben h&auml;tten wir hier die M&ouml;glichkeit, dies manuell nachzuholen.
</p>

<IMG SRC="Bilder/200304/20030403_6.png" width="581" height="447" alt="" border="0">

<p>
Im n&auml;chsten Schritt m&uuml;ssen wir die Felder definieren, die wir am Report anzeigen wollen. Mittels "Add" w&auml;hlen wir aus der 
Tabelle Rezept "Rezeptname" und "Zubereitungszeit" und aus der Tabelle Zutaten "Zutat" und "Kosten". Somit haben wir alles 
Wichtige angegeben und k&ouml;nnen uns auf das Design des Reports konzentrieren. Hierzu m&uuml;ssen wir einen "Detail" Bereich einf&uuml;gen 
und Zutat und Kosten in selbigen einf&uuml;gen. Dies geht entweder durch Verschieben oder durch "Drag and Drop" vom Field Explorer 
auf der linken Seite. Sollten Sie links keine Field Explorer sehen, verzweifeln Sie nicht: Sie k&ouml;nnen ihn &uuml;ber View -&gt; 
Other Windows -&gt; Document Outline bzw. Ctr + Alt + T aktivieren. Eine L&ouml;sung hierf&uuml;r w&uuml;rde wie folgt aussehen.
</p>

<IMG SRC="Bilder/200304/20030403_7.png" width="638" height="321" alt="" border="0">

<p>
Somit haben wir alle Schritte ausgef&uuml;hrt, welche zum Erreichen des Ergebnisses von N&ouml;ten sind. Mit dieser Formatierung w&uuml;rde 
der Report wie der folgende Beispielreport aussehen.
</p>

<IMG SRC="Bilder/200304/20030403_8.png" width="533" height="515" alt="" border="0">

<p>
Sie k&ouml;nnen das Rezept nat&uuml;rlich nachkochen, daf&uuml;r &uuml;bernehme ich jedoch keine Verantwortung...
</p>

<h2>Vorschl&auml;ge und Einschr&auml;nkungen</h2>
<p>
Nat&uuml;rlich bietet es sich nicht in jedem Fall an, ein DataSet als Quelle f&uuml;r den Report zu verwenden. Vielmehr ist bei der 
Anzeige von nicht hierarchischen Daten eine direkte Anzeige der Datenbanktabelle bzw. Query einfacher. Auch ist die Anzeige 
in Crystal Reports nicht immer die optimale L&ouml;sung, Konkurrenzprodukte sind meist m&auml;chtiger und besser handzuhaben. Nat&uuml;rlich 
ist der Export von Crystal Reports ins Word- oder PDF Format eine gelungene Alternative.
</p>

<h2>Schlu&szlig;bemerkung</h2>
<p>
Ein DataSet hinter Crystal Reports zu schieben ist eine gute Alternative zur Direktverbindung mit der Datenbank. Es ist zwar 
ein wenig aufwendiger, aber es lohnt sich vor allem dann, wenn Sie mehrere Reports anzeigen wollen oder hierarchische Daten 
einfach und sicher angezeigt bekommen m&ouml;chten. Auch die Manipulation der Daten vor dem Anzeigen ist ein Punkt, der Ihnen 
wom&ouml;glich schon Kopfzerbrechen bereitet hat. 
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20030403.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20030402.htm">Crystal Reports mit DataSets bef&uuml;llen - Teil 1</a><br>
<a href="20001102.htm">Datenbankzugriff mittels ADO.NET</a><br>
<a href="20010514.htm">Was sind XML Schemas?</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Easpalliance%2Ecom%2Farticles%2Fcr1%2Easpx">Creating Professional Reports using Crystal Report for Visual Studio.NET</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Ecrystaldecisions%2Ecom%2Fproducts%2Fcrystalreports%2Fnet%2F">Crystal Report 9  The Visual Studio .NET Reporting Standard</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Easpfree%2Ecom%2Fauthors%2Fjitajay%2Fcrystalreport%2Easpx">Crystal Report for Visual Studio .NET</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Edotnetjunkies%2Ecom%2Ftutorials%2Easpx%3Ftutorialid%3D465">Loading a DataSet with Data from Multiple Tables</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Efawcette%2Ecom%2Fxmlmag%2F2002%5F04%2Fonline%2Fonline%5Feprods%2Fxml%5Fdwahlin04%5F22%2Fdefault%2Easp">XML Schemas vs. DTDs</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Eine weitere sehr hilfreiche Resource ist das <a href="http://aspxfiles.com/">deutsche ASP.NET Wiki</a>,
das als zentrale Anlaufstelle f&uuml;r Tips, Tricks, Know How und alles N&uuml;tzliche was man in seinem Alltag als 
(ASP).NET-Entwickler so braucht und entdeckt gedacht ist. 
</p>

<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20030403" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Crystal Reports mit DataSets bef&uuml;llen - Teil 2"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20030403.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Rudolf Ball"><input type="hidden" name="AuthorEmail" value="rball@edu.uni-klu.ac.at"><input type="hidden" name="Artikel" value="20030403"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20030403.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
