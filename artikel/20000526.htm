<HTML>
<HEAD>
<TITLE>Klassen in VBScript</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Seit Version 5.0 bietet VBScript die M&ouml;glichkeit, Klassen anzulegen und somit mit Eigenschaften und Methoden zu arbeiten. Ob sich Klassen wirklich sinnvoll in VBScript einsetzen lassen, soll dieser Artikel kl&auml;ren.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,VBScript,Class,Public,Private,Property,Get,Let,Set,Klasse,End Class,objektorientiert,Objekt">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Klassen in VBScript</H1>
<p>
Geschrieben von: <a href="../autoren/patricka_lorenz.htm">Patrick A. Lorenz</a><br>
Kategorie: <a href="../kategorien/ASP%20Tricks.htm">ASP Tricks</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20000526"></SCRIPT>
</p>
<p>
Seit Version 5.0 bietet VBScript die M&ouml;glichkeit, Klassen anzulegen und somit mit Eigenschaften und Methoden 
zu arbeiten. Jeder Entwickler einer h&ouml;heren Sprache wie VB, Delphi, C, etc. wird jetzt vor Vorfreude nerv&ouml;s mit 
den Augen zucken, aber ob sich Klassen wirklich sinnvoll in VBScript einsetzen lassen, soll 
dieser Artikel kl&auml;ren.
</p>
<p>
Wie normale Funktionen werden auch Klassen im normalen Kontext einer VBScript Datei notiert und nicht in 
einer separaten Datei, wie etwa in VB. Es wurde hierzu die Schl&uuml;sselworter <i>Class</i> und <i>End Class</i> eingef&uuml;hrt, die 
die eigentliche Klasse einrahmen.
<pre style="background=silver;">
Class ClassName
...
End Class
</pre>
</p>
<p>
Innerhalb der Klasse lassen sich nun mit Hilfe von 
<pre style="background=silver;">
[Private|Public] [Default] Sub|Function() 
</pre>
und 
<pre style="background=silver;">
[Private|Public] [Default] Property Get|Let|Set()
</pre>
</p>
<p>
Methoden und Eigenschaften implementieren. Der Syntax orientiert sich dabei am gro&szlig;en Visual Basic. 
</p>

<h2>Die Beispiel-Klasse TextOut</h2>
<p>
Die im folgenden dargestellte Klasse soll einen beliebigen Text in der Eigenschaft <b>Text</b> aufnehmen und diesen 
bei Aufruf der Methode <b>WriteLn</b> ausgeben. Der Code f&uuml;r die Klasse TextOut sowie den Code zum Testen der Klasse 
kann man in einer ASP Datei zusammenfassen:
<pre style="background=silver;">
&lt;% @LANGUAGE = "VBScript" %&gt
&lt;%
Class TextOut

 'Deklarationen
 Dim m_Text

 '&Ouml;ffentliche Eigenschaft Text
 Public Property Get Text
  Text = m_Text
 End Property

 Public Property Let Text(newText)
  m_Text = newText
 End Property

 '&Ouml;ffentliche Methode WriteLn()
 Public Function WriteLn()
  Response.Write Text  ' f&uuml;r ASP
  ' WScript.Echo Text    ' f&uuml;r WSH
 End Function
 
End Class

Dim x
Set x = New TextOut
With x
 .Text = "Hallo Welt"
 .WriteLn()
End With
%&gt;
</pre>
</p>
<p>
Die Klasse TextOut verf&uuml;gt &uuml;ber eine Eigenschaft Text, auf die lesend und schreibend zugegriffen werden kann. 
Der Inhalt der Eigenschaft wird in der Member Variable m_Text gespeichert. Zudem gibt es die Methode WriteLn 
mit dem der Inhalt der Eigenschaft ausgegeben werden kann - und zwar im Falle von ASP mit Response.Write. 
</p>
<p>
Vor dem Aufruf mu&szlig; die Klasse mit dem neuen Schl&uuml;sselwort <i>New</i> instanziert werden, <i>CreateObject</i> kann nicht 
verwendet werden. Danach kann das Objekt verwendet werden, indem man Eigenschaften und Methoden aufruft.
</p>

<h2>Die optionalen Schl&uuml;sselw&ouml;rter</h2>
<p>
Interessant sind auch die optionalen Schl&uuml;sselw&ouml;rter <i>Private</i> und <i>Public</i>, &uuml;ber die man wie im gro&szlig;en Bruder 
VB angeben kann, ob eine Eigenschaft oder Methode &ouml;ffentlich oder privat verwendet werden soll. Bei einer 
&ouml;ffentlichen Deklaration ist der Zugriff von au&szlig;en m&ouml;glich, bei einer privaten nur von innerhalb der Klasse. 
</p>
<p>
Wird weder Public noch Private bei der Deklaration angegeben, so nimmt VBScript automatisch Public an. Neben 
Methoden lassen sich auch Variablen als Public definieren, und sind somit &ouml;ffentlich zugreifbar. Dies erm&ouml;glicht 
den Wegfall des <i>Property Get|Let|Set</i> Konstruktes, was den Schreibaufwand unter Umst&auml;nden enorm reduzieren kann. 
</p>
<p>
Verk&uuml;rzt sieht unser obiges Beispiel wie folgt aus:
<pre style="background=silver;">
&lt;%
Class TextOut
 
 '&Ouml;ffentliche Variable Text
 Public Text

 '&Ouml;ffentliche Methode WriteLn()
 Public Default Function WriteLn()
  Response.Write Text  ' f&uuml;r ASP
  ' WScript.Echo Text    ' f&uuml;r WSH
 End Function
 
End Class

Set x = New TextOut
x.Text = "Hallo Welt"
x
%&gt;
</pre>
</p>
<p>
Im letzten Beispiel wurde das das Schl&uuml;sselwort Default verwendet. Hier&uuml;ber l&auml;&szlig;t sich eine Methode oder 
Eigenschaft festlegen, die nicht angegeben werden mu&szlig; um standard(default)m&auml;&szlig;ig aufgerufen zu werden. Bei 
Eigenschaften kann hier aber nur der Get Teil verwendet werden, da bedingt durch das Late Binding von 
VBScript der Wert ansonsten nicht der Standard-Eigenschaft sondern der instanzierten Klasse selbst zugewiesen 
werden w&uuml;rde und diese somit terminiert werden w&uuml;rde.
</p>

<h2>Praxis-Einsatz</h2>
<p>
Soweit die Theorie der Klassen in VBScript, aber wie sieht es nun aber in der Praxis aus? Als ich mich das 
erste Mal mit VBScript Klassen besch&auml;ftigt habe, schossen mir sofort Gedanken an Warenk&ouml;rbe, 
Benutzer-Verwaltungen, etc. in den Kopf. Sofort habe ich eine erste Klasse geschrieben und diese in einer 
Include-Datei abgelegt. Nun habe ich zwei ASP Seiten erstellt, die beide die Klasse included haben. Die erste 
Seite hat die Klasse in einer Variablen mit Session Scope instanziert und einige Eigenschaften zugewiesen. Die 
zweite Seite versucht nun, auf die Eigenschaften der Klasse zuzugreifen. Ergebnis: Ein ASP Runtime Error. 
Microsoft &auml;u&szlig;ert sich im Knowledgebase Artikel Q246596 dazu, best&auml;tigt und nennt als L&ouml;sung: "Only use 
VBScript classes with page-level scope.". Schade, w&auml;re es doch so sch&ouml;n gewesen.
</p>

<h2>Schlu&szlig;bemerkung</h2>
<p>
Das Klassen-Konstrukt von VBScript bietet eine Reihe von interessanten M&ouml;glichkeiten, die sich gerade in 
Verbindung mit Includes sehr gut nutzen lassen. Als Anwendungsbeispiel f&auml;llt mir hier spontan ein allgemeiner 
Mail-Parser ein, der auf der einen Seite mit Variablen und deren Inhalt gef&uuml;llt wird und auf der anderen 
Seite ein angegebenes Textfile parst und das Ergebnis versendet. Dieser Parser soll Inhalt eines weiteren 
Artikels sein. 
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20000526.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20000602.htm">Allgemeine MailParser-Klasse mit ASPMail</a><br>
<a href="20010605.htm">CSVs aus MDBs leicht gemacht</a><br>
<a href="20010607.htm">Daten aus CSV-Dateien in MDBs importieren</a><br>
<a href="20020320.htm">Flash Detection ohne Komponente</a><br>
<a href="20020430.htm">Gro&szlig;e Datenmengen in Formularfeldern erfolgreich auslesen</a><br>
<a href="20020408.htm">Klassenauflistungen mit dem Dictionary-Objekt</a><br>
<a href="20020411.htm">Kopieren verboten - Lizenzsicherung bei ASP Scripts</a><br>
<a href="20010606.htm">RemoteScripting - Einf&uuml;hrung, Tips und Tricks</a><br>
<a href="20011112.htm">Strukturierter Aufbau in der ASP-Programmierung</a><br>
<a href="20010423.htm">Tracing in ASP</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fsupport%2Emicrosoft%2Ecom%2Fsupport%2Fkb%2Farticles%2FQ246%2F5%2F96%2EASP">Only use VBScript classes with page-level scope</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20000526" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Klassen in VBScript"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20000526.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Patrick A. Lorenz"><input type="hidden" name="AuthorEmail" value="pl@p-l.de"><input type="hidden" name="Artikel" value="20000526"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20000526.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
