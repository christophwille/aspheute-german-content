<HTML>
<HEAD>
<TITLE>Einf&uuml;gen eines Datensatzes mit dem INSERT Statement</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Dieser Artikel zeigt wie man unter Verwendung des SQL INSERT Statements Datens&auml;tze in eine Datenbank einf&uuml;gt.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Insert,SQL Insert,SQL,Connection.Execute,ADO,Datenbank,INSERT INTO,SQL Statment">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Einf&uuml;gen eines Datensatzes mit dem INSERT Statement</H1>
<p>
Geschrieben von: <a href="../autoren/christiankoller.htm">Christian Koller</a><br>
Kategorie: <a href="../kategorien/Datenbank.htm">Datenbank</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20001107"></SCRIPT>
</p>
<p>Um einen Datensatz in eine Datenbank einzuf&uuml;gen, hat man von ASP aus zwei 
grunds&auml;tzlich verschiedene M&ouml;glichkeiten:
</p>

<p><ul>

<li>Mit einem SQL INSERT Statement: Zuerst wird das SQL Insert Statement erstellt, das alle Daten des
einzuf&uuml;genden Datensatzes enth&auml;lt. 
Danach wird der Datensatz durch Ausf&uuml;hren des INSERT Statements mittels 
<i>Connection.Execute</i> in die Datenbank &uuml;berspielt.</li>

<li>Mittels <i>Recordset.AddNew</i> und <i>Recordset.Update</i> (bzw. <i>Recordset.UpdateBatch</i>):
Ein Recordset wird ge&ouml;ffnet, danach mittels <i>Recordset.AddNew</i> ein neuer Datensatz angelegt,
die Daten des Datensatzes den Feldern (<i>Fields</i>) des Recordsets zugewiesen, und danach der 
Datensatz mittels Ausf&uuml;hren der <i>Recordset.Update</i> Methode in die Datenbank &uuml;bertragen.</li>

</ul></p>

<p>Hier m&ouml;chte ich zeigen, wie man das SQL INSERT Statement verwendet um einen Datensatz 
mittels ADO in eine Datenbank zu &uuml;bertragen.</p>


<h2>Erstellen des SQL INSERT Statements</h2>

<p>
Um zum Beispiel einen Datensatz mit 3 Werten in eine Datenbank zu speichern,
benutzt man ein INSERT Statement mit dem folgenden Syntax:
</p>

<p><pre style="background='silver';">
INSERT INTO <i>Tabelle</i> (<i>Feldname1</i>, <i>Feldname2</i>, <i>Feldname3</i>)
     VALUES (<i>Wert1</i>, <i>Wert2</i>, <i>Wert3</i>)
</pre></p>

<p>
Will man zum Beispiel eine Zahl und einen String in den Feldern <i>Name</i> und <i>Alter</i>
der Tabelle <i>Leute</i> speichern, so kann man das folgende INSERT Statement benutzen:</p>

<p><pre style="background='silver';">
INSERT INTO Leute (Name, Alter)
     VALUES ('Bugs Bunny', 7)
</pre></p>


<p>
Textwerte werden mittels Hochkomma begrenzt, Zahlenwerte einfach als Zahl in das SQL Statement
geschrieben. Will man in eine Access Datenbank ein Datum einf&uuml;gen, so benutzt man
ein Datum der Form <i>#10/31/2000#</i>. Zum Deklarieren eines Datums zum Einf&uuml;gen 
in eine SQL Server Datenbank benutzt man ein Datum der Form <i>'10/31/2000'</i>.
</p>


<p>
Nat&uuml;rlich kann man das SQL Statement dynamisch zusammenbauen:
</p>

<p><pre style="background='silver';">
strName = "Bugs Bunny"
intAlter = 7

strSQL = "INSERT INTO Leute (Name, Alter) " & _
   "VALUES ('" & Replace(strName, "'","''") & "', " & intAlter & ") "
</pre></p>

<p>Der <i>Replace</i> Befehl dient dazu, ein einzelnes Hochkomma in einem String 
durch ein doppeltes Hochkomma zu ersetzen. Dies ist notwendig, damit das Hochkomma
nicht als Ende des String Wertes, sondern als Hochkomma interpretiert wird.</p>


<h2>Ausf&uuml;hren des SQL INSERT Statements</h2>

<p>
Das SQL INSERT Statement f&uuml;hrt man, wie jedes andere SQL Statement,
mit Hilfe der <i>Connection.Execute</i> Methode aus. Die Variable <i>conn</i>
enth&auml;lt dabei die offene Connection (Verbindung zur Datenbank):
</p>

<p><pre style="background='silver';">
conn.Execute strSQL
</pre></p>




<h2>Schlu&szlig;bemerkung</h2>

<p>Das Einf&uuml;gen eines Datensatzes mittes SQL INSERT Statement ist denkbar einfach:
Das INSERT Statement generieren und mittels <i>Connection.Execute</i> ausf&uuml;ren</p>

<p>In kommenden Artikel m&ouml;chte ich zeigen, wie man einen Datensatz mittels 
<i>Recordset.AddNew</i> in eine Datenbank einf&uuml;gt.</p><h2>Verwandte Artikel</h2>
<p>
<a href="20000525.htm">Access Abfragen in ADO verwenden</a><br>
<a href="19990825.htm">ADO und ASP - Datenbanken einmal n&auml;her betrachtet</a><br>
<a href="20001124.htm">Aktualisieren von Daten mit dem UPDATE Statement</a><br>
<a href="20020429.htm">Benutzerverwaltung leicht gemacht: Teil 1</a><br>
<a href="20001127.htm">Datens&auml;tze mit dem DELETE Statement l&ouml;schen</a><br>
<a href="20011015.htm">Der SQL UNION Operator</a><br>
<a href="19990811.htm">Eigenschaften der Connection und Recordset Objekte</a><br>
<a href="20010420.htm">Ein einfacher Query Analyzer</a><br>
<a href="20000328.htm">Installation der neuesten ADO Version (ADO 2.5)</a><br>
<a href="19990826.htm">ODBC und ASP - Eine DSN zur Verwendung mit ASP definieren</a><br>
<a href="20020903.htm">Stored Procedures einfach erstellt</a><br>
<a href="20011017.htm">T-SQL Clauses: GROUP BY und HAVING</a><br>
<a href="20010213.htm">Update und UpdateBatch zum Einf&uuml;gen von Datens&auml;tzen in Datenbanken</a><br>
<a href="20010925.htm">Verwendung von XML-Schemas (XSD)</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20001107" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Einf&uuml;gen eines Datensatzes mit dem INSERT Statement"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20001107.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Koller"><input type="hidden" name="AuthorEmail" value="christiank@aspexpert.com"><input type="hidden" name="Artikel" value="20001107"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20001107.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
