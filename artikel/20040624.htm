<HTML>
<HEAD>
<TITLE>Wer bist Du? Eine kurze Einf&uuml;hrung in das .NET Reflection API</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Das sogenannte Reflection API liest aus den Metadaten der Objekte die Informationen &uuml;ber die angesprochenen Objekte bzw. deren Typen aus, d.h. die Objekte reflektieren &uuml;ber sich selbst.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Reflection,System.Reflection,MethodInfo,DataSource,DataBind,Spalte,dynamisch,binden,Bindung">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Wer bist Du? Eine kurze Einf&uuml;hrung in das .NET Reflection API</H1>
<p>
Geschrieben von: <a href="../autoren/alexanderzeitler.htm">Alexander Zeitler</a><br>
Kategorie: <a href="../kategorien/dotNET%20Fu.htm">.NET Fu</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20040624"></SCRIPT>
</p>
<p>
Will man zum Beispiel einem selbst entwickelten User- oder Server Control eine DataSource Property spendieren, welche 
au&szlig;er DataSets und Collections auch selbst (oder von Dritten) entwickelte Objekte (Klassen) verarbeiten kann, ist es notwendig, 
dass diese von einer von uns bereitgestellten Klasse erben oder ein Interface (z.B. ICollection) implementieren - im Normalfall.
</p>
<p>
Doch was tun, wenn der Entwickler, der unser Control verwendet, v&ouml;llig frei in der Gestaltung seiner Klassen sein soll, die 
er als DataSource zuweisen m&ouml;chte?  Ein Beispiel aus der Praxis: Wir entwickeln ein User Control, das Daten &auml;hnlich dem 
DataGrid pr&auml;sentiert. Der Entwickler hat nun eine Klasse Product, deren Properties er gerne mit unserem Control darstellen 
m&ouml;chte. Da der Entwickler das Design seiner Product-Klasse selbst festlegen mu&szlig; (wir wissen nicht, welche Eigenschaften 
seine Produkte besitzen), k&ouml;nnen wir ihm auch kein Interface bereitstellen, das er implementieren kann. 
</p>

<h2>Das Reflection API</h2>
<p>
Die L&ouml;sung hei&szlig;t <i>Reflection</i>. Das sogenannte Reflection API befindet sich im .NET Framework in dem Namespace 
<i>System.Reflection</i> und liest aus den Metadaten der Objekte die Informationen &uuml;ber die angesprochenen Objekte bzw. 
deren Typen aus, d.h. die Objekte reflektieren &uuml;ber sich selbst.
</p>
<p>
Die Metadaten beinhalten Informationen &uuml;ber Methoden, Eigenschaften, Events usw. der Objekttypen:
</p>

<IMG SRC="Bilder/200406/20040624.png" width="590" height="231" alt="" border="0">

<h2>Auslesen der Metainformationen</h2>
<p>
Wie kommen wir nun an diese Informationen? Wie bereits erw&auml;hnt, gewinnt Reflection die Informationen aus den Typen (bzw. 
deren Metadaten) selbst, d.h. wir m&uuml;ssen den Typ einer Instanz eines Objektes feststellen, &uuml;ber das wir Informationen 
erhalten m&ouml;chten.
</p>
<p>
In unserem Fall m&uuml;ssen wir die <i>DataSource</i>-Eigenschaft - genauer die Items in dieser DataSource - zur Typbestimmung 
heranziehen. Die Typbestimmung geschieht &uuml;ber die Methode <i>.GetType()</i>, welche jedes Objekt bereitstellt:
</p>

<pre style="background='silver';">
foreach(object DataSourceItem in DataSource)
{
    Type t = DataSourceItem.GetType();
}
</pre>

<p>
Um nun alle Eigenschaften (Properties) eines Typs zu lesen, verwenden wir die Methode <i>GetProperties()</i>. Diese liefert
ein Array vom Typ PropertyInfo zur&uuml;ck, welches die Properties beinhaltet. Das Auslesen aller Properties funktioniert wie folgt:
</p>

<pre style="background='silver';">
foreach(System.Reflection.PropertyInfo pi in t.GetProperties())
{
   Response.Write("Name der Eigenschaft: ");
   Response.Write(pi.Name + "&lt;br&gt;");
   Response.Write("Typ der Eigenschaft: ");
   Response.Write(pi.PropertyType + "&lt;br&gt;&lt;br&gt;");
}
</pre>

<p>
Analog hierzu gibt es z.B. f&uuml;r Methoden die Klasse MethodInfo - f&uuml;r Events verwenden wir EventInfo.
</p>
<p>
Au&szlig;erdem ist es auch m&ouml;glich, gezielt auf Eigenschaften usw. zuzugreifen. Hierzu gibt es z.B. die Methode 
.GetProperty (also Singular statt Plural im Methodenname).
</p>

<h2>Auslesen von Inhalten</h2>
<p>
Doch nicht nur die Eigenschaften, Methoden usw. von Objekten lassen sich per Reflection auslesen, sondern auch deren Inhalte.
</p>
<p>
Der Wert einer Eigenschaft eines instanzierten Objekts l&auml;sst sich mit der GetValue()-Methode herausfinden:
</p>

<pre style="background='silver';">
Response.Write("Wert der Eigenschaft:");
Response.Write(pi.GetValue(DataSourceItem,null).ToString() + "&lt;br&gt;");
</pre>

<h2>Ausf&uuml;hren von Methoden</h2>
<p>
Doch selbst hier ist Reflection noch nicht am Ende - Reflection erlaubt auch das Aufrufen von Methoden eines Objekts zur 
Laufzeit - erm&ouml;glicht wird das durch die <i>Invoke</i>-Methode der <i>MethodInfo</i>-Klasse - hier am Beispiel einer <i>Product</i>-Klasse, 
deren <i>Delete</i>-Methode wir zur Laufzeit ausf&uuml;hren werden:
</p>

<pre style="background='silver';">
Product myProduct = new Product();
Type t = myProduct.GetType();
MethodInfo mi = t.GetMethod("Delete");
mi.Invoke(p, null);
</pre>

<h2>Schlu&szlig;bemerkung</h2>
<p>
Wie man sieht, ist Reflection nicht nur graue Theorie, sondern auch in der Praxis durchaus n&uuml;tzlich und notwendig. Ein weiteres 
Beispiel aus der Praxis, das nahezu jeder t&auml;glich beim Entwickeln nutzt, ist die in Visual Studio .NET integrierte IntelliSense.
</p>
<p>
Weitere Informationen zum Reflection API finden sich in der 
<a href="http://msdn.microsoft.com/library../default.htm?url=/library/en-us/cpref/html/frlrfsystemreflection.asp" target="_blank">Dokumentation des System.Reflection-Namespaces</a>.
</p><h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fmsdn%2Emicrosoft%2Ecom%2Flibrary%2Fdefault%2Easp%3Furl%3D%2Flibrary%2Fen%2Dus%2Fcpref%2Fhtml%2Ffrlrfsystemreflection%2Easp">Dokumentation des System.Reflection-Namespaces</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Eine weitere sehr hilfreiche Resource ist das <a href="http://aspxfiles.com/">deutsche ASP.NET Wiki</a>,
das als zentrale Anlaufstelle f&uuml;r Tips, Tricks, Know How und alles N&uuml;tzliche was man in seinem Alltag als 
(ASP).NET-Entwickler so braucht und entdeckt gedacht ist. 
</p>

<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20040624" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Wer bist Du? Eine kurze Einf&uuml;hrung in das .NET Reflection API"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20040624.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Alexander Zeitler"><input type="hidden" name="AuthorEmail" value="azeitler@aspintranet.de"><input type="hidden" name="Artikel" value="20040624"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20040624.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
