<HTML>
<HEAD>
<TITLE>Emails senden mit CDONTS</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Das CDONTS Objekt eignet sich um Emails unter ASP zu versenden ohne den Webserver zu belasten oder einen User unnötig warten zu lassen. Daher ist es prädestiniert für Newsletter, Listserver oder Massenmails.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,ASP,Active Server Pages, IIS, SMTP Server, Emails versenden, Email, Newsletter, Massenmail, CDO, Collaboration Data Object, CDONTS.NewMail, Performance, Attachement, Webserver">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Emails senden mit CDONTS</H1>
<p>
Geschrieben von: <a href="../autoren/christiankoller.htm">Christian Koller</a><br>
Kategorie: <a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20000515"></SCRIPT>
</p>
<p>CDO (Collaboration Data Object) ist ein vom IIS 4.0 zur Verf&uuml;gung gestelltes 
Interface, das es erlaubt, Emails &uuml;ber einen SMTP- oder Exchange Server zu versenden.</p>

<p>Ein SMTP Server zum Versenden von Emails wird mit IIS 4.0 mitgeliefert, wobei CDO 
die Schnittstelle zwischen Webapplikationen (ASP-Seiten) des IIS 4.0 auf der einen Seite,
und dem SMTP Server auf der anderen Seite bildet.</p>

<p>Die CDO Library stellt das <i>CDONTS.NewMail</i> Objekt zur Verf&uuml;gung, 
das eine einfache Handhabung und hohe Performance vereint. <i>CDONTS</i> steht dabei
f&uuml;r "<i>Collaboration Data Object for NT Server</i>".
Das <i>CDONTS.NewMail</i> Objekt l&auml;sst sich leicht einsetzen 
um eine Email aus einer ASP Seite heraus zu verschicken, 
wie das folgende VBScript Beispiel zeigt:</p>

<pre style="background='silver';">
Const cstCdoMailFormatMime = 1
Const cstCdoMailFormatText = 0

Const cstCdoBodyFormatHTML = 0
Const cstCdoBodyFormatText  = 1

strBetreff = "Textnachricht"
strNachricht = "Dies ist eine Textnachricht," & VbCrLf
strNachricht = strNachricht & "generiert vom NewMail Objekt."
strEmpaenger = "christiank@aspexpert.com"
strAbsender = "office@aspheute.com"

' Email abschicken:
Set objNewMail = CreateObject("CDONTS.NewMail")
objNewMail.MailFormat = cstCdoMailFormatText
objNewMail.BodyFormat = cstCdoBodyFormatText
objNewMail.From = strAbsender
objNewMail.To = strEmpaenger
objNewMail.Subject = strBetreff
objNewMail.Body = strNachricht
objNewMail.Send
Set objNewMail = Nothing</pre>

<p>Nachdem die Email mit der Methode <i>Send</i> abgeschickt wurde, liegt
die Email in der Queue des SMTP Servers und wird sobald als m&ouml;glich abgeschickt.
Diese Vorgangsweise begr&uuml;ndet eine sehr hohe Performance f&uuml;r die ASP-Seite, 
da die Email einfach nur an den SMTP Server &uuml;bergeben wird und die ASP-Seite
somit nicht warten muss, bis die Email tats&auml;chlich gesendet wurde.</p>

<p>Aus diesem Grund ist CDO auch die bevorzugte Methode um Emails in 
Newsletter-, Listserver- oder anderen Massenmail-Applikationen zu versenden.</p>

<p>Das <i>CDONTS.NewMail</i> Objekt ist bereits f&uuml;r schnellstes Erstellen und Versenden
von Emails konzipiert. Daher stellt es auch keines der sonst &uuml;blichen CDO Interfaces
zur Verf&uuml;gung. Weiters kann ein einmal erstelltes Objekt nur zum Versenden einer
Email verwendet werden. Es ist notwendig, f&uuml;r jede Email ein eigenes Objekt
(mittels <i>CreateObject</i>) zu erstellen, und nach Versenden der Email die Resourcen des
Objektes wieder freizugeben (<i>Set objNewMail = Nothing</i>).</p>

<p>Die Verwendung des <i>CDONTS.NewMail</i> Objektes aus Performance-Gr&uuml;nden
einer ASP-Komponente (wie ASPMail) vorzuziehen. Um das Objekt einzusetzen
muss jedoch am IIS der SMTP Server laufen. Ein weiterer Grund, der gegen
die Verwendung des <i>NewMail</i> Objektes sprechen k&ouml;nnte, ist der
f&uuml;r spezielle Anwendungen eingeschr&auml;nkte Funktionsumfang. Ausserdem
kann CDONTS nur unter IIS (Windows NT/2000) aber nicht unter PWS (Windows 9x)
eingesetzt werden.</p>

<p>Welchen <u>Funktionsumfang</u> bietet nun das <i>CDONTS.NewMail</i> Objekt?</p> 

<ul>
   <li>Man kann "Plain-Text"-Nachrichten, aber auch "HTML"-Nachrichten versenden.</li>
   <li>Mehrere Empf&auml;nger, CC und BCC pro Email sind m&ouml;glich.</li>
   <li>Dateien k&ouml;nnen als Attachements an Emails angeh&auml;ngt werden.</li>
   <li>Die Dringlichkeit der Email ist einstellbar.</li>
   <li>Zus&auml;tzliche Header (wie Reply-To) k&ouml;nen &uuml;ber die Value Eigenschaft
   generiert werden.</li>
</ul>

<p>Die <b>Dringlichkeit einer Nachricht</b> stellt man &uuml;ber die
<i>Importance</i> Eigenschaft ein:</p>

<pre style="background='silver';">
Const cstCdoLow    = 0   ' Low importance  
Const cstCdoNormal = 1   ' Normal importance (default)  
Const cstCdoHigh   = 2   ' High importance  

' Hohe Dringlichkeit:
objNewMail.Importance = cstCdoHigh</pre>

<p>Ein <b>Attachment</b> kann man mit Hilfe der <i>AttachFile</i> Methode an das Mail 
anh&auml;ngen (siehe auch <i>AttachURL</i> Methode der IIS Dokumentation):</p>

<pre style="background='silver';">
' Datei an Email anf&uuml;gen:
objNewMail.AttachFile "C:\attachements\datei.txt","datei.txt"</pre>

<p>Um eine HTML-Email zu generieren verwendet man Standard HTML im
Nachrichten Body und setzt die <i>BodyFormat</i> Eigenschaft auf <i>CdoBodyFormatHTML</i>:</p>

<pre style="background='silver';">
Const cstCdoBodyFormatHTML = 0
Const cstCdoBodyFormatText  = 1
Const cstCdoLow    = 0   ' Low importance  
Const cstCdoNormal = 1   ' Normal importance (default)  
Const cstCdoHigh   = 2   ' High importance  

strBetreff = "HTML-Nachricht"
strNachricht = "Dies ist eine &lt;u&gt;Textnachricht&lt;u&gt;,&lt;br&gt;" & VbCrLf
strNachricht = strNachricht & "generiert vom &lt;i&gt;NewMail Objekt&lt;/i&gt;.&lt;br&gt;"
strEmpaenger = "christiank@aspexpert.com"
strAbsender = "office@aspheute.com"

' Email mit hoher Dringlichkeit:
Set objNewMail = CreateObject("CDONTS.NewMail")
objNewMail.BodyFormat = cstCdoBodyFormatHTML
objNewMail.Importance = cstCdoHigh
objNewMail.From = strAbsender
objNewMail.To = strEmpaenger
objNewMail.Subject = strBetreff
objNewMail.Body = strNachricht
objNewMail.Send
Set objNewMail = Nothing</pre>

<p>Wie bereits erw&auml;hnt, muss beim Gebrauch des <i>CDONTS.NewMail</i> Objektes f&uuml;r 
jedes Mail ein eigenes Objekt generiert werden. Eine Wiederverwendung des Objektes ist
nicht m&ouml;glich. Um also zwei Emails zu versenden, geht man wie folgt vor:</p>

<pre style="background='silver';">
strBetreff = "Email"
strNachricht = "Dies ist eine Email!"
strAbsender = "office@aspheute.com"

' Erste Email:
strEmpaenger = "christiank@aspexpert.com"

Set objNewMail = CreateObject("CDONTS.NewMail")
objNewMail.From = strAbsender
objNewMail.To = strEmpaenger
objNewMail.Subject = strBetreff
objNewMail.Body = strNachricht
objNewMail.Send
Set objNewMail = Nothing

' Zweite Email:
strEmpaenger = "office@aspexpert.com"

Set objNewMail = CreateObject("CDONTS.NewMail")
objNewMail.From = strAbsender
objNewMail.To = strEmpaenger
objNewMail.Subject = strBetreff
objNewMail.Body = strNachricht
objNewMail.Send
Set objNewMail = Nothing</pre>

<p>Ein Script, das ein Massenmailing aus einer Datenbank generiert, 
k&ouml;nnte also wie folgt aussehen:</p>

<pre style="background='silver';">
...
' Eine Email an alle Empf&auml;nger des Recordsets Rs schicken:
While not Rs.EOF
    Set objNewMail = CreateObject("CDONTS.NewMail")
objNewMail.From = "office@aspheute.com"
	objNewMail.To = rs("EmpfaengerEmail")
	objNewMail.Subject = "Wichtige Informationen!"
	strNachricht = "Sehr geehrter Herr" & rs("Name") & "!" & VbCrLf
	strNachricht = strNachricht & "Aktuelles aus unserem Programm ..."
	objNewMail.Body = strNachricht
	objNewMail.Send
	Set objNewMail = Nothing
	Rs.MoveNext
Wend
...</pre>

<p>Wenn man eine ASP-Applikation erstellt, bei der t&auml;glich einige hundert bis
tausend Emails geschickt werden sollen, so ist der Einsatz des <i>CDONTS.NewMail</i> 
Objektes eine &Uuml;berlegung wert.</p><h2>Verwandte Artikel</h2>
<p>
<a href="20021028.htm">ACT MetaMailer - Mails verschicken leicht gemacht</a><br>
<a href="20001009.htm">Das Versenden von Emails selbst programmieren</a><br>
<a href="20000330.htm">Downloads per Email verschicken</a><br>
<a href="20010503.htm">Eine einfache Newsletter Applikation</a><br>
<a href="19990809.htm">Email versenden mit AspMail</a><br>
<a href="20010219.htm">Emails versenden mit ASPEmail</a><br>
<a href="20010625.htm">Html Emails mit Dundas Mailer verschicken</a><br>
<a href="20000912.htm">Mit PGP verschl&uuml;sselte e-Mails senden</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20000515" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Emails senden mit CDONTS"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20000515.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Koller"><input type="hidden" name="AuthorEmail" value="christiank@aspexpert.com"><input type="hidden" name="Artikel" value="20000515"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20000515.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
