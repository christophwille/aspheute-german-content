<HTML>
<HEAD>
<TITLE>Eigenschaften der Connection und Recordset Objekte</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Welche ADO Version hat man installiert? Was kann eigentlich der Datenbanktreiber oder die Datenbank? Diese Fragen werden mit dem in diesen Artikel vorgestellten Code beantwortet.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,ADO,Connection,Recordset,Properties,IIS,ASP,Record,Field">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Eigenschaften der Connection und Recordset Objekte</H1>
<p>
Geschrieben von: <a href="../autoren/christiankoller.htm">Christian Koller</a><br>
Kategorie: <a href="../kategorien/Datenbank.htm">Datenbank</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=19990811"></SCRIPT>
</p>
<p>
Wenn Sie effizient von ASP Scripts auf Datenbanken zugreifen wollen, dann werden Sie in der 
ASP Programmierung um ADO (ActiveX Data Objects) nicht herumkommen. F&uuml;r die technisch 
Interessierten: ADO ist nichts anderes als ein Objektmodell zur einfachen Handhabung 
der OLE DB Schnittstelle (Object Linking and Embedding Databases).
</p>
<p>
Das hei&szlig;t, da&szlig; man Daten von jedem OLE DB Provider (also auch von ODBC) mittels ADO 
handhaben kann. Typische Anwendungen sind Datenaustausch mit SQL Server, Access, Oracle 
und ODBC (Open Database Connectivity) Datenquellen im Allgemeinen.
</p>
<p>
Wenn man nun wissen m&ouml;chte, welche ADO Version (1.0, 1.5, 2.0, 2.1,...) auf einem Server 
l&auml;uft und welche Eigenschaften eine Connection oder ein Recordset Objekt hat, so kann man sich 
des nachfolgenden Scripts bedienen.
</p>
<p>
Das Script erstellt ein Connection Objekt und &ouml;ffnet damit eine Verbindung zur Datenbank. 
Danach werden Informationen &uuml;ber ADO, die Datenbank und die zugeh&ouml;rigen Treiber abgefragt. 
Der letzte Teil des Scripts liefert die Eigenschaften der Connection und des Recordset zur&uuml;ck.
<pre>
&lt;%
<font face="" color="Green">' Autoren: Christian Koller und Christoph Wille
' (c) 1998, http://www.alphasierrapapa.com/
'
' Sie benoetigen eine ODBC DSN zu einer Datenbank 
' um dieses Script laufen zu lassen

' Statt Northwind hier den Namen der ODBC DSN eintragen</font>
strDSN = &quot;Northwind&quot;
<font face="" color="Green">' Statt sa den Benutzernamen zum Einloggen in die Datenbank eintragen</font>
strUser = &quot;sa&quot;			
<font face="" color="Green">' Hier das Passwort zum Einloggen in die Datenbank eintragen</font>
strPwd = &quot;&quot;

<font face="" color="Green">' ### Erstellen eines Connection Objektes (Datenbankverbindung)</font>
Set conn = Server.CreateObject(&quot;ADODB.Connection&quot;)

<font face="" color="Green">' strDSN: Enthaelt den Namen der ODBC Verbindung zur Datenbank
' strUser: Username zum Einloggen in die Datenbank
' strPwd: Passwort zum Einloggen in die Datenbank
' ### Oeffnen der Datenbankverbindung</font>
conn.open strDSN,strUser,strPwd

Dim arrI(7), arrP(7)
arrI(0) = &quot;DBMS Name: &quot; : arrP(0) = &quot;DBMS Name&quot;
arrI(1) = &quot;DBMS Version: &quot; : arrP(1) = &quot;DBMS Version&quot;
arrI(2) = &quot;OLE DB Version: &quot; : arrP(2) = &quot;OLE DB Version&quot;
arrI(3) = &quot;Provider Name: &quot; : arrP(3) = &quot;Provider Name&quot;
arrI(4) = &quot;Provider Version: &quot; : arrP(4) = &quot;Provider Version&quot;
arrI(5) = &quot;Driver Name: &quot; : arrP(5) = &quot;Driver Name&quot;
arrI(6) = &quot;Driver Version: &quot; : arrP(6) = &quot;Driver Version&quot;
arrI(7) = &quot;Driver ODBC Version: &quot; : arrP(7) = &quot;Driver ODBC Version&quot;
strInfo =  &quot;ADO Version: &quot; &amp; conn.Version &amp; &quot;&lt;BR&gt;&quot; &amp; vbcrlf
For intI = 0 to UBound(arrI)
	strInfo = strInfo &amp; arrI(intI) 
	strInfo = strInfo &amp; conn.Properties(arrP(intI))
	strInfo = strInfo &amp; &quot;&lt;BR&gt;&quot; &amp; vbcrlf 	
Next

Response.Write &quot;&lt;B&gt;ADO Versions Information&lt;/B&gt;:&lt;BR&gt;&quot;
Response.Write strInfo
Response.Write &quot;&lt;BR&gt;&quot;

Response.Write &quot;&lt;B&gt;Eigenschaften des Connection Objektes&lt;/B&gt;:&lt;BR&gt;&quot;

<font face="" color="Green">' ### Abfragen aller Eigenschaften der Datenbankverbindung</font>
For Each connprop In conn.properties
	Response.Write connprop.name &amp; &quot;: &lt;I&gt;&quot; &amp; connprop &amp;  _
		&quot;&lt;/I&gt;&lt;BR&gt;&quot; &amp; vbCRLF
Next

Response.Write &quot;&lt;BR&gt;&quot;
Response.Write &quot;&lt;B&gt;Eigenschaften des Recorset Objektes&lt;/B&gt;:&lt;BR&gt;&quot;

<font face="" color="Green">' ### Erstellen eines Recordset Objektes</font>
Set rsQuery = Server.CreateObject(&quot;ADODB.RecordSet&quot;)
strQuery = &quot;SELECT 0&quot;	

<font face="" color="Green">' ### Durchfuehren der Datenbankabfrage und Speichern 
' des Ergebnisses in der Objektvariablen rsQuery (Recordset)</font>
rsQuery.Open strQuery, conn

<font face="" color="Green">' ### Abfragen aller Eigenschaften des Recordset Objektes</font>
For Each rsprop In rsQuery.properties
	Response.Write rsprop.name &amp; &quot;: &lt;I&gt;&quot; &amp; rsprop &amp;  _
		&quot;&lt;/I&gt;&lt;BR&gt;&quot; &amp; vbCRLF
Next

<font face="" color="Green">' ### Schliessen der Objekte</font>
rsQuery.close
conn.close
%&gt;
</pre>
</p>
<p>
Die wichtigsten Informationen sind sicherlich die ADO Version und die Treiber Informationen.
Nicht unwesentlich sind auch die Eigenschaften des Recordset Objektes, die von Datenbank zu 
Datenbank unterschiedlich sind, so kann man zum Beispiel bei einer Access Datenbank 
keine Bookmarks setzen. 
</p><h2>Verwandte Artikel</h2>
<p>
<a href="20000518.htm">ADO Konstanten und die Datei Adovbs.inc</a><br>
<a href="20001023.htm">Das SQL Join Statement</a><br>
<a href="20001201.htm">Die SQL ORDER BY Clause</a><br>
<a href="20001107.htm">Einf&uuml;gen eines Datensatzes mit dem INSERT Statement</a><br>
<a href="20000606.htm">Zugriff auf autom. generierte ID beim Einf&uuml;gen eines Datensatzes</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="19990811" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Eigenschaften der Connection und Recordset Objekte"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/19990811.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Koller"><input type="hidden" name="AuthorEmail" value="christiank@aspexpert.com"><input type="hidden" name="Artikel" value="19990811"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/19990811.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
