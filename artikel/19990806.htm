<HTML>
<HEAD>
<TITLE>Das Dictionary Objekt - Dein Feind und Helfer</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Das Dictionary Objekt ist sehr m&auml;chtig - allerdings bietet es auch einige M&ouml;glichkeiten, Fehler zu machen. Dieser Artikel beleuchtet das Verh&auml;ltnis zu ADO.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Dictionary,Recordset,IIS,ASP,ADO,VBScript,Scripting">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Das Dictionary Objekt - Dein Feind und Helfer</H1>
<p>
Geschrieben von: <a href="../autoren/christophwille.htm">Christoph Wille</a><br>
Kategorie: <a href="../kategorien/ASP%20Tricks.htm">ASP Tricks</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=19990806"></SCRIPT>
</p>
<p>
Eine Komponente, die ein Schattendasein fristet (beziehungsweise gefristet hat) ist das <b>Dictionary</b> Objekt. Dabei kann
es sehr n&uuml;tzlich sein. Wer PERL kennt, kennt die assoziativen Arrays - genau das ist ein Dictionary. F&uuml;r die, die PERL
nicht kennen und sich unter einem assoziativen Array nichts vorstellen k&ouml;nnen, hier die Kurzfassung: ein Schl&uuml;sselwert
wird verwendet um einen zugewiesenen Wert aufzufinden (zB: eine nette Assoziation ist Flensburg und Polizei).
</p>
<p>
Also gleich mal zu einem Beispiel zum leichteren Verst&auml;ndnis:
<pre>
Set myDictionary = CreateObject("Scripting.Dictionary")
myDictionary.Add "Flensburg", "Polizei"
myDictionary.Add "Kuba", "Zigarren"
</pre>
Damit erstelle ich die Assoziation, die ich dann verwenden kann, um das Teil wieder aufzusuchen:
<pre>
Response.Write myDictionary.Item("Flensburg")
</pre>
Das Resultat ist wie nicht anders zu erwarten - "Polizei". Vern&uuml;nftigere Anwendungen w&auml;ren Benutzername zu Pa&szlig;wort Zuweisungen
oder das Auslesen von Daten aus Tabellen (Prim&auml;rschl&uuml;ssel zugewiesen auf zB Nachname).
</p>
<p>
Damit sind wir auch schon beim Thema, das Verwenden von Dictionaries zusammen mit Recordsets. Da gibt es n&auml;mlich eine 
unheilige Allianz, die ich anhand des folgenden Beispiels erkl&auml;ren werde (ich verwende die <b>pubs</b> Datenbank eines SQL 7
Servers names TOPGUN):
<pre>
&lt;% 
Dim oConn, oRS, dicAuthors
Set oConn = CreateObject(&quot;ADODB.Connection&quot;)
oConn.ConnectionString = &quot;provider=sqloledb.1;user id=sa;&quot; & _
		&quot;password=;initial catalog=pubs;data source=TOPGUN&quot;
oConn.Open

Set oRS = CreateObject(&quot;ADODB.Recordset&quot;)
oRS.ActiveConnection = oConn
oRS.Open &quot;SELECT au_id, au_lname FROM authors&quot;

Set dicAuthors = CreateObject(&quot;Scripting.Dictionary&quot;)
while not oRS.EOF
	dicAuthors.Add oRS(0), oRS(1)
	oRS.MoveNext
wend

oRS.Close
oConn.Close

Dim myKeys, myValues, i
myKeys = dicAuthors.Keys
myValues = dicAuthors.Items
For i = 0 To (dicAuthors.Count -1)
	Response.Write myKeys(i) &amp; &quot; &quot; &amp; myValues(i)
Next
%&gt;
</pre>
Eigentlich nichts besonders - au&szlig;er da&szlig; ich statt &uuml;ber ODBC direkt &uuml;ber den OLE-DB Treiber auf den
SQL Server zugreife (bringt Geschwindigkeit, weil der ODBC Layer ausgeschaltet wird).
</p>
<p>
Der eigentliche Haken an der Geschichte ist die while-Schleife:
<pre>
while not oRS.EOF
	dicAuthors.Add oRS(0), oRS(1)
	oRS.MoveNext
wend
</pre>
Wenn ich das so laufen lasse, dann bekomme ich folgende Fehlermeldung:
<pre>
Microsoft VBScript runtime error '800a01c9' 
This key is already associated with an element of this collection 
/ASPGERMAN/dictionary2recordset.asp, line 21 
</pre>
Analyse: Der Fehler tritt bei der zweiten Datensatzzeile auf; der Prim&auml;rschl&uuml;ssel <i>au_id</i> ist aber eindeutig - was also ist da
passiert? Der Grund liegt im Dictionary selbst - ich kann Objekte zuweisen, und zwar auf den Schl&uuml;ssel und den Wert (da wird die Adresse und nicht der Wert des Objekts gespeichert). Da ADO
aber f&uuml;r <i>oRS.Fields(0)</i> immer das gleiche <i>Field</i> Objekt liefert, ist dessen Adresse im Speicher immer die gleiche - 
und somit ist beim 2ten Durchlauf der Fehler vorprogrammiert. Der Fehler l&auml;&szlig;t sich aber leicht beheben:
<pre>
	dicAuthors.Add CStr(oRS(0)), oRS(1)
</pre>
</p>
<p>
Damit weise ich den Wert des Objekts (ein String) statt der Adresse des Objekts zu. Wenn ich das Skript jetzt laufen lasse,
wird der Fehler allerdings noch um einiges lustiger, und zwar tritt er in der 2ten Zeile des folgenden Codes auf:
<pre>
For i = 0 To (dicAuthors.Count -1)
	Response.Write myKeys(i) & " " & myValues(i)
Next
</pre>
Und die Fehlermeldung schulde ich Euch noch:
<pre>
error '80020009' 
Exception occurred. 
/ASPGERMAN/dictionary2recordset.asp, line 32 
</pre>
Ich hoffe, einige haben das mit der Objektadresse aufmerksam gelesen - ich habe gesagt, Schl&uuml;ssel und Wert k&ouml;nnen ein Objekt aufnehmen,
und genau das mache ich immer noch - der Wert ist <i>oRS.Fields(1)</i>, mit dem Haken, da&szlig; ich das Recordset schon geschlossen habe.
Damit ist das <i>Field</i> Objekt schon gel&ouml;scht, und wenn ich zugreife, bekomme ich die Zugriffsverletzung. Auch dieser Fehler
l&auml;&szlig;t sich mit der bekannten Methode beseitigen:
<pre>
	dicAuthors.Add CStr(oRS(0)), CStr(oRS(1))
</pre>
</p>
<p>
Was w&auml;re passiert, wenn das Recordset noch nicht geschlossen gewesen w&auml;re? Ich h&auml;tte einen einzigen Wert bekommen, und zwar
den, der in der letzten Zeile gestanden ist. Selbstversuch!
</p>
<p>
Die Moral von der Geschichte? Dictionaries sind ein m&auml;chtiges Werkzeug - sie nehmen alles auf (inklusive Objekten), wie man
dann an die Daten wieder herankommt sollte man sich aber bereits vorher &uuml;berlegt haben. Die Fehler k&ouml;nnen gemein schwer
zu finden sein!
</p><h2>Verwandte Artikel</h2>
<p>
<a href="20000602.htm">Allgemeine MailParser-Klasse mit ASPMail</a><br>
<a href="20000926.htm">Collections einmal anders: Stacks und Queues</a><br>
<a href="20010323.htm">Die LookUpTable Komponente</a><br>
<a href="20020430.htm">Gro&szlig;e Datenmengen in Formularfeldern erfolgreich auslesen</a><br>
<a href="20020408.htm">Klassenauflistungen mit dem Dictionary-Objekt</a><br>
<a href="20010803.htm">Meta Tags von fremden Seiten parsen</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="19990806" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Das Dictionary Objekt - Dein Feind und Helfer"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/19990806.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christoph Wille"><input type="hidden" name="AuthorEmail" value="christophw@alphasierrapapa.com"><input type="hidden" name="Artikel" value="19990806"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/19990806.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
