<HTML>
<HEAD>
<TITLE>Kopieren verboten - Lizenzsicherung bei ASP Scripts</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Textdateien im allgemeinen und ASP Skripte im speziellen lassen sich nicht wie konventionelle Software sichern. Dieser Artikel soll einen Weg aufzeigen, wie man, wenn auch nicht das eigentliche Kopieren verhindern, so doch...">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Kopierschutz,Lizenzsicherung,Seriennummer,Verschlüsselung,Skript,Software">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Kopieren verboten - Lizenzsicherung bei ASP Scripts</H1>
<p>
Geschrieben von: <a href="../autoren/claudiusceteras.htm">Claudius Ceteras</a><br>
Kategorie: <a href="../kategorien/ASP%20Tricks.htm">ASP Tricks</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20020411"></SCRIPT>
</p>
<p>
Textdateien im allgemeinen und ASP Skripte im speziellen lassen sich nicht wie konventionelle Software sichern. Dieser 
Artikel soll einen Weg aufzeigen, wie man, wenn auch nicht das eigentliche Kopieren verhindern, so doch Lizenzverst&ouml;&szlig;e 
nachvollziehen kann.
</p>
<p>
Die Beispiels-Anwendung, die f&uuml;r diesen Artikel  implementiert wurde, nutzt <a href="http://www.infomentum.com/activefile/" target="_blank">ActiveFile</a> von 
<a href="http://www.infomentum.com/" target="_blank">Infomentum</a> um ZIP-Archive zu erzeugen, sowie f&uuml;r den Datei-Download. 
Die Installation sowie grunds&auml;tzliche Verwendung dieser Komponente ist aber nicht prim&auml;res Thema dieses Artikels und kann im 
Artikel <a href="20001005.htm">Zippen und entzippen von Dateien</a> nachgelesen werden.
</p>

<h2>Problemstellung</h2>
<p>
Eine beliebte M&ouml;glichkeit ASP Skripts zu sch&uuml;tzen ist es, diese in COM Komponenten zu kapseln, wobei man dann die M&ouml;glichkeit
hat Funktionalit&auml;ten z.B. erst durch Eingabe eines Lizenzcodes freizuschalten. Diese Lizenzcodes sind meist aus dem Namen 
des K&auml;ufers berechnet und nur damit verwendbar, was effektiv das Weitergeben der Software inklusive Freischaltcode 
verhindert - jedenfalls solange der Berechnungs-Algorithmus nicht geknackt wird. Solche M&ouml;glichkeiten hat man mit Skripten 
nicht, denn jeglicher Schutzmechanismus w&auml;re ohne Probleme aus dem unkompilierten Code zu entfernen.
</p>
<p>
Warum dann &uuml;berhaupt ASP-Funktionalit&auml;t in Form von Skript anbieten und nicht immer als Komponente? Ein m&ouml;glicher Grund ist 
z.B. die gr&ouml;&szlig;ere K&auml;ufergruppe, die man mit Skripten erreicht, denn nicht jeder hat die M&ouml;glichkeit Komponenten auf den 
verwendeten Servern zu registrieren.
</p>
<p>
Also, wie sch&uuml;tze ich dann meine Software, die ich in Form von Skripten verkaufen m&ouml;chte?
</p>

<h2>L&ouml;sungsansatz</h2>
<p>
Die verkaufte Kopie einer Software mu&szlig; wiedererkennbar werden. Dazu wird eine Seriennummer in die ASP Skripte eingebaut. 
Diese Seriennummer sollte folgende Eigenschaften haben:
</p>

<ol>
	<li>Von au&szlig;en - also als Surfer - lesbar sein, damit man leicht Lizenzverst&ouml;&szlig;e nachweisen kann.
	<li>Eindeutig und nicht zu erraten sein, damit nicht beim Weitergeben die Nummer eines anderen Kunden eingetragen 
		werden kann.
	<li>Nicht als Seriennummer erkennbar sein, damit sie nicht entfernt wird.
</ol>

<p>
Die erste Eigenschaft ist dadurch zu erreichen, da&szlig; man die Nummer nicht als VBS-Kommentar innerhalb des ASP-Codes, sondern 
z.B. als HTML-Kommentar, als Kommentar in clientseitigem Skript-Code oder in CSS-Dateien eintr&auml;gt.
</p>
<p>
Die zweite Eigenschaft erreicht man dadurch, da&szlig; die Seriennummer lang genug ist und auf keinen Fall fortlaufend sein darf. Man 
sollte hier also eher zB eine GUID w&auml;hlen.
</p>
<p>
F&uuml;r die letzte Eigenschaft mu&szlig; man die Seriennummer verstecken und tarnen. Dazu kann man die Seriennummer auch 
auseinanderschneiden und auf mehrere Stellen innerhalb einer Datei oder sogar auf mehrere Dateien verteilen. 
Tarnm&ouml;glichkeiten gibt es viele, z.B. als Versionsnummer:
</p>

<pre style="background='silver';">
&lt;!-- My ASP Application - Version 2.73.1254 --&gt;
</pre>

<p>
Oder als Farben in ungenutzten Klassen innerhalb von CSS-Dateien:
</p>

<pre style="background='silver';">
td.data1 { color: #12aabb; background-color: #3a5cd8}
</pre>

<p>
Nat&uuml;rlich gibt es hier noch viel mehr M&ouml;glichkeiten, und man kann sich selbst ein geeignetes Versteck f&uuml;r die 
Seriennummer ausdenken.
</p>

<h2>Implementierung</h2>
<p>
Basierend auf obiger Spezifikation soll ein Prototyp eines Systems entstehen, mit dem man registrierten Kunden per 
Seriennummer personalisierte Software-Pakete zum Download anbieten kann. F&uuml;r das on-the-fly zippen und den Download wird 
<a href="http://www.infomentum.com/activefile/" target="_blank">ActiveFile</a> von <a href="http://www.infomentum.com/" target="_blank">Infomentum</a> 
verwendet, wobei man nat&uuml;rlich beliebig andere ZIP- bzw. Download-Komponenten nutzen kann. Die Seriennummer-Funktionalit&auml;t 
wird in einer VBS-Klasse gekapselt, um sie auch au&szlig;erhalb dieses Prototyps wiederverwenden zu k&ouml;nnen.
</p>

<h2>SoftwarePackagePersonalizer</h2>
<p>
Die zu erzeugende Klasse soll aus einem Quell-Verzeichnis einige Dateien (CopyFiles-Array) nur in ein Ziel-Verzeichnis 
kopieren und andere (ParseFiles-Array) Dateien beim Kopieren nach bestimmte Formulierungen suchen und diese durch 
Seriennummern ersetzen. Dies f&uuml;hrt zu folgendem Klassen-Design:
</p>

<pre style="background='silver';">
class SoftwarePackagePersonalizer
    property let/get SourceDirectory
    property let/get DestinationDirectory
    property let/get CopyFiles
    property let/get ParseFiles
    function Go()
end class
</pre>

<p>
Die Function Go() f&uuml;hrt den Kopierprozess durch und gibt dann die komplette Seriennummer zur&uuml;ck. Beim Parsen der Dateien 
soll nach folgendenden Formulierungen gesucht werden, welche dann durch Seriennummernfragmenten ersetzt werden:
</p>

<pre style="background='silver';">
@@number:type:length@@
</pre>

<p>
<b>number</b> gibt die Position des Seriennummernfragments innerhalb der Seriennummer an, <b>type</b> bestimmt den Typ des zu 
erzeugenden Fragments, wobei hier folgende Typen implementiert sind:
</p>

<table border=1>
<tr>
	<th>Typ</th>
	<th>Bedeutung</th>
</tr>
<tr>
	<td>n</td>
	<td>Numerisch: Dieser Typ erzeugt Fragmente aus den Zeichen 0-9</td>
</tr>
<tr>
	<td>a</td>
	<td>Alpha: Dieser Typ erzeugt Fragmente aus den Zeichen a-z</td>
</tr>
<tr>
	<td>an</td>
	<td>Alphanumerisch: Dieser Typ erzeugt Fragmente aus den Zeichen 0-9 und a-z</td>
</tr>
<tr>
	<td>h</td>
	<td>Hex: Dieser Typ erzeugt Fragmente aus den Zeichen 0-9 und a-f</td>
</tr>
</table>

<p>
Auch andere Typen sind denkbar, z.B. welche, die ein Zufallsdatum erzeugen etc.
<b>length</b> letztendlich  bestimmt die L&auml;nge des zu erzeugenden Fragments.
</p>
<p>
Zum leichteren Verst&auml;ndnis hier einige Beispiele:
</p>

<table border=1>
<tr>
	<th>Code</th>
	<th>Erzeugtes Beispiels-Fragment</th>
	<th>Beschreibung</th>
</tr>
<tr>
	<td>@@1:h:6@@</td>
	<td>12a4f6</td>
	<td>Gut um Seriennummern als Farbe in CSS-Dateien zu tarnen</td>
</tr>
<tr>
	<td>@@2:n:4@@</td>
	<td>3968</td>
	<td>M&ouml;glicher Einsatz: Erzeugung von Versionsnummern</td>
</tr>
</table>

<p>
Vorgenanntes Beispiel w&uuml;rde dann zur Seriennummer 12a4f63968; die Seriennummerfragmente werden also in der richtigen 
Reihenfolge zur Seriennummer zusammengesetzt.
</p>
<p>
Wie sieht das ganze als Code aus?
</p>
<p>
Alles au&szlig;er der Go-Funkion ist trivial. Das einzig bemerkenswerte ist, dass darauf geachtet wird, da&szlig; der Verzeichnispfad 
mit einem "\" abschlie&szlig;t.
</p>

<pre style="background='silver';">
&lt;%
class SoftwarePackagePersonalizer
    private m_SrcDir
    private m_DestDir
    private m_CopyFiles
    private m_ParseFiles

    private sub Class_Initialize()
      m_CopyFiles = Array()
      m_ParseFiles = Array()
    end sub

    property let SourceDirectory(value)
      m_SrcDir = value
      if right(m_SrcDir,1)&lt;&gt;"\" then
        m_SrcDir = m_SrcDir &amp; "\"
      end if 
    end property
    
    property get SourceDirectory
      SourceDirectory = m_SrcDir
    end property

    property let DestinationDirectory(value)
      m_DestDir = value
      if right(m_DestDir,1)&lt;&gt;"\" then
        m_DestDir = m_DestDir &amp; "\"
      end if 
    end property

    property get DestinationDirectory
      DestinationDirectory = m_DestDir
    end property

    property let CopyFiles(value)
      m_CopyFiles = value
    end property
    
    property get CopyFiles
      CopyFiles = m_CopyFiles
    end property

    property let ParseFiles(value)
      m_ParseFiles = value
    end property
    
    property get ParseFiles
      ParseFiles = m_ParseFiles
    end property

    function Go()
      dim fso, stream, txt, regEx, matches, match
      dim num, typ, leng, randStr, serials, dummy
      dim i, j, result, filename
    
      dim forReading : forReading = 1
      dim forWriting : forWriting = 2

      Set fso = Server.CreateObject("Scripting.FileSystemObject")
</pre>

<p>
Nach dem Erstellen des FileSystemObjects werden zuerst die Dateien kopiert, die nicht ver&auml;ndert werden m&uuml;ssen:
</p>

<pre style="background='silver';">
      ' 1 Copy Files
      for each filename in m_CopyFiles
        fso.CopyFile m_SrcDir &amp; filename, m_DestDir, true
      next
</pre>

<p>
Danach werden die zu parsenden Dateien einzeln eingelesen und nach dem erw&auml;hnten Muster durchsucht:
</p>

<pre style="background='silver';">
      ' 2 Parse Files
      for each filename in m_ParseFiles
          ' 2.1 read file content
          Set stream = fso.OpenTextFile(m_SrcDir &amp; filename,forReading)
          txt = stream.readAll()
          stream.close
          ' 2.2 search for @@number:type:length@@ 
          Set regEx = new RegExp
          regEx.Global = true
          regEx.Pattern = "@@([^:]*):([^:]*):([^@]*)@@"
          Set matches = regEx.Execute(txt)
</pre>

<p>
Die gefundenen Muster werden in ihre Bestandteile zerlegt und an die Funktion <i>RandomString</i> &uuml;bergeben, die wir sp&auml;ter noch 
sehen werden (diese kann uns die verschiedenen Typen der Seriennummernfragmente erzeugen). Das erzeugte Fragment wird 
an die Stelle des gefundenen Musters im eingelesenen Text gesetzt und zus&auml;tzlich zusammen mit der Position in der 
Seriennummer in der Variable <i>serials</i> gespeichert. Damit k&ouml;nnen wir sp&auml;ter daraus die Seriennummer zusammensetzen. 
</p>
<p>
Zum Speichern der Seriennummerfragmente wird ein CSV-Format benutzt.
</p>

<pre style="background='silver';">
          for each match in matches
            num = CInt(match.subMatches(0))
            typ = match.subMatches(1)
            leng = CInt(match.subMatches(2))
            randStr = randomString(typ,leng)
            ' 2.3 replace token with random String
            txt = replace(txt,match.Value,randStr)
            serials = serials &amp; vbCr &amp; num &amp; vbTab &amp; randStr
          next
</pre>

<p>
Jetzt kann man den ge&auml;nderten Dateininhalt in die Zieldatei schreiben und das gesamte Software-Paket ist personalisiert.
</p>

<pre style="background='silver';">
          Set stream = fso.OpenTextFile(m_DestDir &amp; filename,forWriting,true)
          ' 2.4 ... and write the altered content into the created file
          stream.write txt
          stream.close
      next
      Set fso = Nothing
</pre>

<p>
Das einzige, was jetzt noch zu tun bleibt, ist die Seriennummern aus den Fragmenten zusammenzusetzen und zur&uuml;ckzugeben. 
Hierzu wird das CSV-Format in einem Array von Arrays expandiert, die einzelnen Fragmente mit einem Bubble-Sort-Derivat 
nach der Position sortiert und schlie&szlig;lich zur fertigen Seriennummer zusammengef&uuml;gt.
</p>

<pre style="background='silver';">
      ' 3 return serial
      serials = mid(serials,2) ' delete first vbCr
      ' 3.1 unpack serial parts
      serials = split(serials, vbCr)
      for i = 0 to ubound(serials)
         serials(i) = split(serials(i), vbTab)
      next
      ' 3.2 bubble-sort serial parts
      for i = 0 to ubound(serials)-1
         for j = ubound(serials) to i+1 step -1
            if serials(i)(0)&gt;serials(j)(0) then
               dummy = serials(j)
               serials(j) = serials(i)
               serials(i) = dummy
            end if
         next
      next
      ' 3.3 compile serial
      result = ""
      for i = 0 to ubound(serials)
         result = result &amp; serials(i)(1)
      next
      Go = result
    end function
</pre>

<h2>Anwendungsbeispiel</h2>
<p>
Die eben erstellte Klasse soll eingesetzt werden um personalisierte gezippte Software-Pakete anzubieten. In diesem Fall 
ist es eine Beispiels-ASP-Applikation, die zwei Zahlen addieren kann.
</p>
<p>
Als erstes brauchen wir ein Registrierungs-Formular. Zur Demonstration reicht die einfache Abfrage nach Namen und 
Email-Adresse. Auch verzichten wir hier auf besondere &Uuml;berpr&uuml;fungen der Eingaben - Hilfe hierzu bekommt man unter anderem im 
Artikel <a href="20000522.htm">&Uuml;berpr&uuml;fen von HTML-Formularen mit ASP</a> und den weiteren Links dazu.
</p>

<pre style="background='silver';">
&lt;html&gt;
&lt;body&gt;
  Zum Download des SuperDuper-ASP-Addierers musst Du Dich hier registrieren:
  &lt;form action="download.asp" method="post"&gt;
    name: &lt;input name="name"&gt;&lt;br&gt;
    email: &lt;input name="email"&gt;&lt;br&gt;
    &lt;input type="submit" value="abschicken"&gt;
  &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>

<IMG SRC="Bilder/200204/20020411_1.png" width="309" height="274" alt="" border="0">

<p>
In download.asp wird zuerst ein tempor&auml;res Verzeichnis erstellt, damit sich die einzelnen Downloads des Pakets nicht 
gegenseitig st&ouml;ren:
</p>

<pre style="background='silver';">
&lt;%option explicit%&gt;
&lt;!--#include file="SoftwarePackagePersonalizer.asp" --&gt;
&lt;%
  dim fso, tmp, serial
  Set fso = CreateObject("Scripting.FileSystemObject")
  ' generate temp folder...
  tmp = Server.MapPath(fso.GetTempName)
  fso.CreateFolder tmp
</pre>

<p>
Dann wird die erstellte Klasse benutzt, um das personalisierte Paket in diesem Verzeichnis zu erstellen. Das Paket besteht 
aus der Datei readme.txt, die nur kopiert wird und default.asp und style.css, die insgesamt drei Seriennummernfragmente 
enthalten (vollst&auml;ndiger Code im heutigen Download enthalten).
</p>

<pre style="background='silver';">
  ' ... and create the software package there.
  dim spp
  Set spp = new SoftwarePackagePersonalizer
  spp.SourceDirectory = Server.MapPath("calculator-package")
  spp.DestinationDirectory = tmp
  spp.CopyFiles = Array("readme.txt")
  spp.ParseFiles = Array("default.asp","style.css")
  serial = spp.Go()
</pre>

<p>
Nun wird noch alles mit den ActiveFile-Komponenten gezippt und zum Client geschickt:
</p>

<pre style="background='silver';">
  ' now put everything in a zipfile, ...
  dim Archive
  Set Archive = Server.CreateObject("ActiveFile.Archive")
  Archive.NewArchive tmp &amp; "\calculator.zip"
  Archive.Add tmp &amp; "\*.*"
  Archive.SaveArchive
  Set Archive = Nothing

  ' ... download the ZIP archive ...
  dim File
  Set File = Server.CreateObject("ActiveFile.File")
  File.Name = tmp &amp; "\calculator.zip"
  Response.Clear
  Response.AddHeader "Content-Disposition", "inline; filename=calculator.zip"
  File.Download "application/x-zip-compressed", Now()
  Set File = Nothing
</pre>

<p>
Zum Schlu&szlig; l&ouml;scht man nur noch das tempor&auml;re Verzeichnis mit allen Dateien darin und merkt sich die erstellte Seriennummer 
zusammen mit den Registrierungsdaten. In diesem Beispiel speichern wir alles der Einfachheit halber nur in einer Textdatei. 
Im Produktions-Einsatz nimmt man hierzu nat&uuml;rlich eine Datenbank.
</p>

<pre style="background='silver';">
  ' and delete everything. (comment this to see the temp folder and its content)
  fso.DeleteFolder tmp, true
    
  ' write serial and name to a log-file.
  ' this would be a database on a production site of course...
  const ForAppending = 8
  dim stream
  Set stream = fso.OpenTextFile(Server.MapPath(".") &amp; _
    "\log.txt", ForAppending, true)
  stream.writeLine "----------------------------"
  stream.writeLine "Name: " &amp; Request("name") &amp; _
    " (" &amp; Request("email") &amp; ")"
  stream.writeLine "Serial: " &amp; serial
  stream.close
  Set stream = Nothing
    
  Set fso = Nothing
%&gt;
</pre>

<IMG SRC="Bilder/200204/20020411_2.png" width="311" height="127" alt="" border="0">

<p>
Entdeckt man nun irgendwo seine Software, braucht man sich nur noch aus den entsprechenden Dateien die Seriennummerfragmente 
zusammenzusuchen, und sie dann mit den Eintr&auml;gen in der eigenen Datenbank/Logdatei zu vergleichen, um herauszufinden an wen 
das Paket lizensiert wurde. Nat&uuml;rlich kann man hierzu auch eine Web-Applikation erstellen, die einem diese Vergleichsarbeit 
abnimmt, vielleicht sogar teilweise manipulierte Seriennummern noch erkennt. Eine weitere n&uuml;tzliche Erweiterungen w&auml;re 
es bei Eingabe einer URL die Dateien mit den Seriennummerfragmenten herunterzuladen ( z.B. mit ASPTear oder XMLHTTP) und 
die Seriennummer automatisch zu extrahieren.
</p>

<h2>Schlu&szlig;bemerkung</h2>
<p>
Wir haben gesehen, wie man mit einfachen Mitteln durch Seriennummern abgesicherte Pakete zum Download anbieten kann. Eine 
Beschr&auml;nkung dieser Technologie ist es nat&uuml;rlich, da&szlig; die Seriennummer nicht funktionaler Bestandteil des Skripts ist, 
also bei Entdeckung entfernt werden k&ouml;nnte. Es kommt also darauf an, die Seriennummer gut zu verstecken.
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20020411.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20000522.htm">&Uuml;berpr&uuml;fen von HTML-Formularen mit ASP</a><br>
<a href="20000510.htm">ASP Scripts verschl&uuml;sseln</a><br>
<a href="20000526.htm">Klassen in VBScript</a><br>
<a href="20000519.htm">Laden von Dateien aus dem Web mit ASP</a><br>
<a href="20011123.htm">MS Script Encoder dekodiert</a><br>
<a href="20011113.htm">Sonderzeichen korrekt grabben mit XmlHttp</a><br>
<a href="20010328.htm">Webpage-Grabbing mit dem XML Parser</a><br>
<a href="20010910.htm">Webseiten automatisiert scrapen</a><br>
<a href="20010911.htm">Webseiten automatisiert scrapen, Teil 2</a><br>
<a href="20001005.htm">Zippen und entzippen von Dateien</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Einfomentum%2Ecom%2Factivefile%2F">Infomentum ActiveFile</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20020411" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Kopieren verboten - Lizenzsicherung bei ASP Scripts"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20020411.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Claudius Ceteras"><input type="hidden" name="AuthorEmail" value="claudius@gmx.de"><input type="hidden" name="Artikel" value="20020411"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20020411.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
