<HTML>
<HEAD>
<TITLE>XML NodeType Enumeration</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Der heutige Artikel befa&szlig;t sich mit der XMLNodeType Enumeration. Sie erfahren, was sich hinter diesem Namen verbirgt, und wie man programmatisch den Typ eines XML Nodes mittels ASP.NET auslesen kann.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,ASP.NET,XML,NodeType,Enumeration,XMLNodeType,XML Namespace">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>XML NodeType Enumeration</H1>
<p>
Geschrieben von: <a href="../autoren/christianholm.htm">Christian Holm</a><br>
Kategorie: <a href="../kategorien/ASPdotNET.htm">ASP.NET</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20010216"></SCRIPT>
</p>
<p>
Der heutige Artikel befa&szlig;t sich mit der XMLNodeType Enumeration. Sie erfahren, was sich hinter diesem Namen 
verbirgt, und wie man programmatisch den Typ eines XML Nodes mittels ASP.NET auslesen kann. 
</p>

<p>
Wie immer bei unseren ASP.NET Artikeln, ist zu beachten, da&szlig; Sie nur dann vom downloadbaren Sourcecode 
profitieren k&ouml;nnen, wenn Sie das Microsoft .NET Framework SDK auf einem Webserver installiert haben.
Der pr&auml;sentierte Sourcecode wurde mit der Version 1.0 des Microsoft .NET Framework SDK geschrieben.
</p>

<h2>XMLNodeType... - wie?</h2>

<p>
Bevor ich Ihnen die Typen, die ein Node annehmen kann, vorstelle, m&ouml;chte ich noch kurz erw&auml;hnen was ein
<i>XML Node</i> ist. Mit Node meint man allgemein einen Knoten. Nicht einen, den man beim Schuhezubinden
macht sondern eher geometrisch, wo z.B. Geraden zu einem Punkt zusammen laufen. Also bei einem W&uuml;rfel die Ecke.
</p>

<p>
&Auml;hnlich wie bei einem Drahtgittermodell in FEM ist nun ein Node ein Knotenpunkt oder Eintrag im <i>Document tree</i>, also
der XML Dokument-Struktur bzw. Dokument-Hierarchie. Dieser ist die Basisklasse f&uuml;r den Datenzugriff des
XML Document Model.
Einem Node kann man wie einer Variable einen Typ zuweisen. F&uuml;r <i>Nodes</i> g&uuml;ltige Typen sind entweder einfach
nur Datentypen, Attribute, CDATA, Kommentare, Text oder sogar Namespaces oder auch DTD 
(Document Type Definition).
</p>

<p>
Die <b>XMLNodeType</b> Enumeration kann man quasi als Container f&uuml;r alle g&uuml;ltigen Nodetypen ansehen.
Jedem Eintrag (Node) in einer XML Datei sollte man einen Typ zuweisen, um Fehler in der Darstellung zu vermeiden.
Die Komplikationen ergeben sich meist wenn man Textpassagen eingibt, die Sonderzeichen enthalten. Diese w&uuml;rden
ohne der Typdefintion <i>CDATA</i> f&auml;lschlicherweise als Teil des XML Sourcecodes interpretiert werden.
</p>

<p>
Wie kann man jetzt aber von einem vorhandenen XML Dokument den Typ der einzelnen Nodes erhalten? Dies werde
ich Ihnen anhand eines kleinen Beispiels demonstrieren. Sie werden sich jetzt sicher fragen wozu das Ganze?
Wenn ich ein XML Dokument erstelle, wei&szlig; ich sowieso welchen Typ ich verwendet habe. Aber: 
angenommen Sie wollen die Dateneingaben eines Clients in einem XML Dokument speichern, so k&ouml;nnen Sie
nach der Eingabe den vorgegebenen Nodetype mit dem was der Client eingegeben hat, vergleichen, und so
ung&uuml;ltige Eingaben vermeiden.
</p>

<p>
Die Ausgabe der Nodetypen habe ich mit Hilfe von ASP.NET realisiert. Das .NET Framework stellt innerhalb des 
XML Namespaces Methoden zur Verf&uuml;gung, die eine gro&szlig;e Hilfestellung sind. Das nun folgende Beispiel iteriert 
durch die Nodes und gibt am Browser den Namen und den Typ des Nodes als HTML formatierte Tabelle zur&uuml;ck.
</p>

<h2>Erfassung der Node Typen aus einem XML Dokument</h2>

<p>
Da hierbei das .NET Framework eine gro&szlig;e Hilfestellung ist, ist nur wenig Sourcecode zur L&ouml;sung der Aufgabenstellung
notwendig. Sehen wir uns also den ben&ouml;tigten Sourcecode schrittweise an (<b>XmlNType.aspx</b>).
</p>

<pre style="background='silver';">
String XmlFile = @"G:\LocalSites\TestRoot\ASPX\currentarticles.xml";
</pre>

<p>
Zuerst m&uuml;ssen wir nat&uuml;rlich die XML Datei bekannt geben, aus der wir die Nodetypen erfassen m&ouml;chten.
Den vollst&auml;ndigen Pfad samt Dateinamen mit Erweiterung speichern wir der Einfachheit halber in einer 
Variable namens <i>XmlFile</i>, vom Datentyp <i>String</i>.
</p>

<p>
Wenn Sie jedoch statt einem <i>lokalen</i> Pfad einen <i>URL</i> angeben wollen, so ist das auch kein Problem
(die existiert, also probieren Sie es ruhig aus!):
</p>

<pre style="background='silver';">
string XmlFile = @"http://www.aspheute.com/currentarticles.xml";
</pre>

<p>
Wir geben also einfach den vollst&auml;ndigen URL an. Als n&auml;chstes m&uuml;ssen wir ein neues
<i>XmlDocument</i> Objekt erstellen, dem wir dem Namen <b>MyXmlDoc</b> geben:
</p>

<pre style="background='silver';">
XmlDocument MyXmlDoc = new XmlDocument();
MyXmlDoc.Load(XmlFile);
</pre>

<p>
Anschlie&szlig;end laden wir die XML Datei, deren Pfad bzw. URL wir vorher in der Variable <i>XmlFile</i>
gespeichert haben.
</p>

<p>
Nun wollen wir den Namen und Node Type ausgeben. Dies habe ich mit der selbst verfa&szlig;ten Methode
<i>GetChildAttrib</i> realisiert. Um das Ergebnis leichter formatieren und lesbar zu machen, habe ich den
Output wie schon erw&auml;hnt in einer HTML Tabelle verpackt. Das Grundger&uuml;st der Tabelle umgibt 
den Call der Methode.
</p>

<pre style="background='silver';">
Response.Write("&lt;table cellpadding=\"2\" cellspacing=\"2\" border=\"1\"&gt;");
Response.Write("&lt;th&gt;Name&lt;/th&gt;&lt;th>NodeType&lt;/th&gt;");
GetChildAttrib(MyXmlDoc.DocumentElement);
Response.Write("&lt;/table&gt;");
</pre>

<p>
Sehen wir uns nun die Methode <i>GetChildAttrib</i>, welche den Namen und den Type jedes im Dokument enthaltenen 
Nodes zur&uuml;ckgibt, an:
</p>

<pre style="background='silver';">
void GetChildAttrib(XmlNode node)
{
   for (int i = 0; i &lt; node.ChildNodes.Count; i++)
   {
        Response.Write("&lt;tr&gt;&lt;td&gt;" + node.ChildNodes[i].Name + "&lt;/td&gt;");
        Response.Write("&lt;td&gt;" + node.ChildNodes[i].NodeType + "&lt;/td&gt;&lt;/tr&gt;");
        GetChildAttrib(node.ChildNodes[i]);
   }
}
</pre>

<p>
<i>GetChildAttrib</i> Methode iteriert mit einer <i>for</i>-Schleife durch die einzelnen Nodes bis
sie beim letzten angelangt ist - der letzte Node ist die Anzahl in <i>node.ChildNodes.Count</i>
und liefert den Namen und den Node Typ zur&uuml;ck.
</p>

<p>
Den Namen des Nodes erh&auml;lt man durch die <i>Name</i> Property (Eigenschaft) der <i>XMLNode</i> Members:
</p>

<pre style="background='silver';">
...
node.ChildNodes[i].Name
...
</pre>

<p>
Den Node Typ als ausgeschriebenes Wort erh&auml;lt man durch die <i>NodeType</i> Property der <i>XMLNode</i>
Members:
</p>

<pre style="background='silver';">
...
node.ChildNodes[i].NodeType
...
</pre>

<p>
So, nun ist der Sourcecode fertig. Wenn wir also die Datei <b>XmlNType.aspx</b> auf einem ASP.NET-ready Web Server
ausf&uuml;hren und in einem Browser betrachten, sieht das dann so aus:
</p>

<p>
<IMG SRC="Bilder/200102/20010216_1.png" width="290" height="427" alt="" border="0">
</p>

<p>
Die verwendete XML-Datei im Browser:
</p>

<p>
<IMG SRC="Bilder/200102/20010216_2.png" width="538" height="377" alt="" border="0">
</p>

<p>
Der Vergleich unseres ASP.NET Codes mit der farbigen Darstellung des XSLT Stylesheets von Internet Explorer
"hinkt" zwar etwas, aber: unser Code erlaubt es sehr einfach, ein XML Dokument auf korrekte Typen hin zu 
debuggen. Und wer schon einmal Probleme mit XML Dokumenten hatte, wei&szlig;, da&szlig; diese Fehlersuche manchmal zum Haareraufen
sein kann. Daher ist unsere "Type-Viewer" ein &auml;u&szlig;erst n&uuml;tzliches Tool f&uuml;r den beinahe-t&auml;glichen Gebrauch.
</p>

<h2>Schlu&szlig;bemerkung</h2>

<p>
Dieser Artikel war ein (sehr) kurzer Einblick in den XML Namespace des .NET Frameworks, mit dessen Hilfe Sie
unter anderem den Typ jedes Nodes eines XML Dokuments erhalten. Es gibt noch viel mehr zu entdecken - wir lesen
uns wieder!
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20010216.zip">Klicken Sie hier</a>, um den Download zu starten.</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Eine weitere sehr hilfreiche Resource ist das <a href="http://aspxfiles.com/">deutsche ASP.NET Wiki</a>,
das als zentrale Anlaufstelle f&uuml;r Tips, Tricks, Know How und alles N&uuml;tzliche was man in seinem Alltag als 
(ASP).NET-Entwickler so braucht und entdeckt gedacht ist. 
</p>

<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20010216" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="XML NodeType Enumeration"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20010216.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christian Holm"><input type="hidden" name="AuthorEmail" value="office@holmcs.com"><input type="hidden" name="Artikel" value="20010216"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20010216.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
