<HTML>
<HEAD>
<TITLE>Email versenden mit AspMail</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Webemailformulare sind so ziemlich das erste, das ein neuer ASP Programmierer zu bew&auml;ltigen hat. Hier gibt es Informationen wie man es richtig macht.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Email,AspMail,AspQMail,IIS,ASP,AspMail,CDO,SMTP,Formular">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Email versenden mit AspMail</H1>
<p>
Geschrieben von: <a href="../autoren/christophwille.htm">Christoph Wille</a><br>
Kategorie: <a href="../kategorien/Komponenten.htm">Komponenten</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=19990809"></SCRIPT>
</p>
<p>
Das ber&uuml;hmt-ber&uuml;chtigte "Anfrageformular" kommt auf (fast) jeder Internetsite vor, und
wird meist so gel&ouml;st, da&szlig; an die zust&auml;ndige Personen eine Email mit den vom User
eingegeben Formularwerten abgeschickt wird. Auch wir verwenden auf dieser Seite ein solches <a href="http://www.aspgerman.com/aspgerman/kontakt.asp">Formular</a>,
und ich werde heute aufdecken, was Email-technisch dahinter steckt.
</p>
<p>
Zum Aufw&auml;rmen, hier einmal der HTML-Code eines einfachen (also unserem) Anfrageformular:
<pre>
&lt;FORM ACTION=&quot;&lt;%=Request.ServerVariables(&quot;SCRIPT_NAME&quot;)%&gt;&quot; 
	METHOD=POST&gt;
&lt;INPUT TYPE=TEXT NAME=&quot;Anfragesteller&quot; VALUE=&quot;&quot; SIZE=40&gt;
&lt;INPUT TYPE=TEXT NAME=&quot;Emailadresse&quot; VALUE=&quot;&quot; SIZE=40&gt;
&lt;TEXTAREA NAME=&quot;Anfrage&quot; COLS=40 ROWS=10&gt;&lt;/TEXTAREA&gt;
&lt;INPUT TYPE=SUBMIT VALUE=&quot;Abschicken&quot;&gt;
&lt;/FORM&gt;
</pre>
Ich habe alle Formatierungen herausgenommen, drinnengeblieben ist nur das, was f&uuml;r das Funktionieren
des Formulars lebenswichtig ist. Ein ASP-Trick des t&auml;gichen Lebens ist hier auch versteckt: die ACTION des
FORMs wird dynamisch mit der SCRIPT_NAME Variable bef&uuml;llt - der Dateiname des aktuellen Formulars (oder ASP Datei).
Und das Umbenennen des Formulars wird somit nicht mehr zur Katastrophe!
</p>
<p>
Jetzt aber zu Wichtigerem; dem Code zum Abschicken einer Email. Von uns gerne verwendet wird die AspMail
Komponente von ServerObjects, da sie sehr lange am Markt, schnell und zuverl&auml;ssig ist (am Schlu&szlig;
des Artikels habe ich eine Liste von alternativen Komponenten zusammengetragen).
</p>
<p>Warum ich nicht die mit IIS mitgelieferte CDONTS (Collaboration Data Objects NT Server) 
verwende? Die funktionieren nur dann, wenn am Webserver auch ein SMTP Server installiert ist - 
und zwar der vom NT Option Pack. Nicht gerade praktikabel im t&auml;glichen Einsatz.
</p>
<p>
Der Benutzer hat also das Formular abgeschickt - hier nun der Code, der am Server abl&auml;uft.
<pre>
If Request.ServerVariables(&quot;Content_Length&quot;)&gt;0 Then
 Set Mailer = Server.CreateObject(&quot;SMTPsvg.Mailer&quot;)
 Mailer.FromName = &quot;ASPGERMAN Forum&quot;
 Mailer.FromAddress = &quot;webmaster@alphasierrapapa.com&quot;
 Mailer.RemoteHost = &quot;pop3.bitshop.com&quot;
 Mailer.Recipient = &quot;christophw@alphasierrapapa.com&quot;
 Mailer.Subject = &quot;Anfrageformular&quot;
	
 strBody = &quot;Von: &quot; &amp; Request.Form(&quot;Anfragesteller&quot;) &amp; vbCRLF
 strBody = strBody &amp; &quot;Email: &quot; &amp; Request.Form(&quot;Emailadresse&quot;) &amp; vbCRLF
 strBody = strBody &amp; &quot;Anfrage: &quot; &amp; Request.Form(&quot;Anfrage&quot;) _
   &amp; vbCRLF &amp; vbCRLF
 strBody = strBody &amp; &quot;IP: &quot; &amp; Request.ServerVariables(&quot;REMOTE_HOST&quot;) _
   &amp; vbCRLF
 Mailer.BodyText = strBody
 
 If Mailer.SendMail Then
  Response.Write &quot;Ihre Anfrage wurde erfolgreich weitergeleitet!&quot;
 Else
  Response.Write &quot;W&amp;auml;hrend der Bearbeitung Ihrer Anfrage ist&quot; &amp; _
   &quot; ein Fehler aufgetreten. Bitte wenden Sie sich an &quot; &amp; _
   &quot;webmaster@alphasierrapapa.com.&quot;
 End If
End If
</pre>
Zuallererst checke ich, ob &uuml;berhaupt Daten geschickt wurden (CONTENT_LENGTH liefert die L&auml;nge der
geposteten Daten). Danach erstelle ich das Objekt, und setze diverse Eigenschaften (Name von, Emailadresse von, SMTP Server,
Empf&auml;nger, Betreff). Nach diesen Initialisierungen mu&szlig; ich nur noch den Text der Email erstellen,
und zwar bediene ich mich hier einer lokalen Variable, die ich mit den Daten des Benutzers zusammenstelle.
Zus&auml;tzlich schicke ich mir noch die IP Adresse des Computers, von dem die Anfrage aus gepostet wurde 
(der Surfcomputer also).
</p>
<p>
Abgeschickt wird die Email mit <i>SendMail</i>, das einen Boolschen Wert ob des Erfolgs liefert. Abh&auml;ngig davon
kann man eine Erfolgsmeldung oder Informationsmeldung mit Fehlerbeschreibung ausgeben. So einfach kann das
Versenden von Emails in ASP Seiten sein!
</p>
<p>
Einen letzten Pluspunkt der AspMail Komponente m&ouml;chte ich noch erw&auml;hnen: es gibt sie in der Ausf&uuml;hrung AspQMail, einer
Mail Queuing Komponente. Das bedeutet, die Email wird nicht sofort geschickt, sondern in eine Queue gesteckt,
die bei Freiwerden von Rechnerresourcen die Emails abarbeitet und schickt (als NT Service implementiert). 
Kann ich absolut f&uuml;r Sites empfehlen, die eine hohe Last auszuhalten haben.
</p><h2>Verwandte Artikel</h2>
<p>
<a href="20021028.htm">ACT MetaMailer - Mails verschicken leicht gemacht</a><br>
<a href="20001009.htm">Das Versenden von Emails selbst programmieren</a><br>
<a href="20000515.htm">Emails senden mit CDONTS</a><br>
<a href="20010219.htm">Emails versenden mit ASPEmail</a><br>
<a href="20010625.htm">Html Emails mit Dundas Mailer verschicken</a><br>
<a href="20000912.htm">Mit PGP verschl&uuml;sselte e-Mails senden</a><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Easpin%2Ecom%2Findex%2Fdefault%2Easp%3Ftree%3Daspin%2Fcomponents%2Femail">AspIN - Liste der Emailkomponenten</a><br>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Eserverobjects%2Ecom%2Fproducts%2Ehtm%23Aspmail">AspMail</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="19990809" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Email versenden mit AspMail"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/19990809.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Christoph Wille"><input type="hidden" name="AuthorEmail" value="christophw@alphasierrapapa.com"><input type="hidden" name="Artikel" value="19990809"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/19990809.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
