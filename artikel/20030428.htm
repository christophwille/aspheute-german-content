<HTML>
<HEAD>
<TITLE>Mailadressen sch&uuml;tzen</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="7 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich geschützt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Ziel dieses Artikels ist es, eine Variante anzubieten, die es erm&ouml;glicht, Mailadressen bestm&ouml;glich vor Mi&szlig;brauch zu sch&uuml;tzen und trotzdem einen gr&ouml;&szlig;tm&ouml;glichen Komfort f&uuml;r die Besucher der Webseiten zu bieten.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,Email,Spider,Spammer,Schutz,Codierung,Verstecken,Hiding,Emailadresse,Mailadresse,JavaScript,serverseitig">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff"  BACKGROUND="../images/layout/aspheutemainbg.gif" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<MAP NAME="titlebar">
<!--<AREA SHAPE=RECT COORDS="116,46,191,61" HREF="http://www.aspaktuell.com" ALT="ASP Aktuell">-->
<!--<AREA SHAPE=RECT COORDS="192,46,255,61" HREF="http://www.aspwelt.com" ALT="ASP Welt">-->
<AREA SHAPE=RECT COORDS="256,46,432,61" HREF="http://www.aspgerman.com/aspgerman/" ALT="ASP German">
<AREA SHAPE=RECT COORDS="115,15,269,42" HREF="../default.htm" ALT="Homepage">
<AREA SHAPE=RECT COORDS="278,26,587,42" HREF="../default.htm" ALT="Homepage">
</MAP>

<div style="position:absolute;left:0px;top:30px">
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td background="../images/layout/aspheutetitle.gif">
<img src="../images/layout/blind.gif" width="715" height="73" usemap="#titlebar" border="0">
</td>
<td width="100%" background="../images/layout/aspheutetitleext.gif">
&nbsp;
</td>
<td background="../images/layout/aspheutetitleend.gif">
<img src="../images/layout/blind.gif" width="25" height="1">
</td>
</tr>
</table>
</div>

<div style="position:absolute;left:1px;top:115px">
<table width="110" border="0" cellspacing="0" cellpadding="0">
<tr><td width="110"><img src="../Images/spacer.gif" width="110" height="1" alt="" border="0"></td></tr>
<tr>
<td background="../images/layout/aspheuteheader.gif" class="header" height=16 width="110">
<p>Liste</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">

<p class="content">
<a href="../kategorien/dotNET%202dot0.htm">.NET 2.0 (1)</a><br>
<a href="../kategorien/dotNET%20Allgemein.htm">.NET Allgemein (16)</a><br>
<a href="../kategorien/dotNET%20Fu.htm">.NET Fu (5)</a><br>
<a href="../kategorien/ADOdotNET.htm">ADO.NET (11)</a><br>
<a href="../kategorien/Aprilscherz.htm">Aprilscherz (3)</a><br>
<a href="../kategorien/ASP%20Grundlagen.htm">ASP Grundlagen (44)</a><br>
<a href="../kategorien/ASP%20Tricks.htm">ASP Tricks (83)</a><br>
<a href="../kategorien/ASPdotNET.htm">ASP.NET (44)</a><br>
<a href="../kategorien/ASPIntranetdotde.htm">ASPIntranet.de (5)</a><br>
<a href="../kategorien/Csharp.htm">C# (28)</a><br>
<a href="../kategorien/Datenbank.htm">Datenbank (44)</a><br>
<a href="../kategorien/Dokumentation.htm">Dokumentation (4)</a><br>
<a href="../kategorien/IIS%206dot0.htm">IIS 6.0 (1)</a><br>
<a href="../kategorien/Komponenten.htm">Komponenten (29)</a><br>
<a href="../kategorien/Optimierung.htm">Optimierung (10)</a><br>
<a href="../kategorien/Server.htm">Server (21)</a><br>
<a href="../kategorien/Sicherheit.htm">Sicherheit (34)</a><br>
<a href="../kategorien/Tee%20Off.htm">Tee Off (6)</a><br>
<a href="../kategorien/VBdotNET.htm">VB.NET (6)</a><br>
<a href="../kategorien/WAP.htm">WAP (8)</a><br>
<a href="../kategorien/Web%20Services.htm">Web Services (11)</a><br>
<a href="../kategorien/XML.htm">XML (9)</a><br>


<br>
<a href="/syndication/rss.xml"><img src="../Images/rss_small.png" width="25" height="10" alt="RSS 2.0 - Die neuesten f&uuml;nf Artikel auf AspHeute.com" border="0"></a>

</p><!-- </p> remains -->


<br>

</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearch.gif" class="header" height=16 width="110">
<p>Suchen</p>
</td>
</tr>
<tr>
<td background="../images/layout/aspheutesearchext.gif" class="header" width="110">
<form class="content" ACTION="REMOVED" METHOD="GET">
<div>
<input class="Newsletter" type="text" size="10" name="CiRestriction">
<span class="spacer2"><br></span>
<span class="spacer4"><br></span>
<INPUT TYPE="HIDDEN" NAME="CiMaxRecordsPerPage" VALUE="10">
<INPUT TYPE="HIDDEN" NAME="CiSort" VALUE="rank[d]">
<INPUT TYPE="HIDDEN" NAME="HTMLQueryForm" VALUE="../default.htm">
<img src="../images/layout/blind.gif" width="41" height="1"><input type="image" src="../images/layout/aspheutesearchenter.gif" border="0" width="49" height="14"><br>
<span class="spacer4"><br></span>
</div>
</form>
</td>
</tr>
<tr>
<td class="empty" width="110">
&nbsp;
</td>
</tr>
<tr>
<td background="../images/layout/aspheuteheaderext.gif" class="header" width="110">
<p class="content">
<a href="/REMOVED/" title="Our most popular articles translated into English">English Articles</a><br>
<a href="/REMOVED/" title="Visit our Chinese content section">Chinese Articles</a><br>
<a href="../autoren/UnsereAutoren.htm" title="Unsere Autoren">Unsere Autoren</a><br>
&nbsp;<br>
<a href="/REMOVED/link2us.asp" title="Setzen Sie einen Link zu AspHeute!">Link zu AspHeute</a><br>
<a href="/REMOVED/impressum.asp" title="Das Impressum von AspHeute">Impressum</a><br>
<a href="/REMOVED/advertise.asp" title="Werben auch Sie auf AspHeute">Werben</a><br>
<a href="/REMOVED/kontakt.asp" title="Teilen Sie uns Ihre W&uuml;nsche, Beschwerden und Anregungen mit">Anfragen</a><br>
</p>
</td>
</tr>
</table>
</div>



<!-- Content starts here  -->
<div style="position:absolute;left:120px;top:108px">
<table cellspacing="0" cellpadding="0"><!--Tabelle aussen-->
<tr><!--Tabelle aussen, 1/2-->
<td><!--Tabelle aussen, 1/1-->
    <table border=0 align=center><tr><td align=center>


</td></tr></table>

<H1>Mailadressen sch&uuml;tzen</H1>
<p>
Geschrieben von: <a href="../autoren/stefanmayer.htm">Stefan Mayer</a><br>
Kategorie: <a href="../kategorien/ASP%20Tricks.htm">ASP Tricks</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20030428"></SCRIPT>
</p>
<p>
G&auml;steb&uuml;cher und Diskussionsforen sind immer &ouml;fter Ziele von eMail-Spidern. Sie werden als unersch&ouml;pfliche Datenquelle f&uuml;r 
Spammings diverser besonders "seri&ouml;ser" Firmen mi&szlig;braucht. Aber auch simple Kontaktadressen auf Homepages sind sehr beliebt, 
weil diese mit hoher Wahrscheinlichkeit auch gelesen werden. Um sich vor Spammings zu sch&uuml;tzen, sollte man daher seine 
Mailadresse nirgendwo hinterlassen. Trotzdem will und kann man nicht immer darauf verzichten - ganz besonders auf Kontaktseiten. 
Ziel meines Vorhabens - und somit auch dieses Artikels - ist es, eine Variante anzubieten, die es erm&ouml;glicht, Mailadressen 
bestm&ouml;glich vor Mi&szlig;brauch zu sch&uuml;tzen und trotzdem einen gr&ouml;&szlig;tm&ouml;glichen Komfort f&uuml;r die Besucher der Webseiten zu bieten.
</p>
<p>
Gleich vorweg - einen 100%igen Schutz wird es nie geben. Selbst wenn man die Mailadressen grafisch an den Browser sendet, so 
besteht immer noch die M&ouml;glichkeit, da&szlig; die Adressen abgeschrieben werden oder einzeln kopiert werden. Ich bin jedoch bem&uuml;ht, 
es Spidern so schwer wie m&ouml;glich zu machen.
</p>
<p>
Der Artikel <a href="20010518.htm">Broken Links mit Link Sleuth erfassen</a> enth&auml;lt 
eine Beschreibung eines Freeware-Spiders, der komplette Webs nach Hyperlinks aller Art durchsuchen kann - auch nach 
eMail-Adressen. Diese lassen sich zwar nicht so leicht exportieren, aber trotzdem habe ich in weiterer Folge mit diesem 
Programm gearbeitet, um meinen Erfolg zu testen, bzw. um auf eine genauere Funktionsbeschreibung eines anderen Programms 
verzichten zu k&ouml;nnen.
</p>

<h2>Mailadressen im Klartext</h2>
<pre style="background='silver';">
...
&lt;br&gt;
Hier k&ouml;nnen Sie mit uns &lt;a href="mailto:Stefan.mayer@e-box.at"&gt;in Kontakt treten&lt;/a&gt;
&lt;br&gt;
...
</pre>

<p>
&Ouml;ffne ich nun diese Seite mit Xenu erhalte ich folgenden Output:
</p>

<IMG SRC="Bilder/200304/20030428_1.png" width="764" height="169" alt="" border="0">

<p>
Die Mailadresse wurde als solche erkannt. Ist ja auch kein Wunder, der Klammeraffe hat sie verraten. So schreiben es zumindest 
einige Fachzeitschriften f&uuml;r Webdesigner oder Internetprofis. Dort wird vorgeschlagen, das <b>@</b> zu ersetzen, auf da&szlig; es nicht mehr 
erkannt wird. Das kann man tun, in dem man stattdessen <b>&amp;#64;</b> schreibt. Der Browser wird das Zeichen verstehen und einen 
g&uuml;ltigen Mail-Link daraus machen. Ich probiere es einfach aus:
</p>

<pre style="background='silver';">
...
&lt;br&gt;
Hier k&ouml;nnen Sie mit uns &lt;a href="mailto:Stefan.mayer&amp;#64;e-box.at"&gt;in Kontakt treten&lt;/a&gt;
&lt;br&gt;
...
</pre>

<p>
Lasse ich Xenu an die Seite, erhalte ich jedoch ein recht &auml;hnliches Ergebnis:
</p>

<IMG SRC="Bilder/200304/20030428_2.png" width="764" height="169" alt="" border="0">

<p>
Tja, offenbar sind auch einfache Spiderprogramme genauso schlau wie Webbrowser - auf jeden Fall schlauer als so mancher 
Fachjournalist. Die meisten Spider achten auf das &lt;a href="mailto:...
</p>

<p>
Aber auch daf&uuml;r gibt es Abhilfe. Die Idee ist die, da&szlig; der Browser keinen HTML-Code mit dem Mail-Link erh&auml;lt, sondern ein 
Script, das den Mail-Link erstellt. Das sieht zum Beispiel so aus: 
</p>

<pre style="background='silver';">
...
&lt;br&gt;
Hier k&ouml;nnen Sie mit uns 
&lt;script language="javascript"&gt;
document.write("&lt;a href='mailto:stefan.mayer");
document.write("@");
document.write("e-box.at'&gt;");
document.write("in Kontakt treten");
document.write("&lt;/a&gt;");
&lt;/script&gt;
&lt;br&gt;
...
</pre>

<p>
Und siehe da - Xenu bekommt Probleme:
</p>

<IMG SRC="Bilder/200304/20030428_3.png" width="764" height="169" alt="" border="0">

<p>
Warum wird die Mailadresse nun nicht erkannt? Sie befindet sich in einem Javascript, das von den meisten Spidern ignoriert 
wird, und zus&auml;tzlich ist sie &uuml;ber mehrere Kommandos verteilt, soda&szlig; auch mit einer reinen Suche nach <b>*@*.*</b> keine Mailadresse 
gefunden werden kann.
</p>
<p>
Dieser Mechanismus wirkt jetzt vielleicht etwas un&uuml;bersichtlich und aufwendig, darum habe ich im n&auml;chsten Abschnitt ein 
ASP-Script vorbereitet, das eine gewisse Hilfestellung anbietet und sich leicht in bestehende G&auml;steb&uuml;cher, Forensysteme, 
etc. einbinden l&auml;sst.
</p>

<h2>Die Vollautomatik</h2>
<p>
Gleich vorweg, die Funktion sieht so aus:
</p>

<pre style="background='silver';">
&lt;%
Function WriteMail(email, text)
 isOK = False
 p = InStr(email, "@")
 If p &gt; 0 Then
  e1 = Left(email,p-1)
  e2 = Mid(email,p+1)
  strOut = "document.write(""&lt;a href='mailto:" &amp; e1 &amp; """);document.write(""@"");" & _
      "document.write(""" &amp; e2 &amp; "'&gt;"");"
  p = InStr(text, "@")
  IsOK = True
  If p &gt; 0 Then
   e1 = Left(email,p-1)
   e2 = Mid(email,p+1)
   strOut = strOut &amp; "document.write(""" &amp; e1 &amp; """);document.write(""@"");" & _
       "document.write(""" &amp; e2 &amp; "&lt;/a&gt;"");"
  Else
   strOut = strOut &amp; "document.write(""" &amp; text &amp; """);document.write(""&lt;/a&gt;"");"  
  End If
 End If
 If IsOK Then 
  WriteMail = "&lt;script language=""javascript""&gt;" &amp; strOut &amp; "&lt;/script&gt;" 
 Else 
  WriteMail = "-"
 End If
End Function
%&gt;
</pre>

<p>
Zur Erkl&auml;rung: Der Funktion <i>WriteMail</i> werden zwei Parameter &uuml;bergeben - die Mailadresse sowie ein Text, der angezeigt werden 
soll. Zuerst wird die Mailadresse nach dem ber&uuml;hmten @ durchsucht. Wird das Zeichen gefunden, so kann der String in 2 Teile 
zerlegt werden - in e1, dem Teil davor und in e2, der Dom&auml;ne. Ohne @ handelt es sich um keine g&uuml;ltige Mailadresse
</p>
<p>
Im n&auml;chsten Schritt wird der Text ebenfalls durchsucht und gegebenenfalls wie die Mailadresse in 3 Teile erlegt. Das ist 
notwendig, denn es k&ouml;nnte ja vorkommen, da&szlig; die Mailadresse auch im Klartext angezeigt werden soll. 
</p>
<p>
Abschlie&szlig;end wird das so erstellte Javascript als Funktionswert zur&uuml;ckgegeben - oder ein "-", falls keine g&uuml;ltige Mailadresse 
&uuml;bergeben wurde.
</p>
<p>
Der Aufruf der Funktion erfolgt so: 
</p>

<pre style="background='silver';">
...
&lt;br&gt;
Hier k&ouml;nnen Sie mit uns &lt;%=WriteMail("stefan.mayer@e-box.at","in Kontakt treten")%&gt;
&lt;br&gt;
...
</pre>

<p>
Oder wenn die Daten aus einer Datenbank kommen:
</p>

<pre style="background='silver';">
...
&lt;% While Not rs.eof %&gt;
...
&lt;td&gt;&lt;%=WriteMail(RS.Fields("email").Value, RS.Fields("Anrede").Value)%&gt;&lt;/td&gt;
...
&lt;% rs.MoveNext
Wend %&gt;
...
</pre>

<h2>Schlu&szlig;bemerkung</h2>
<p>
Dieser doch relativ einfache Trick bietet zwar keinen 100%igen Schutz vor Mi&szlig;brauch, er macht es den &Uuml;belt&auml;tern jedoch 
recht schwer. 
</p>
<h2>Download des Codes</h2>
<p><a href="../Code/20030428.zip">Klicken Sie hier</a>, um den Download zu starten.</p>
<h2>Verwandte Artikel</h2>
<p>
<a href="20010518.htm">Broken Links mit Link Sleuth erfassen</a><br>

</p>

<h2>Wenn Sie jetzt Fragen haben...</h2>
<p>
Wenn Sie Fragen rund um die in diesem Artikel vorgestellte Technologie haben, dann schauen Sie einfach bei uns
in den <a href="http://glengamoi.com/forums/">Community Foren der deutschen .NET Community</a> vorbei. Die Teilnehmer 
helfen Ihnen gerne, wenn Sie sich zur im Artikel vorgestellten Technologie weiterbilden m&ouml;chten.
</p>

<p>
<a href="http://glengamoi.com/forums/"><img src="../images/glengamoi.com_250.gif" width="250" height="80" alt="" border="0"></a>
</p>


<p>
Haben Sie Fragen die sich direkt auf den Inhalt des Artikels beziehen, dann schreiben Sie dem Autor! Unsere Autoren
freuen sich &uuml;ber Feedback zu ihren Artikeln. Ein einfacher Klick auf die <i>Autor kontaktieren</i>
Schaltfl&auml;che (weiter unten) und schon haben Sie ein f&uuml;r diesen Artikel personalisiertes Anfrageformular.
</p>

<p>&nbsp;</p>
<p>
Und zu guter Letzt m&ouml;chten wir Sie bitten, den Artikel zu bewerten. Damit helfen Sie uns, 
die Qualit&auml;t der Artikel zu verbessern - und anderen Lesern bei der Auswahl der Artikel,
die sie lesen sollten.
</p>

<FORM METHOD="POST" STYLE="margin-bottom: 0px;" NAME="formRating" ACTION="/service/bewerten.asp">
<INPUT TYPE="HIDDEN" NAME="ArticleId" VALUE="20030428" />
<CENTER>
<TABLE BORDER="0" CELLSPACING="0" CELLPADDING="0">
<TR>
	<TD ALIGN="CENTER" VALIGN="MIDDLE" COLSPAN="7">Bewerten Sie diesen Artikel</TD>
</TR>
<TR>
	<TD><EM>&nbsp;Sehr gut&nbsp;</EM></TD>
	<TD><INPUT TYPE="radio" value="1" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="2" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="3" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="4" NAME="radioRating" /></TD>
	<TD><INPUT TYPE="radio" value="5" NAME="radioRating" /></TD>
	<TD ALIGN="right"><EM>&nbsp;Nicht gen&uuml;gend</EM></TD>
	<TD ROWSPAN="2" VALIGN="middle">&nbsp;<INPUT TYPE="submit" VALUE="Werten!" /></TD>
</TR>
<TR>
	<TD>&nbsp;</TD>
	<TD ALIGN="CENTER">&nbsp;1</TD>
	<TD ALIGN="CENTER">&nbsp;2</TD>
	<TD ALIGN="CENTER">&nbsp;3</TD>
	<TD ALIGN="CENTER">&nbsp;4</TD>
	<TD ALIGN="CENTER">&nbsp;5</TD>
	<TD>&nbsp;</TD>
</TR>
</TABLE>
</FORM>
</center>
&nbsp;<P>
<center>
<p><table><tr><td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="pagetitle" value="Mailadressen sch&uuml;tzen"><input type="hidden" name="pageurl" value="http://www.aspheute.com/artikel/20030428.htm"><input type="image" src="../images/layout/senden.png" width="107" height="20" border="0" alt="Schicken Sie diese Seite einem Freund!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top>
<form action="REMOVED" method="GET"><input type="hidden" name="Author" value="Stefan Mayer"><input type="hidden" name="AuthorEmail" value="Stefan@x-press.at"><input type="hidden" name="Artikel" value="20030428"><input type="image" src="../images/layout/kontakt.png" width="107" height="20" border="0" alt="Kontaktieren Sie den Autor!" style="cursor='hand';"></form>
<td>&nbsp;&nbsp;</td>
<td valign=top><a href="../PrinterFriendly/20030428.htm"><img src="../images/layout/druck.png" width="118" height="20" border="0" alt="F&uuml;r Ausdruck optimierte Seite"></a></td>
</tr></table></p>
</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
