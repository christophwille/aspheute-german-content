
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML>
<HEAD>
<TITLE>ccfuncs.asp</TITLE>
<STYLE>
BODY {
  font-family: "sans-serif";
  bgcolor: "#FFFFFF";
}

PRE {
  font-family: "monospaced";
  }

#statement {
  color: "#0000FF"; /* Color for Script Statements (things like Call, Dim, If...Then...Else, etc) */
  }

#function {
  color: "#FF0000"; /* Color for Script Functions (things like Instr, Abs, etc) */
  }

#script {
  color: "#800000"; /* Color for anything that is not in one of the above script categories, but is
                      contained inside script delimeters */
  }

#scripton {
  color: "#FF00FF"; /* Color for anything that is not in one of the above script categories, but is
                      contained inside script delimeters, inside quotation marks */
  }

#html {
  color: "#0000FF"; /* Color for any non-script html output */
  }

#base {
  color: "#000000"; /* Color for any non-script, non-html output */
  }

#comment {
  color: "#008000"; /* Color for any commented code */
  }

#linenum {
  color: "#808080"; /* Color for the line numbers */
  }
</STYLE>
</HEAD>

<BODY>

<pre><span id="linenum">001&nbsp;&nbsp;</span><span id="script">&lt;SCRIPT LANGUAGE=<span id="scripton">"JScript"</span> RUNAT=<span id="scripton">"SERVER"</span>&gt;<br><span id="linenum">002&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">003&nbsp;&nbsp;</span>    FUNCTION:  isCreditCard(st)<br><span id="linenum">004&nbsp;&nbsp;</span> <br><span id="linenum">005&nbsp;&nbsp;</span>    INPUT:     st - a string representing a credit card number<br><span id="linenum">006&nbsp;&nbsp;</span><br><span id="linenum">007&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number passes the Luhn Mod-10<br><span id="linenum">008&nbsp;&nbsp;</span>		    test.<br><span id="linenum">009&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">010&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">011&nbsp;&nbsp;</span><br><span id="linenum">012&nbsp;&nbsp;</span>function isCreditCard(st) {<br><span id="linenum">013&nbsp;&nbsp;</span>  <span id="comment">// Encoding only works on cards with less than 19 digits</span><br><span id="linenum">014&nbsp;&nbsp;</span>  if (st.length &gt; 19)<br><span id="linenum">015&nbsp;&nbsp;</span>    return (false);<br><span id="linenum">016&nbsp;&nbsp;</span><br><span id="linenum">017&nbsp;&nbsp;</span>  sum = 0; mul = 1; l = st.length;<br><span id="linenum">018&nbsp;&nbsp;</span>  for (i = 0; i &lt; l; i++) {<br><span id="linenum">019&nbsp;&nbsp;</span>    digit = st.substring(l-i-1,l-i);<br><span id="linenum">020&nbsp;&nbsp;</span>    tproduct = parse<span id="function">Int</span>(digit ,10)*mul;<br><span id="linenum">021&nbsp;&nbsp;</span>    if (tproduct &gt;= 10)<br><span id="linenum">022&nbsp;&nbsp;</span>      sum += (tproduct % 10) + 1;<br><span id="linenum">023&nbsp;&nbsp;</span>    else<br><span id="linenum">024&nbsp;&nbsp;</span>      sum += tproduct;<br><span id="linenum">025&nbsp;&nbsp;</span>    if (mul == 1)<br><span id="linenum">026&nbsp;&nbsp;</span>      mul++;<br><span id="linenum">027&nbsp;&nbsp;</span>    else<br><span id="linenum">028&nbsp;&nbsp;</span>      mul--;<br><span id="linenum">029&nbsp;&nbsp;</span>  }<br><span id="linenum">030&nbsp;&nbsp;</span><br><span id="linenum">031&nbsp;&nbsp;</span>  if ((sum % 10) == 0)<br><span id="linenum">032&nbsp;&nbsp;</span>    return (true);<br><span id="linenum">033&nbsp;&nbsp;</span>  else<br><span id="linenum">034&nbsp;&nbsp;</span>    return (false);<br><span id="linenum">035&nbsp;&nbsp;</span><br><span id="linenum">036&nbsp;&nbsp;</span>} <span id="comment">// END FUNCTION isCreditCard()</span><br><span id="linenum">037&nbsp;&nbsp;</span><br><span id="linenum">038&nbsp;&nbsp;</span><br><span id="linenum">039&nbsp;&nbsp;</span><br><span id="linenum">040&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">041&nbsp;&nbsp;</span>    FUNCTION:  isVisa()<br><span id="linenum">042&nbsp;&nbsp;</span> <br><span id="linenum">043&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">044&nbsp;&nbsp;</span><br><span id="linenum">045&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid VISA number.<br><span id="linenum">046&nbsp;&nbsp;</span>		    <br><span id="linenum">047&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">048&nbsp;&nbsp;</span><br><span id="linenum">049&nbsp;&nbsp;</span>    Sample number: 4111 1111 1111 1111 (16 digits)<br><span id="linenum">050&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">051&nbsp;&nbsp;</span><br><span id="linenum">052&nbsp;&nbsp;</span>function isVisa(cc)<br><span id="linenum">053&nbsp;&nbsp;</span>{<br><span id="linenum">054&nbsp;&nbsp;</span>  if (((cc.length == 16) || (cc.length == 13)) &&<br><span id="linenum">055&nbsp;&nbsp;</span>      (cc.substring(0,1) == 4))<br><span id="linenum">056&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">057&nbsp;&nbsp;</span>  return false;<br><span id="linenum">058&nbsp;&nbsp;</span>}  <span id="comment">// END FUNCTION isVisa()</span><br><span id="linenum">059&nbsp;&nbsp;</span><br><span id="linenum">060&nbsp;&nbsp;</span><br><span id="linenum">061&nbsp;&nbsp;</span><br><span id="linenum">062&nbsp;&nbsp;</span><br><span id="linenum">063&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">064&nbsp;&nbsp;</span>    FUNCTION:  isMasterCard()<br><span id="linenum">065&nbsp;&nbsp;</span> <br><span id="linenum">066&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">067&nbsp;&nbsp;</span><br><span id="linenum">068&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid MasterCard<br><span id="linenum">069&nbsp;&nbsp;</span>		    number.<br><span id="linenum">070&nbsp;&nbsp;</span>		    <br><span id="linenum">071&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">072&nbsp;&nbsp;</span><br><span id="linenum">073&nbsp;&nbsp;</span>    Sample number: 5500 0000 0000 0004 (16 digits)<br><span id="linenum">074&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">075&nbsp;&nbsp;</span><br><span id="linenum">076&nbsp;&nbsp;</span>function isMasterCard(cc)<br><span id="linenum">077&nbsp;&nbsp;</span>{<br><span id="linenum">078&nbsp;&nbsp;</span>  firstdig = cc.substring(0,1);<br><span id="linenum">079&nbsp;&nbsp;</span>  seconddig = cc.substring(1,2);<br><span id="linenum">080&nbsp;&nbsp;</span>  if ((cc.length == 16) && (firstdig == 5) &&<br><span id="linenum">081&nbsp;&nbsp;</span>      ((seconddig &gt;= 1) && (seconddig &lt;= 5)))<br><span id="linenum">082&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">083&nbsp;&nbsp;</span>  return false;<br><span id="linenum">084&nbsp;&nbsp;</span><br><span id="linenum">085&nbsp;&nbsp;</span>} <span id="comment">// END FUNCTION isMasterCard()</span><br><span id="linenum">086&nbsp;&nbsp;</span><br><span id="linenum">087&nbsp;&nbsp;</span><br><span id="linenum">088&nbsp;&nbsp;</span><br><span id="linenum">089&nbsp;&nbsp;</span><br><span id="linenum">090&nbsp;&nbsp;</span><br><span id="linenum">091&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">092&nbsp;&nbsp;</span>    FUNCTION:  isAmericanExpress()<br><span id="linenum">093&nbsp;&nbsp;</span> <br><span id="linenum">094&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">095&nbsp;&nbsp;</span><br><span id="linenum">096&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid American<br><span id="linenum">097&nbsp;&nbsp;</span>		    Express number.<br><span id="linenum">098&nbsp;&nbsp;</span>		    <br><span id="linenum">099&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">100&nbsp;&nbsp;</span><br><span id="linenum">101&nbsp;&nbsp;</span>    Sample number: 340000000000009 (15 digits)<br><span id="linenum">102&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">103&nbsp;&nbsp;</span><br><span id="linenum">104&nbsp;&nbsp;</span>function isAmericanExpress(cc)<br><span id="linenum">105&nbsp;&nbsp;</span>{<br><span id="linenum">106&nbsp;&nbsp;</span>  firstdig = cc.substring(0,1);<br><span id="linenum">107&nbsp;&nbsp;</span>  seconddig = cc.substring(1,2);<br><span id="linenum">108&nbsp;&nbsp;</span>  if ((cc.length == 15) && (firstdig == 3) &&<br><span id="linenum">109&nbsp;&nbsp;</span>      ((seconddig == 4) || (seconddig == 7)))<br><span id="linenum">110&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">111&nbsp;&nbsp;</span>  return false;<br><span id="linenum">112&nbsp;&nbsp;</span><br><span id="linenum">113&nbsp;&nbsp;</span>} <span id="comment">// END FUNCTION isAmericanExpress()</span><br><span id="linenum">114&nbsp;&nbsp;</span><br><span id="linenum">115&nbsp;&nbsp;</span><br><span id="linenum">116&nbsp;&nbsp;</span><br><span id="linenum">117&nbsp;&nbsp;</span><br><span id="linenum">118&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">119&nbsp;&nbsp;</span>    FUNCTION:  isDinersClub()<br><span id="linenum">120&nbsp;&nbsp;</span> <br><span id="linenum">121&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">122&nbsp;&nbsp;</span><br><span id="linenum">123&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid Diner<span id="comment">'s</span><br><span id="linenum">124&nbsp;&nbsp;</span>		    Club number.<br><span id="linenum">125&nbsp;&nbsp;</span>		    <br><span id="linenum">126&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">127&nbsp;&nbsp;</span><br><span id="linenum">128&nbsp;&nbsp;</span>    Sample number: 30000000000004 (14 digits)<br><span id="linenum">129&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">130&nbsp;&nbsp;</span><br><span id="linenum">131&nbsp;&nbsp;</span>function isDinersClub(cc)<br><span id="linenum">132&nbsp;&nbsp;</span>{<br><span id="linenum">133&nbsp;&nbsp;</span>  firstdig = cc.substring(0,1);<br><span id="linenum">134&nbsp;&nbsp;</span>  seconddig = cc.substring(1,2);<br><span id="linenum">135&nbsp;&nbsp;</span>  if ((cc.length == 14) && (firstdig == 3) &&<br><span id="linenum">136&nbsp;&nbsp;</span>      ((seconddig == 0) || (seconddig == 6) || (seconddig == 8)))<br><span id="linenum">137&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">138&nbsp;&nbsp;</span>  return false;<br><span id="linenum">139&nbsp;&nbsp;</span>}<br><span id="linenum">140&nbsp;&nbsp;</span><br><span id="linenum">141&nbsp;&nbsp;</span><br><span id="linenum">142&nbsp;&nbsp;</span><br><span id="linenum">143&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">144&nbsp;&nbsp;</span>    FUNCTION:  isCarteBlanche()<br><span id="linenum">145&nbsp;&nbsp;</span> <br><span id="linenum">146&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">147&nbsp;&nbsp;</span><br><span id="linenum">148&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid Carte<br><span id="linenum">149&nbsp;&nbsp;</span>		    Blanche number.<br><span id="linenum">150&nbsp;&nbsp;</span>		    <br><span id="linenum">151&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">152&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">153&nbsp;&nbsp;</span><br><span id="linenum">154&nbsp;&nbsp;</span>function isCarteBlanche(cc)<br><span id="linenum">155&nbsp;&nbsp;</span>{<br><span id="linenum">156&nbsp;&nbsp;</span>  return isDinersClub(cc);<br><span id="linenum">157&nbsp;&nbsp;</span>}<br><span id="linenum">158&nbsp;&nbsp;</span><br><span id="linenum">159&nbsp;&nbsp;</span><br><span id="linenum">160&nbsp;&nbsp;</span><br><span id="linenum">161&nbsp;&nbsp;</span><br><span id="linenum">162&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">163&nbsp;&nbsp;</span>    FUNCTION:  isDiscover()<br><span id="linenum">164&nbsp;&nbsp;</span> <br><span id="linenum">165&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">166&nbsp;&nbsp;</span><br><span id="linenum">167&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid Discover<br><span id="linenum">168&nbsp;&nbsp;</span>		    card number.<br><span id="linenum">169&nbsp;&nbsp;</span>		    <br><span id="linenum">170&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">171&nbsp;&nbsp;</span><br><span id="linenum">172&nbsp;&nbsp;</span>    Sample number: 6011000000000004 (16 digits)<br><span id="linenum">173&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">174&nbsp;&nbsp;</span><br><span id="linenum">175&nbsp;&nbsp;</span>function isDiscover(cc)<br><span id="linenum">176&nbsp;&nbsp;</span>{<br><span id="linenum">177&nbsp;&nbsp;</span>  first4digs = cc.substring(0,4);<br><span id="linenum">178&nbsp;&nbsp;</span>  if ((cc.length == 16) && (first4digs == <span id="scripton">"6011"</span>))<br><span id="linenum">179&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">180&nbsp;&nbsp;</span>  return false;<br><span id="linenum">181&nbsp;&nbsp;</span><br><span id="linenum">182&nbsp;&nbsp;</span>} <span id="comment">// END FUNCTION isDiscover()</span><br><span id="linenum">183&nbsp;&nbsp;</span><br><span id="linenum">184&nbsp;&nbsp;</span><br><span id="linenum">185&nbsp;&nbsp;</span><br><span id="linenum">186&nbsp;&nbsp;</span><br><span id="linenum">187&nbsp;&nbsp;</span><br><span id="linenum">188&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">189&nbsp;&nbsp;</span>    FUNCTION:  isEnRoute()<br><span id="linenum">190&nbsp;&nbsp;</span> <br><span id="linenum">191&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">192&nbsp;&nbsp;</span><br><span id="linenum">193&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid enRoute<br><span id="linenum">194&nbsp;&nbsp;</span>		    card number.<br><span id="linenum">195&nbsp;&nbsp;</span>		    <br><span id="linenum">196&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">197&nbsp;&nbsp;</span><br><span id="linenum">198&nbsp;&nbsp;</span>    Sample number: 201400000000009 (15 digits)<br><span id="linenum">199&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">200&nbsp;&nbsp;</span><br><span id="linenum">201&nbsp;&nbsp;</span>function isEnRoute(cc)<br><span id="linenum">202&nbsp;&nbsp;</span>{<br><span id="linenum">203&nbsp;&nbsp;</span>  first4digs = cc.substring(0,4);<br><span id="linenum">204&nbsp;&nbsp;</span>  if ((cc.length == 15) &&<br><span id="linenum">205&nbsp;&nbsp;</span>      ((first4digs == <span id="scripton">"2014"</span>) ||<br><span id="linenum">206&nbsp;&nbsp;</span>       (first4digs == <span id="scripton">"2149"</span>)))<br><span id="linenum">207&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">208&nbsp;&nbsp;</span>  return false;<br><span id="linenum">209&nbsp;&nbsp;</span>}<br><span id="linenum">210&nbsp;&nbsp;</span><br><span id="linenum">211&nbsp;&nbsp;</span><br><span id="linenum">212&nbsp;&nbsp;</span><br><span id="linenum">213&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">214&nbsp;&nbsp;</span>    FUNCTION:  isJCB()<br><span id="linenum">215&nbsp;&nbsp;</span> <br><span id="linenum">216&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">217&nbsp;&nbsp;</span><br><span id="linenum">218&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is a valid JCB<br><span id="linenum">219&nbsp;&nbsp;</span>		    card number.<br><span id="linenum">220&nbsp;&nbsp;</span>		    <br><span id="linenum">221&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">222&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">223&nbsp;&nbsp;</span><br><span id="linenum">224&nbsp;&nbsp;</span>function isJCB(cc)<br><span id="linenum">225&nbsp;&nbsp;</span>{<br><span id="linenum">226&nbsp;&nbsp;</span>  first4digs = cc.substring(0,4);<br><span id="linenum">227&nbsp;&nbsp;</span>  if ((cc.length == 16) &&<br><span id="linenum">228&nbsp;&nbsp;</span>      ((first4digs == <span id="scripton">"3088"</span>) ||<br><span id="linenum">229&nbsp;&nbsp;</span>       (first4digs == <span id="scripton">"3096"</span>) ||<br><span id="linenum">230&nbsp;&nbsp;</span>       (first4digs == <span id="scripton">"3112"</span>) ||<br><span id="linenum">231&nbsp;&nbsp;</span>       (first4digs == <span id="scripton">"3158"</span>) ||<br><span id="linenum">232&nbsp;&nbsp;</span>       (first4digs == <span id="scripton">"3337"</span>) ||<br><span id="linenum">233&nbsp;&nbsp;</span>       (first4digs == <span id="scripton">"3528"</span>)))<br><span id="linenum">234&nbsp;&nbsp;</span>    return isCreditCard(cc);<br><span id="linenum">235&nbsp;&nbsp;</span>  return false;<br><span id="linenum">236&nbsp;&nbsp;</span><br><span id="linenum">237&nbsp;&nbsp;</span>} <span id="comment">// END FUNCTION isJCB()</span><br><span id="linenum">238&nbsp;&nbsp;</span><br><span id="linenum">239&nbsp;&nbsp;</span><br><span id="linenum">240&nbsp;&nbsp;</span><br><span id="linenum">241&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">242&nbsp;&nbsp;</span>    FUNCTION:  isAnyCard()<br><span id="linenum">243&nbsp;&nbsp;</span> <br><span id="linenum">244&nbsp;&nbsp;</span>    INPUT:     cc - a string representing a credit card number<br><span id="linenum">245&nbsp;&nbsp;</span><br><span id="linenum">246&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is any valid credit<br><span id="linenum">247&nbsp;&nbsp;</span>		    card number for any of the accepted card types.<br><span id="linenum">248&nbsp;&nbsp;</span>		    <br><span id="linenum">249&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">250&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">251&nbsp;&nbsp;</span><br><span id="linenum">252&nbsp;&nbsp;</span>function isAnyCard(cc)<br><span id="linenum">253&nbsp;&nbsp;</span>{<br><span id="linenum">254&nbsp;&nbsp;</span>  if (!isCreditCard(cc))<br><span id="linenum">255&nbsp;&nbsp;</span>    return false;<br><span id="linenum">256&nbsp;&nbsp;</span>  if (!isMasterCard(cc) && !isVisa(cc) && !isAmericanExpress(cc) && !isDinersClub(cc) &&<br><span id="linenum">257&nbsp;&nbsp;</span>      !isDiscover(cc) && !isEnRoute(cc) && !isJCB(cc)) {<br><span id="linenum">258&nbsp;&nbsp;</span>    return false;<br><span id="linenum">259&nbsp;&nbsp;</span>  }<br><span id="linenum">260&nbsp;&nbsp;</span>  return true;<br><span id="linenum">261&nbsp;&nbsp;</span><br><span id="linenum">262&nbsp;&nbsp;</span>} <span id="comment">// END FUNCTION isAnyCard()</span><br><span id="linenum">263&nbsp;&nbsp;</span><br><span id="linenum">264&nbsp;&nbsp;</span><br><span id="linenum">265&nbsp;&nbsp;</span><br><span id="linenum">266&nbsp;&nbsp;</span>/*  ================================================================<br><span id="linenum">267&nbsp;&nbsp;</span>    FUNCTION:  isCardMatch()<br><span id="linenum">268&nbsp;&nbsp;</span> <br><span id="linenum">269&nbsp;&nbsp;</span>    INPUT:    cardType - a string representing the credit card type<br><span id="linenum">270&nbsp;&nbsp;</span>	      cardNumber - a string representing a credit card number<br><span id="linenum">271&nbsp;&nbsp;</span><br><span id="linenum">272&nbsp;&nbsp;</span>    RETURNS:  true, if the credit card number is valid for the particular<br><span id="linenum">273&nbsp;&nbsp;</span>	      credit card type given in <span id="scripton">"cardType"</span>.<br><span id="linenum">274&nbsp;&nbsp;</span>		    <br><span id="linenum">275&nbsp;&nbsp;</span>	      false, otherwise<br><span id="linenum">276&nbsp;&nbsp;</span>    ================================================================ */<br><span id="linenum">277&nbsp;&nbsp;</span><br><span id="linenum">278&nbsp;&nbsp;</span>function isCardMatch (cardType, cardNumber)<br><span id="linenum">279&nbsp;&nbsp;</span>{<br><span id="linenum">280&nbsp;&nbsp;</span><br><span id="linenum">281&nbsp;&nbsp;</span>	cardType = cardType.toUpperCase();<br><span id="linenum">282&nbsp;&nbsp;</span>	var doesMatch = true;<br><span id="linenum">283&nbsp;&nbsp;</span><br><span id="linenum">284&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"VISA"</span>) && (!isVisa(cardNumber)))<br><span id="linenum">285&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">286&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"MASTERCARD"</span>) && (!isMasterCard(cardNumber)))<br><span id="linenum">287&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">288&nbsp;&nbsp;</span>	if ( ( (cardType == <span id="scripton">"AMERICANEXPRESS"</span>) || (cardType == <span id="scripton">"AMEX"</span>) )<br><span id="linenum">289&nbsp;&nbsp;</span>                && (!isAmericanExpress(cardNumber))) doesMatch = false;<br><span id="linenum">290&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"DISCOVER"</span>) && (!isDiscover(cardNumber)))<br><span id="linenum">291&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">292&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"JCB"</span>) && (!isJCB(cardNumber)))<br><span id="linenum">293&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">294&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"DINERS"</span>) && (!isDinersClub(cardNumber)))<br><span id="linenum">295&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">296&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"CARTEBLANCHE"</span>) && (!isCarteBlanche(cardNumber)))<br><span id="linenum">297&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">298&nbsp;&nbsp;</span>	if ((cardType == <span id="scripton">"ENROUTE"</span>) && (!isEnRoute(cardNumber)))<br><span id="linenum">299&nbsp;&nbsp;</span>		doesMatch = false;<br><span id="linenum">300&nbsp;&nbsp;</span>	return doesMatch;<br><span id="linenum">301&nbsp;&nbsp;</span><br><span id="linenum">302&nbsp;&nbsp;</span>}  <span id="comment">// END FUNCTION CardMatch()</span><br><span id="linenum">303&nbsp;&nbsp;</span>&lt;/SCRIPT&gt;</span><br></pre>
</BODY>
</HTML>
