<HTML>
<HEAD>
<TITLE>Tee Off! Zahlen, W&ouml;rter, Zahlw&ouml;rter</TITLE>
<META HTTP-EQUIV="content-type: text/html; charset= ISO-8859-1">
<META HTTP-EQUIV="Content-Language" CONTENT="DE">
<META NAME="robots" CONTENT="FOLLOW,INDEX">
<META NAME="generator" CONTENT="Xitra Site Publishing">
<meta name="Author" content="webmaster@aspheute.com">

<META NAME="revisit-after" CONTENT="21 days">
<META NAME="copyright" CONTENT="(c) 2000-2006. Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch¸tzt.">
<META HTTP-EQUIV="expires" CONTENT="1999-03-30T00:00:00+00:00"> 
<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
<META HTTP-EQUIV="Cache-Control" CONTENT="no-store">

<meta http-equiv="Description" name="Description" content="Wieder wurde ein spannendes Turnier ausgetragen. Es gab immerhin 79 Einsendungen mit einer Spannweite von 1578 bis zu 271 Schl&auml;gen. Wie man dem Leaderboard entnehmen kann war der Kampf an der Spitze recht hart und spannend.">
<meta http-equiv="Keywords" name="Keywords" content="ASP,Active Server Pages,IIS,Internet Information Server,PWS,Personal Web Server,ADO,ASP Golf,Golf,Turnier,Zahlwˆrter,Umwandlung,Lˆsungen,ASPGolf,Leaderboard,Green">
<link rel="stylesheet" href="../includes/default.css">
</HEAD>
<BODY BGCOLOR="#ffffff" >


<div style="border-bottom: solid 5px white;">
<div class="DotNetGermanCommunityBar">
    <a href="http://www.glengamoi.com">Glengamoi (Forum)</a> &middot;
    <a href="http://www.aspheute.com/" style="font-weight: bold">AspHeute</a> &middot;
    <a href="http://dotnetheute.com/">.NET Heute (RSS-Suche)</a> &middot;
    <a href="http://aspxfiles.com/">AspxFiles (Wiki)</a> &middot;
    <a href="http://blogs.dotnetgerman.com/">.NET Blogs</a>
</div>
</div>


<H1>Tee Off! Zahlen, W&ouml;rter, Zahlw&ouml;rter</H1>
<p>
Geschrieben von: <a href="../autoren/bernhardspuida.htm">Bernhard Spuida</a><br>
Kategorie: <a href="../kategorien/Tee%20Off.htm">Tee Off</a><br>
<SCRIPT src="/service/artikelbewertung.asp?Artikel=20030115"></SCRIPT>
</p>


<p><strong>This printed page brought to you by <a href="http://www.alphasierrapapa.com/">AlphaSierraPapa</a></strong></p><p>
Die Zeit der Entzugserscheinungen ist vorbei! Wieder wurde ein spannendes Turnier ausgetragen. Es gab immerhin 79 Einsendungen 
mit einer Spannweite von 1578 bis zu 271 Schl&auml;gen. Wie man dem 
<a href="http://www.aspgerman.com/Golf/archiv.asp?action=leader&id=8#data">Leaderboard</a> und dem 
<a href="http://www.glengamoi.com/pipermail/golf.asp/">Archiv der Golfliste</a> entnehmen kann war der Kampf an der Spitze recht 
hart und spannend. Besonders freuen wir uns mit Yvonne Eichner die erste ASP-Golferin begr&uuml;ssen zu d&uuml;rfen! Es ist also 
an der Zeit endlich das vierte Turnier und seine &uuml;beraus interessanten L&ouml;sungen vorzustellen.
</p>

<h2>Die Aufgabenstellung</h2>
<p>
Wie man von Schecks her kennt (nicht da&szlig; ich t&auml;glich Unmengen davon kriege) mu&szlig; der Betrag in Zahlen und Worten darauf 
stehen. Das geh&ouml;rt nat&uuml;rlich kontrolliert!
</p>
<p>
Eine Zahl kleiner einer (deutschen) Billion (1.000.000.000.000) wird in englischen Zahlworten (um es leichter zu machen) angegeben 
und ist in Ziffern mit Tausendergruppierung umzuwandeln.
</p>
<p>
Zahlworte sind:<br>
<br>
Billion 1.000.000.000<br>
Million 1.000.000<br>
Thousand 1.000<br>
Hundred 100<br>
</p>
<p>
und die Zahlen 1 - 99 auf Englisch. Das Wort 'and' kann vorkommen.
</p>

<p>
Beispiele<br>
<br>
two hundred and fifteen -&gt; 215<br>
ninety billion two hundred thousand -&gt; 90.000.200.000<br>
three hundred twenty eight thousand five hundred and sixty seven -&gt; 328.567<br>
</p>

<p>
Die Zahl in Worten wird als String an <i>Application("input")</i> &uuml;bergeben, die umgewandelte Zahl wird ebenfalls als String in 
<i>Application("output")</i> zur&uuml;ckgegeben. Ung&uuml;ltiger Input kommt nicht vor.
</p>

<h2>Das Leaderboard</h2>
<ul>
	<li>1. Johann Engbers 271</li>
	<li>1. Mischa Landwehr 271</li>
	<li>3. Alexander Veit 276</li>
	<li>4. Yvonne Eichner 307</li>
	<li>5. Michael Schmidt 315</li>
	<li>6. Stefan Mayer 321</li>
	<li>7. Christian Rudig 353</li>
	<li>8. Christian Marin 360</li>
	<li>9. Claudius Ceteras 388</li>
	<li>10. Michele Marsching 462</li>
	<li>11. Ingo H&ouml;ller 540</li>
</ul>

<p>
Im Bunker landeten diesmal Mansur Esmann und Stephan Weikert. Bis zum Turnierende fanden die beiden leider ihre Sch&auml;ufelchen 
nicht.
</p>
<p>
Genug der Vorrede, auf zur Vorstellung einiger interessanter L&ouml;sungen.
</p>

<h2>Claudius Ceteras</h2>
<p>
<i>Eine L&ouml;sung von Claudius, dem wir unseren Golftester zu verdanken haben. Wie man an dieser L&ouml;sung sieht, mu&szlig; gutes 
Golf nicht viel Zeit kosten... Schade nur da&szlig; er die zweite vorgestellte L&ouml;sung nicht mehr einreichen konnte.</i>
</p>
<p>
Mein Posting entstand eine Stunde bevor ich zur Uni musste unter Stress...
Nur so ist es zu erkl&auml;ren, da&szlig; ich die FormatNumber-Funktion vergessen
und selbst implementiert habe... *doh* :-)</p>
<p>
Hier der Code....
</p>

<pre style="background='silver';">
&lt;%Set a=application
b="&Aring;&iexcl;O&Acirc;&sect;+&Atilde;é&Atilde;≠i`&Acirc;&frac34;&Atilde;&cedil;&Atilde;Å]L&Atilde;&euro;&Acirc;&pound;&Atilde;&ndash;&Acirc;&ordf;qS &Acirc;&iexcl; &Acirc;&middot;&Atilde;&ordf;@&Atilde;Ü&Acirc;&uml; l a"
for each w in split(a("input"))
y=0
for i=1to len(w):y=(y+(i+16)*asc(mid(w,i,1)))mod 256:next
p=instr(b,chr(y))
if p&lt;20then
q=q+p
elseif p&lt;28then
q=q+(p-18)*10
elseif p=28then
q=q*100
else
q=q*10^(3*(p-28))
x=x+q
q=0
end if
next
x=x+q
for i=0to 3
r=right(x,3)
x=int(x/1000)
s="."&amp;r&amp;s
if x=0then exit for
next
a("output")=mid(s,2)
%&gt;
</pre>

<p>
Der Algorithmus basiert wie Mischas L&ouml;sung auf einer Hash-Funktion, die
alle vorkommenden Worte (and, one, two, ..., nineteen, twenty, thirty,
..., ninety, hundred, thousand, million, billion) auf eine
unterschiedliche Zahl umrechnet... In der Variable b sind dann alle diese
Zahlen (au&szlig;er die f&uuml;rs "and") als Zeichen mit entsprechendem ASCII-Wert
gespeichert...
</p>
<p>
Dann kommt das wichtigste:
</p>

<pre style="background='silver';">
 if p&lt;20then
  q=q+p
 elseif p&lt;28then
  q=q+(p-18)*10
 elseif p=28then
  q=q*100
 else
  q=q*10^(3*(p-28))
  x=x+q
  q=0
 end if
</pre>

<p>
F&uuml;r die Positionen 1 bis 19 kann man die Zahl direkt &uuml;bernehmen...
Die n&auml;chsten Zahlen sind twenty, thirty, ..., ninety, also m&uuml;ssen sie
nach Abzug von 18 mit 10 malgenommen werden... An Position 28 liegt
"hundred"..., also wird alles vorher mit 100 multipliziert... Die
restlichen Positionen beinhalten thousand, million, billion... Deshalb
wird entsprechend multipliziert, aufsummiert in der Variable x und q auf
null gesetzt f&uuml;r den n&auml;chsten Dreierblock... Die letzte For-Schleife tut
die Arbeit von FormatNumber...
</p>
<p>
In der langweiligen Vorlesung dann... Ganz ohne Stress fiel mir nat&uuml;rlich
sehr schnell eine k&uuml;rzere L&ouml;sung mit nur 311 Bytes ein... *g*
</p>

<pre style="background='silver';">
&lt;%Set a=application
for each w in split(a("input"))
y=0:for i=1to len(w):y=(y+(i+16)*asc(mid(w,i,1)))mod 256:next
p=instr("&Aring;&iexcl;O&Acirc;&sect;+&Atilde;é&Atilde;≠i`&Acirc;&frac34;&Atilde;&cedil;&Atilde;Å]L&Atilde;&euro;&Acirc;&pound;&Atilde;&ndash;&Acirc;&ordf;qS &Acirc;&iexcl; &Acirc;&middot;&Atilde;&ordf;@&Atilde;Ü&Acirc;&uml; l a",chr(y))
if p&lt;20then
q=q+p
elseif p&lt;28then
q=q+(p-18)*10
elseif p=28then
q=q*100
else
q=q*1e3^(p-28)
x=x+q
q=0
end if
next
a("output")=FormatNumber(x+q,0)%&gt;
</pre>

<p>
<i>Anmerkungen: was es nicht alles ausmacht, den Sprachumfang von ASP zu kennen... Andererseits sieht man mal wieder da&szlig; 
Unis zu was gut sind :-)</i>
</p>

<h2>Stefan Mayer:</h2>
<p>
<i>Was seine Beschreibung so interessant macht, ist da&szlig; er uns den gesamten Weg bis zu seiner respektablen L&ouml;sung 
zeigt:</i>
</p>
<p>
Grunds&auml;tzlich vorweg - hier ein paar Worte zu meiner L&ouml;sung - bis zum
Schlu&szlig; entwickelte sie sich in 11 Versionen, wobei als neue Version von
mir eine gr&ouml;bere &Auml;nderung angenommen wurde.
</p>
<p>
Mein erster Ansatz war: <a href="http://www.google.at/">www.google.at</a> - suche nach "VB Text Zahl
Umwandeln" - naja, vielleicht gibt's ja einen Befehl, der aus einem
Zahlenwort eine Zahl macht. Tja - keine Treffer.
</p>
<p>
Ansatz 2 ging hin und hat aus dem Input ein Array gemacht; blank als
Trennzeichen, wo jeder bekannte Text durch die Zahl ersetzt wurde.
Anschlie&szlig;end habe ich &uuml;berall wo "100" gestanden ist, den vorigen
Arraywert mit 100 multipliziert und scheiterte an den Millionen,
Billionen &amp; co.
</p>
<p>
N&auml;chster Versuch - bzw. die Idee: "Thousand" ist doch der Zahlenblock mal
1000. Also *10^3 plus dem n&auml;chsten Zahlenblock. Million selbiges ^6.
Ich ersetzte also die Zahlen durch )*10^p+( wobei p wahlweise 3,6 oder 9
war.
</p>
<p>
In weiteren Versuchen wurde der Algorithmus zur Umwandlung in Zahlen
immer mehr ausgefeilt - im Schnitt reichten mir 2 Buchstaben zur
Ziffernerkennung.
</p>
<p>
Um das Ergebnis zu erhalten, verwendete ich die Eval-Funktion - sowie ein
Join um das Array wieder zusammenzubauen und ein paar Replaces.
</p>
<p>
Das ist meine endg&uuml;ltige L&ouml;sung (mit Zeilenumbr&uuml;chen):
</p>

<pre style="background='silver';">
1: &lt;%Set z=Application
2: u=z("Input")
3: for s=0to 10
4: u=replace(u,split("tho~wel~tee~ty~hu~m~b~ ~+*~#~$","~")(s),split("#3$
12 +10 *10 *100 #6$ #9$ + * +0)*10^ +(0")(s))
5: u=replace(u,split("one tw th fo fi x se ei ni ten el")(s),s+1)
6: next
7: for p=97to122:u=replace(u,chr(p),g):next
8: z("Output")=FormatNumber(eval("("&amp;u&amp;")"),0,,-1)%&gt;
</pre>

<p>
Und so funktioniert sie:<br>
1: sollte schon aus fr&uuml;heren Wettk&auml;mpfen bekannt sein.<br>
2: Ich arbeite mit dem kompletten String - kein Array mehr. Wozu auch!
<br>3:
11 (0 to 10) ist das Ergebnis der Optimierungen und zwar werden in dieser
Schleife zuerst "Sonderf&auml;lle", die leider etwas l&auml;nger sind, ersetzt und
in Zeile 5 die einfachen F&auml;lle von 1 bis 11.
<br>4: m --&gt; Million --&gt; #6$ wobei # sp&auml;ter durch +0)*10^ ersetzt wird und $ durch +(0.
<i>tee</i> ist der k&uuml;rzeste String zur Erkennung von "-teen" - wo ich einfach ein "+10" hineinschreibe.
<i>ty</i> ist zur Erkennung von "-ty" nicht viel k&uuml;rzer, jedoch ein einfaches "*10".
<i>hu(ndred)</i> multipliziert die vorangegangene Zahl mit 100.
<i>(t)wel(ve)</i> war leider etwas kompliziert, weil twoteen leider nicht existiert oder oneteen
<br>7: Ach ja, nun wird alles rausgeworfen, was man
nicht mehr braucht. Sprich alle verbliebenen Buchstaben, ersetzt durch die
Variable g weil g ist k&uuml;rzer als "" - und solange g "" ist....
<br>8: Und hier
wird das, was von dem Ersetzten &uuml;bergeblieben ist, mit () versehen und
ausgerechnet. Anschlie&szlig;end mit FormatNumber mit Punkten versehen. 0 steht
f&uuml;r keine Nachkommastellen, -1 f&uuml;r Tausendertrennpunkt.
</p>
<p>
Thats it.
</p>

<p>
<i>Anmerkungen dazu: Sch&ouml;n gegolft! Weiter so, wir sind schon auf Deine L&ouml;sungen beim n&auml;chsten Turnier 
gespannt.</i>
</p>

<h2>Mischa Landwehr</h2>
<p>
Nun zur ersten der beiden L&ouml;sungen die sich den ersten Platz mit 271 teilen:
</p>

<pre style="background='silver';">
&lt;%Set a=Application
i=a("input")
For z=0To 26
i=Replace(i,Split("
1e1t1i1h1v1an1on1wo1wn1four1ff1f1sx1sn1g1nn1ln1wl1y1+un1o1m1b1n1+#1r",1)
(z ),Split("+       1 2 2 4 5 5 6 7 8 9 11 12 0 00+ #3+( #6+( #9+( +10
)*1e 3")(z)) Next a("output")=FormatNumber(Eval("("&amp;i&amp;")"),0)%&gt;
</pre>

<p>
Um das Problem zu l&ouml;sen, habe ich die &uuml;bergebenen W&ouml;rter in einen
mathematischen Ausdruck umgewandelt. "one hundred and thirty seven
thousand ninety one" kann man z. B. durch "(1*100+3*10+7)*1e3+(9*10+1)"
ausdr&uuml;cken. Das muss man nur mit der Funktion Eval ausf&uuml;hren lassen und
anschlie&szlig;end formatieren.
</p>
<p>
Dazu habe ich zwei Arrays erzeugt, in denen festgelegt wurde, was
ersetzt werden muss. Anfangs sah das so aus:
</p>

<pre style="background='silver';">
"one two three four five six seven eight nine ten eleven twelve thir
teen een fif twen ty y hundred thousand million billion and"
"+1 +2 +3 +4 +5 +6 +7 +8 +9 +10 +11 +12 +3 +10 +10 +5 +2 0 0 *100
)*1e3+( )*1e6+( )*1e9+( +0"
</pre>

<p>
Nun ging es ja darum, es m&ouml;glichst klein zu bekommen und so habe ich
erst einmal alle unn&ouml;tigen Zeichen (e, t, i, h und v) gel&ouml;scht bzw.
durch ein "" ersetzt - und das " " noch durch ein "+".
</p>
<p>
Wenn man sich die Sache genauer anschaut, so merkt man, da&szlig; man
au&szlig;erdem nicht alle Buchstaben ersetzen mu&szlig;. Z.b. k&ouml;nnte man "housand"
stehen lassen. Im obrigen Beispiel w&auml;re damit
"(1*100+3*10+7)*1e3+(housand+9*10+1)" raus gekommen. Das geht, da
"housand" als Variable aufgefasst wird, und so lange es diese nicht gibt,
gibt es auch keinen Fehler.
</p>

<p>
Mit beiden Optimierungen - h&auml;ufige Zeichen l&ouml;schen und unn&ouml;tige stehen
lassen - wurde daraus folgendes:
</p>

<pre style="background='silver';">
" 1e1t1i1h1v1an1on1wo1wn1four1ff1f1sx1sn1g1nn1ln1wl1y1+un1o1m1b1n1+#1r" "+
      1 2 2 4 5 5 6 7 8 9 11 12 0 00+ #3+( #6+( #9+( +10 )*1e 3"
</pre>

<p>
Da ich auch das " " ersetzen wollte, musste ich beim ersten String ein
Trennzeichen w&auml;hlen. Die 1 schien mir daf&uuml;r ideal, da ich sie als Integer
an die Split-Funktion &uuml;bergeben konnte. "1" w&auml;ren zwei Zeichen mehr
gewesen. Anmerken m&ouml;chte ich noch, da&szlig; die 1 als Trennzeichen im Nachhinein eine
dumme Idee war, da man sie zu leicht mit einem l verwechselt. Eine 0 w&auml;re
deutlich besser gewesen.
</p>

<p>
<i>Anmerkung: Der Ansatz ist &auml;hnlich dem oben gezeigten von Stefan, aber diese Eleganz, diese Reduktion auf das 
wesentliche! Sehr sch&ouml;n.</i>
</p>

<h2>Johann Engbers</h2>
<p>
<i>Komplett anders als die L&ouml;sung von Mischa, aber trotzdem gleich lang bzw. kurz:</i>
</p>

<pre style="background='silver';">
1: set b=application
2: for each k in split(b("input"))
3: o=0:for i=1to 9:o=o+asc(right(k,i))*i:next
4: j=instr(".z~nW.HE(o.&mdash;.á2[SwM..Ojq1B#;m&ldquo;*.",chr(o mod 153))-4
5: if j&gt;21then j=10*j-190
6: if j&lt;0then h=h+1e3^-j*l:j=-l
7: if j=21then j=l*99
8: l=l+j
9: next
10: b("output")=formatnumber(h+l,0)
</pre>

<p>
1: bekannt<br>
2: jedes Zahlwort der Liste wird einzeln verarbeitet<br>
3: damit berechne ich einen Hashwert, jedes Zahlwort wurde vorher mit
dieser Funktion kodiert, da ja nur korrekte L&ouml;sungen vorkommen ist das
m&ouml;glich. <br>
4: der Platz im String gibt den Wert des Zahlwortes wieder. Die
-4 verk&uuml;rzt noch mal die sp&auml;teren Abfragen<br>
5: die Pl&auml;tze 22..28 sind f&uuml;r
die 10er-Zahlen thirty, fourty, ... ninety reserviert. Z.B. 22 bedeutet
10*22-190=30 die addiert werden sollen. Da&szlig; dieser Wert in j wieder
gespeichert wird spart ein paar Bytes in Zusammenhang mit Zeile 8,
eigentlich m&uuml;sste es hei&szlig;en: l=l+10*j-190 <br>
6: -3,-2,-1 bedeuten billion,
million, thousand. Z.b. -3 ergibt 1e3^3 also eine Milliarde. In l ist die
Anzahl der Milliarden gespeichert, die schon vorher berechet werden
musste. j=-l  ist eine umst&auml;ndliche Schreibweise f&uuml;r l=0<br>
7: an 21er Stelle
steht die Hundert, daher m&uuml;sste ich jetzt l=l*100 berechnen, aber mit
j=l*99 und der 8.Zeile l&auml;sst sich noch ein Byte sparen<br>
8: wenn kein
Sonderfall aufgetreten ist, entspricht die Position des Zahlwortes seinem
Wert (1..20) und kann einfach addiert werden, 'and' hat den Wert 0<br>
10: zum Schlu&szlig; noch die Ausgabe mit FormatNumber.
</p>
<p>
<i>Anmerkungen dazu: Ebenfalls sehr sch&ouml;n - ein Beweis daf&uuml;r da&szlig; auch im ASP-Golf verschiedene Weg zum Green 
f&uuml;hren. Interessant sind bei diesem Turnier vor allem die vielen alternativen Ans&auml;tze zum Sparen von Zeichen in 
der Kodierung der Zahlw&ouml;rter.</i>
</p>

<h2>Schlu&szlig;bemerkung</h2>
<p>
So, liebe Golffreunde, das war's wieder einmal vom Golfplatz. Schalten sie sich wieder ein wenn sie das n&auml;chste Mal 
'Fore!' h&ouml;ren.
</p>

<p><strong>This printed page brought to you by <a href="http://www.alphasierrapapa.com/">AlphaSierraPapa</a></strong></p><h2>Verwandte Artikel</h2>
<p>
<a href="../artikel/20021202.htm">3. Loch - Dr. Evils Qualit&auml;tskontrolle</a><br>
<SPAN class="content">http:/www.aspheute.com/artikel/20021202.htm</span><br>
<a href="../artikel/20020930.htm">Tee Off - Das erste ASP Golf Turnier</a><br>
<SPAN class="content">http:/www.aspheute.com/artikel/20020930.htm</span><br>
<a href="../artikel/20021104.htm">Tee Off! Die Zweite</a><br>
<SPAN class="content">http:/www.aspheute.com/artikel/20021104.htm</span><br>
<a href="../artikel/20031222.htm">Tee Off! Wolpertinger Genome Project</a><br>
<SPAN class="content">http:/www.aspheute.com/artikel/20031222.htm</span><br>

</p>
<h2>Links zu anderen Sites</h2>
<p>
<a target="_blank" href="/REMOVED/3w_link.asp?3wsite=http%3A%2F%2Fwww%2Easpgerman%2Ecom%2FGolf%2Farchiv%2Easp%3Faction%3Dleader%26id%3D8%23data">Leaderboard 4. Turnier</a><br>
<SPAN class="content">http://www.aspgerman.com/Golf/archiv.asp?action=leader&id=8#data</span><br>

</p>

&nbsp;<P>
<center>

</center>

<center>
<p class="content">
&copy;2000-2006 <A HREF="../service/copyright.htm" title="Copyright Informationen">AspHeute.com</A><br>
Alle Rechte vorbehalten. Der Inhalt dieser Seiten ist urheberrechtlich gesch&uuml;tzt.<br>
Eine &Uuml;bernahme von Texten (auch nur auszugsweise) oder Graphiken bedarf unserer schriftlichen Zustimmung.
<hr>
</p>
</center>

</td>
</tr><!--Tabelle aussen, 2/2-->
</table><!--Tabelle aussen-->
</div>

</BODY>
</HTML>
